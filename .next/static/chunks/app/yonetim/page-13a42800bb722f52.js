(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8724],{63:(e,r,a)=>{"use strict";var t=a(7260);a.o(t,"usePathname")&&a.d(r,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(r,{useSearchParams:function(){return t.useSearchParams}})},2919:(e,r,a)=>{Promise.resolve().then(a.bind(a,9662))},9662:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>_});var t=a(5155),s=a(2115),i=a(63);function l(e){let{onLogin:r}=e,[a,i]=(0,s.useState)({username:"",password:""}),[l,n]=(0,s.useState)(!1),[o,d]=(0,s.useState)("");(0,s.useState)(()=>{sessionStorage.clear()});let c=async e=>{if(e.preventDefault(),!l){n(!0),d("");try{let e=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a.username,password:a.password})}),t=await e.json();t.success&&t.token?(sessionStorage.setItem("admin_token",t.token),sessionStorage.setItem("admin_session_id",t.sessionId),sessionStorage.setItem("admin_user",JSON.stringify(t.user)),r(!0)):(d(t.error||"Kullanıcı adı veya şifre hatalı!"),r(!1))}catch(e){console.error("Giriş hatası:",e),d("Bir hata oluştu. L\xfctfen tekrar deneyin."),r(!1)}finally{n(!1)}}};return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto h-20 w-20 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center mb-4",children:(0,t.jsx)("i",{className:"ri-admin-line text-3xl text-white"})}),(0,t.jsx)("h2",{className:"text-3xl font-bold text-white mb-2",children:"Admin Paneli"}),(0,t.jsx)("p",{className:"text-gray-400",children:"Tolga Demir Y\xf6netim Sistemi"})]}),(0,t.jsx)("div",{className:"bg-gray-800 dark:bg-gray-800 rounded-2xl shadow-2xl p-8 border border-gray-700",children:(0,t.jsxs)("form",{onSubmit:c,className:"space-y-6",children:[o&&(0,t.jsxs)("div",{className:"bg-red-900/30 border border-red-700 text-red-300 px-4 py-3 rounded-lg text-sm flex items-center",children:[(0,t.jsx)("i",{className:"ri-error-warning-line mr-2"}),o]}),(0,t.jsxs)("div",{className:"bg-blue-900/30 border border-blue-700 text-blue-300 px-4 py-3 rounded-lg text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsx)("i",{className:"ri-information-line mr-2"}),(0,t.jsx)("strong",{children:"MySQL Authentication Active"})]}),(0,t.jsx)("div",{className:"text-xs",children:"Admin credentials stored in database"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"E-posta"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)("i",{className:"ri-mail-line text-gray-400"})}),(0,t.jsx)("input",{type:"email",required:!0,autoComplete:"off",value:a.username,onChange:e=>i({...a,username:e.target.value}),className:"w-full pl-10 pr-4 py-3 border border-gray-600 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:"admin@tolgademir.org"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Şifre"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)("i",{className:"ri-lock-line text-gray-400"})}),(0,t.jsx)("input",{type:"password",required:!0,autoComplete:"new-password",value:a.password,onChange:e=>i({...a,password:e.target.value}),className:"w-full pl-10 pr-4 py-3 border border-gray-600 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:"Şifrenizi girin"})]})]}),(0,t.jsx)("button",{type:"submit",disabled:l,className:"w-full bg-gradient-to-r from-orange-500 to-yellow-500 text-white py-3 rounded-lg font-semibold hover:from-orange-600 hover:to-yellow-600 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap flex items-center justify-center",children:l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Giriş yapılıyor..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("i",{className:"ri-login-circle-line mr-2"}),"Giriş Yap"]})})]})})]})})}function n(e){let{activeSection:r,onSectionChange:a}=e,[i,l]=(0,s.useState)(!1),[n,o]=(0,s.useState)([{label:"Toplam Kitap",value:"0",color:"text-blue-600"},{label:"B\xf6l\xfcmler",value:"0",color:"text-green-600"},{label:"Yorumlar",value:"0",color:"text-orange-600"},{label:"Beğeniler",value:"0",color:"text-purple-600"}]);(0,s.useEffect)(()=>{d()},[]);let d=async()=>{try{let r=sessionStorage.getItem("admin_token"),a=await fetch("/api/analytics",{headers:{Authorization:"Bearer ".concat(r)}});if(a.ok){var e;let r=await a.json();if(r.success&&(null==(e=r.data)?void 0:e.overview)){let{totalBooks:e,totalChapters:a,totalComments:t,totalLikes:s}=r.data.overview;o([{label:"Toplam Kitap",value:e.toString(),color:"text-blue-600"},{label:"B\xf6l\xfcmler",value:a.toString(),color:"text-green-600"},{label:"Yorumlar",value:t.toString(),color:"text-orange-600"},{label:"Beğeniler",value:s.toString(),color:"text-purple-600"}])}}}catch(e){console.error("Quick stats load error:",e)}};return(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col transition-all duration-300 ".concat(i?"w-20":"w-64"),children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[!i&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Admin Panel"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Y\xf6netim Merkezi"})]}),(0,t.jsx)("button",{onClick:()=>l(!i),className:"w-8 h-8 flex items-center justify-center bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors cursor-pointer",children:(0,t.jsx)("i",{className:"ri-".concat(i?"menu-unfold":"menu-fold","-line text-gray-700 dark:text-gray-300")})})]})}),!i&&(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3",children:"Hızlı Durum"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3",children:n.map((e,r)=>(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[(0,t.jsx)("div",{className:"text-lg font-bold ".concat(e.color),children:e.value}),(0,t.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-300",children:e.label})]},r))})]}),(0,t.jsx)("nav",{className:"flex-1 overflow-y-auto p-4",children:(0,t.jsx)("div",{className:"space-y-2",children:[{id:"dashboard",name:"Dashboard",icon:"ri-dashboard-line"},{id:"statistics",name:"İstatistikler",icon:"ri-bar-chart-line"},{id:"books",name:"Kitap Y\xf6netimi",icon:"ri-book-line"},{id:"media",name:"Medya Y\xf6netimi",icon:"ri-image-line"},{id:"messages",name:"Mesaj Y\xf6netimi",icon:"ri-mail-line"},{id:"comments",name:"İ\xe7erik Yorumları",icon:"ri-chat-3-line"},{id:"security",name:"G\xfcvenlik Merkezi",icon:"ri-shield-check-line"},{id:"maintenance",name:"Bakım Modu",icon:"ri-tools-line"},{id:"settings",name:"Site Ayarları",icon:"ri-settings-line"},{id:"notifications",name:"Bildirim Merkezi",icon:"ri-notification-line"}].map(e=>(0,t.jsxs)("button",{onClick:()=>a(e.id),className:"w-full flex items-center px-3 py-3 rounded-lg text-left transition-all duration-200 cursor-pointer group ".concat(r===e.id?"bg-orange-100 dark:bg-orange-900/30 text-orange-900 dark:text-orange-300 border-l-4 border-orange-500":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white"),title:i?e.name:"",children:[(0,t.jsx)("div",{className:"w-6 h-6 flex items-center justify-center flex-shrink-0 ".concat(r===e.id?"text-orange-600 dark:text-orange-400":"text-gray-500 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white"),children:(0,t.jsx)("i",{className:"".concat(e.icon," text-lg")})}),!i&&(0,t.jsx)("span",{className:"ml-3 font-medium text-sm",children:e.name})]},e.id))})}),(0,t.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:!i&&(0,t.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/30 rounded-lg p-3 border border-blue-200 dark:border-blue-700",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,t.jsx)("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-300",children:"Sistem Durumu"})]}),(0,t.jsxs)("div",{className:"text-xs text-blue-700 dark:text-blue-200",children:[(0,t.jsx)("div",{children:"• Veritabanı: Bağlı"}),(0,t.jsx)("div",{children:"• Cache: Aktif"}),(0,t.jsx)("div",{children:"• SSL: G\xfcvenli"})]})]})})]})}function o(e){let{showFullView:r=!1,onViewAll:a}=e,[i,l]=(0,s.useState)([]),[n,o]=(0,s.useState)("all"),[d,c]=(0,s.useState)(!0),[m,x]=(0,s.useState)({page:1,limit:r?50:10,total:0,totalPages:0,hasMore:!1}),[g,u]=(0,s.useState)("");(0,s.useEffect)(()=>{h()},[n,m.page,g,r]);let h=async()=>{try{c(!0);let e=new URLSearchParams({page:m.page.toString(),limit:m.limit.toString()});"all"!==n&&e.append("category",n),g.trim()&&e.append("search",g.trim());let r=new AbortController,a=setTimeout(()=>r.abort(),8e3),t=await fetch("/api/books",{headers:{},signal:r.signal});if(clearTimeout(a),t.ok){let e=await t.json();e.success&&e.data?(l(Array.isArray(e.data)?e.data:[]),e.pagination&&"object"==typeof e.pagination?x(r=>({...r,total:e.pagination.total||0,totalPages:e.pagination.totalPages||1,hasMore:e.pagination.hasMore||!1})):x(r=>({...r,total:Array.isArray(e.data)?e.data.length:0,totalPages:1,hasMore:!1}))):(l(y()),x(e=>({...e,total:y().length,totalPages:1,hasMore:!1})))}else console.warn("Activity API response not ok, using fallback"),l(y()),x(e=>({...e,total:y().length,totalPages:1,hasMore:!1}))}catch(r){console.error("Activity loading error:",r);let e=y();l(e),x(r=>({...r,total:e.length,totalPages:1,hasMore:!1}))}finally{c(!1)}},y=()=>[{id:1,action:"admin_giris",action_tr:"Admin Paneline Giriş",resource:"auth",resource_id:"login",details:{},details_parsed:{description:"Admin paneline başarıyla giriş yapıldı"},status:"success",category:"security",category_tr:"G\xfcvenlik",user_email:"admin@system.com",ip_address:"127.0.0.1",created_at:new Date(Date.now()-3e5).toISOString()},{id:2,action:"dashboard_view",action_tr:"Dashboard G\xf6r\xfcnt\xfclendi",resource:"dashboard",resource_id:"main",details:{},details_parsed:{description:"Ana dashboard sayfası g\xf6r\xfcnt\xfclendi"},status:"success",category:"system",category_tr:"Sistem",user_email:"admin@system.com",ip_address:"127.0.0.1",created_at:new Date(Date.now()-6e5).toISOString()},{id:3,action:"books_viewed",action_tr:"Kitaplar G\xf6r\xfcnt\xfclendi",resource:"books",resource_id:"list",details:{},details_parsed:{description:"Kitap listesi kontrol edildi"},status:"success",category:"content",category_tr:"İ\xe7erik",user_email:"admin@system.com",ip_address:"127.0.0.1",created_at:new Date(Date.now()-9e5).toISOString()}],b=e=>{switch(e){case"content":return"ri-edit-circle-line";case"system":return"ri-settings-3-line";case"security":return"ri-shield-check-line";case"communication":return"ri-message-2-line";case"moderation":return"ri-check-circle-line";case"analytics":return"ri-bar-chart-line";default:return"ri-information-line"}},p=e=>{switch(e){case"content":return"text-blue-600 bg-blue-100";case"system":return"text-orange-600 bg-orange-100";case"security":return"text-green-600 bg-green-100";case"communication":return"text-purple-600 bg-purple-100";case"moderation":return"text-yellow-600 bg-yellow-100";case"analytics":return"text-indigo-600 bg-indigo-100";default:return"text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-700"}},k=e=>{try{let r=new Date,a=new Date(e),t=Math.floor((r.getTime()-a.getTime())/6e4);if(t<1)return"Az \xf6nce";if(t<60)return"".concat(t," dakika \xf6nce");if(t<1440)return"".concat(Math.floor(t/60)," saat \xf6nce");return"".concat(Math.floor(t/1440)," g\xfcn \xf6nce")}catch(e){return"Bilinmeyen zaman"}},j=(null==m?void 0:m.total)||i.length||0,f=Math.max(0,j-i.length);return r?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Sistem Aktivite G\xfcnl\xfckleri"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"T\xfcm sistem aktiviteleri ve işlemler"})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Toplam Kayıt"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:j})]})]}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("input",{type:"text",placeholder:"Arama yapın...",value:g,onChange:e=>{u(e.target.value),x(e=>({...e,page:1}))},className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})}),(0,t.jsxs)("select",{value:n,onChange:e=>o(e.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent pr-8",children:[(0,t.jsx)("option",{value:"all",children:"T\xfcm Kategoriler"}),(0,t.jsx)("option",{value:"system",children:"Sistem"}),(0,t.jsx)("option",{value:"content",children:"İ\xe7erik"}),(0,t.jsx)("option",{value:"security",children:"G\xfcvenlik"}),(0,t.jsx)("option",{value:"communication",children:"İletişim"}),(0,t.jsx)("option",{value:"moderation",children:"Moderasyon"}),(0,t.jsx)("option",{value:"analytics",children:"Analitik"})]}),(0,t.jsxs)("button",{onClick:h,className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-refresh-line mr-2"}),"Yenile"]})]})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:[d?(0,t.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,t.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full"}),(0,t.jsx)("span",{className:"ml-3 text-gray-600 dark:text-gray-300",children:"Aktiviteler y\xfckleniyor..."})]}):Array.isArray(i)&&0!==i.length?(0,t.jsx)("div",{className:"divide-y divide-gray-200",children:i.map(e=>{var r;return(0,t.jsx)("div",{className:"p-6 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:(0,t.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center ".concat(p(e.category)),children:(0,t.jsx)("i",{className:"".concat(b(e.category)," text-lg")})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h4",{className:"text-lg font-medium text-gray-900 dark:text-white",children:e.action_tr||e.action||"Bilinmeyen Aktivite"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("span",{className:"text-sm ".concat((e=>{switch(e){case"success":return"text-green-600";case"error":return"text-red-600";case"warning":return"text-yellow-600";default:return"text-gray-600"}})(e.status)),children:[(0,t.jsx)("i",{className:"ri-".concat("success"===e.status?"check":"error"===e.status?"close":"alert","-circle-line mr-1")}),"success"===e.status?"Başarılı":"error"===e.status?"Hatalı":"Uyarı"]}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:k(e.created_at)})]})]}),(null==(r=e.details_parsed)?void 0:r.description)&&(0,t.jsx)("p",{className:"text-gray-600 mt-2",children:e.details_parsed.description}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-4 mt-3 text-sm text-gray-500",children:[(0,t.jsxs)("span",{children:[(0,t.jsx)("i",{className:"ri-price-tag-3-line mr-1"}),e.category_tr||e.category||"Genel"]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("i",{className:"ri-database-line mr-1"}),e.resource||"Bilinmeyen"]}),e.resource_id&&(0,t.jsxs)("span",{children:[(0,t.jsx)("i",{className:"ri-fingerprint-line mr-1"}),"ID: ",e.resource_id]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("i",{className:"ri-user-line mr-1"}),e.user_email||"Sistem"]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("i",{className:"ri-global-line mr-1"}),e.ip_address||"Bilinmeyen IP"]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("i",{className:"ri-time-line mr-1"}),e.created_at?new Date(e.created_at).toLocaleString("tr-TR"):"Bilinmeyen tarih"]})]})]})]})},e.id)})}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("i",{className:"ri-history-line text-6xl text-gray-300 mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Aktivite bulunamadı"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Se\xe7ili filtrelere uygun aktivite kaydı bulunmuyor"})]}),!d&&m.hasMore&&f>0&&(0,t.jsx)("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 text-center",children:(0,t.jsxs)("button",{onClick:()=>{x(e=>({...e,page:e.page+1}))},className:"px-6 py-2 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 text-gray-700 dark:text-gray-200 rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-arrow-down-line mr-2"}),"Daha Fazla Y\xfckle (",f," kalan)"]})})]})]}):(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"Son Aktiviteler"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Sistemde ger\xe7ekleşen işlemler"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("select",{value:n,onChange:e=>o(e.target.value),className:"text-sm border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-transparent pr-8",children:[(0,t.jsx)("option",{value:"all",children:"T\xfcm\xfc"}),(0,t.jsx)("option",{value:"system",children:"Sistem"}),(0,t.jsx)("option",{value:"content",children:"İ\xe7erik"}),(0,t.jsx)("option",{value:"security",children:"G\xfcvenlik"}),(0,t.jsx)("option",{value:"communication",children:"İletişim"}),(0,t.jsx)("option",{value:"moderation",children:"Moderasyon"}),(0,t.jsx)("option",{value:"analytics",children:"Analitik"})]}),(0,t.jsx)("button",{onClick:h,className:"w-8 h-8 flex items-center justify-center bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 text-gray-600 dark:text-gray-300 rounded-lg transition-colors cursor-pointer",title:"Yenile",children:(0,t.jsx)("i",{className:"ri-refresh-line text-sm"})})]})]})}),(0,t.jsx)("div",{className:"max-h-96 overflow-y-auto",children:d?(0,t.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,t.jsx)("div",{className:"animate-spin w-6 h-6 border-2 border-orange-500 border-t-transparent rounded-full"})}):Array.isArray(i)&&0!==i.length?(0,t.jsx)("div",{className:"divide-y divide-gray-200",children:i.slice(0,10).map(e=>{var r;return(0,t.jsx)("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat(p(e.category)),children:(0,t.jsx)("i",{className:"".concat(b(e.category)," text-sm")})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-800 dark:text-gray-100 truncate",children:e.action_tr||e.action||"Bilinmeyen Aktivite"}),(0,t.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:k(e.created_at)})]}),(null==(r=e.details_parsed)?void 0:r.description)&&(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:e.details_parsed.description}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,t.jsxs)("span",{className:"text-xs text-gray-400",children:[(0,t.jsx)("i",{className:"ri-price-tag-3-line mr-1"}),e.category_tr||e.category||"Genel"]}),(0,t.jsxs)("span",{className:"text-xs text-gray-400",children:[(0,t.jsx)("i",{className:"ri-user-line mr-1"}),e.user_email?e.user_email.split("@")[0]:"Sistem"]}),(0,t.jsxs)("span",{className:"text-xs text-gray-400",children:[(0,t.jsx)("i",{className:"ri-time-line mr-1"}),e.created_at?new Date(e.created_at).toLocaleString("tr-TR"):"Bilinmeyen"]})]})]})]})},e.id)})}):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("i",{className:"ri-history-line text-4xl text-gray-300 mb-3"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Hen\xfcz aktivite kaydı bulunmuyor"})]})}),(0,t.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:(0,t.jsxs)("button",{onClick:a,className:"w-full text-sm text-gray-600 dark:text-gray-300 hover:text-gray-800 transition-colors cursor-pointer",children:[(0,t.jsx)("i",{className:"ri-more-line mr-2"}),"T\xfcm aktiviteleri g\xf6r\xfcnt\xfcle (",j,")"]})})]})}function d(){let[e,r]=(0,s.useState)({totalVisitors:0,topCountries:[],recentVisitors:[]}),[a,i]=(0,s.useState)(!0),[l,n]=(0,s.useState)("7d");(0,s.useEffect)(()=>{o()},[l]);let o=async()=>{try{i(!0);let e=new AbortController,a=setTimeout(()=>e.abort(),8e3),t=await fetch("/api/books",{headers:{},signal:e.signal});if(clearTimeout(a),t.ok){let e=await t.json();e.success&&e.data?r(e.data):r(d())}else console.warn("Visitor API response not ok, using fallback"),r(d())}catch(e){console.error("Visitor data loading error:",e),r(d())}finally{i(!1)}},d=()=>({totalVisitors:15420,topCountries:[{country:"T\xfcrkiye",city:"İstanbul",visitors:8234,percentage:53.4,flag:"\uD83C\uDDF9\uD83C\uDDF7"},{country:"Almanya",city:"Berlin",visitors:2156,percentage:14,flag:"\uD83C\uDDE9\uD83C\uDDEA"},{country:"ABD",city:"New York",visitors:1876,percentage:12.2,flag:"\uD83C\uDDFA\uD83C\uDDF8"},{country:"Fransa",city:"Paris",visitors:1234,percentage:8,flag:"\uD83C\uDDEB\uD83C\uDDF7"},{country:"İngiltere",city:"London",visitors:987,percentage:6.4,flag:"\uD83C\uDDEC\uD83C\uDDE7"},{country:"Kanada",city:"Toronto",visitors:567,percentage:3.7,flag:"\uD83C\uDDE8\uD83C\uDDE6"},{country:"Avustralya",city:"Sydney",visitors:366,percentage:2.4,flag:"\uD83C\uDDE6\uD83C\uDDFA"}],recentVisitors:[{id:"1",country:"T\xfcrkiye",city:"İstanbul",timestamp:new Date(Date.now()-12e4).toISOString(),page:"Ana Sayfa"},{id:"2",country:"Almanya",city:"Berlin",timestamp:new Date(Date.now()-3e5).toISOString(),page:"Kitaplar"},{id:"3",country:"ABD",city:"New York",timestamp:new Date(Date.now()-48e4).toISOString(),page:"Hakkında"},{id:"4",country:"Fransa",city:"Paris",timestamp:new Date(Date.now()-72e4).toISOString(),page:"İletişim"},{id:"5",country:"İngiltere",city:"London",timestamp:new Date(Date.now()-9e5).toISOString(),page:"Kitaplar"}]}),c=e=>"number"!=typeof e||isNaN(e)?"0":e.toLocaleString("tr-TR"),m=e=>"number"!=typeof e||isNaN(e)?"0":e.toFixed(1);return(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"Ziyaret\xe7i Haritası"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Coğrafi ziyaret\xe7i dağılımı"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("select",{value:l,onChange:e=>n(e.target.value),className:"text-sm border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-transparent pr-8",children:[(0,t.jsx)("option",{value:"1d",children:"Son 24 Saat"}),(0,t.jsx)("option",{value:"7d",children:"Son 7 G\xfcn"}),(0,t.jsx)("option",{value:"30d",children:"Son 30 G\xfcn"}),(0,t.jsx)("option",{value:"90d",children:"Son 3 Ay"})]}),(0,t.jsx)("button",{onClick:o,className:"w-8 h-8 flex items-center justify-center bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 text-gray-600 dark:text-gray-300 rounded-lg transition-colors cursor-pointer",title:"Yenile",children:(0,t.jsx)("i",{className:"ri-refresh-line text-sm"})})]})]})}),a?(0,t.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,t.jsx)("div",{className:"animate-spin w-6 h-6 border-2 border-orange-500 border-t-transparent rounded-full"}),(0,t.jsx)("span",{className:"ml-3 text-gray-600",children:"Harita verileri y\xfckleniyor..."})]}):(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:c(e.totalVisitors)}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:[(()=>{switch(l){case"1d":return"Son 24 Saat";case"7d":default:return"Son 7 G\xfcn";case"30d":return"Son 30 G\xfcn";case"90d":return"Son 3 Ay"}})()," Toplam Ziyaret\xe7i"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"En \xc7ok Ziyaret"}),(0,t.jsx)("div",{className:"font-semibold text-gray-800",children:e.topCountries&&e.topCountries.length>0?e.topCountries[0].country:"T\xfcrkiye"})]})]}),(0,t.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-100 rounded-lg p-8 mb-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-blue-200 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("i",{className:"ri-global-line text-2xl text-blue-600"})}),(0,t.jsx)("h4",{className:"text-lg font-medium text-gray-800 dark:text-gray-100 mb-2",children:"D\xfcnya Haritası"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm",children:"Ziyaret\xe7ilerinizin coğrafi dağılımını g\xf6rsel olarak takip edin"}),(0,t.jsxs)("div",{className:"mt-4 flex items-center justify-center space-x-4 text-sm text-gray-500",children:[(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-2"}),"Y\xfcksek Trafik"]}),(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-2"}),"Orta Trafik"]}),(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-gray-300 rounded-full mr-2"}),"D\xfcş\xfck Trafik"]})]})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800 dark:text-gray-100 mb-4",children:"En \xc7ok Ziyaret Eden \xdclkeler"}),(0,t.jsx)("div",{className:"space-y-3",children:e.topCountries&&e.topCountries.length>0?e.topCountries.slice(0,5).map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-white dark:bg-gray-800 rounded-full text-lg",children:e.flag||"\uD83C\uDF0D"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-800",children:e.country||"Bilinmeyen"}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:e.city||"Şehir belirtilmemiş"})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"font-semibold text-gray-800",children:c(e.visitors)}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["%",m(e.percentage)]})]})]},"".concat(e.country,"-").concat(r))):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("i",{className:"ri-global-line text-4xl text-gray-300 mb-3"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Hen\xfcz ziyaret\xe7i verisi bulunmuyor"})]})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800 dark:text-gray-100 mb-4",children:"Son Ziyaret\xe7iler"}),(0,t.jsx)("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:e.recentVisitors&&e.recentVisitors.length>0?e.recentVisitors.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-medium text-gray-800",children:[e.country||"Bilinmeyen",", ",e.city||"Şehir belirtilmemiş"]}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:e.page||"Sayfa belirtilmemiş"})]})]}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:(e=>{try{if(!e)return"Bilinmeyen";let r=new Date,a=new Date(e);if(isNaN(a.getTime()))return"Ge\xe7ersiz tarih";let t=Math.floor((r.getTime()-a.getTime())/6e4);if(t<1)return"Az \xf6nce";if(t<60)return"".concat(t," dk \xf6nce");if(t<1440)return"".concat(Math.floor(t/60)," sa \xf6nce");return"".concat(Math.floor(t/1440)," g\xfcn \xf6nce")}catch(e){return console.error("Time calculation error:",e),"Bilinmeyen"}})(e.timestamp)})]},"".concat(e.id||r))):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("i",{className:"ri-user-location-line text-4xl text-gray-300 mb-3"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Hen\xfcz aktif ziyaret\xe7i bulunmuyor"})]})})]})]}),(0,t.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800 dark:text-gray-100 mb-4",children:"Trafik Dağılımı"}),(0,t.jsx)("div",{className:"space-y-3",children:e.topCountries&&e.topCountries.length>0?e.topCountries.slice(0,7).map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 w-32",children:[(0,t.jsx)("span",{className:"text-lg",children:e.flag||"\uD83C\uDF0D"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.country||"Bilinmeyen"})]}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-2 rounded-full transition-all duration-500",style:{width:"".concat(Math.min(Math.max(e.percentage||0,0),100),"%")}})})}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-300 w-16 text-right",children:["%",m(e.percentage)]})]},"traffic-".concat(e.country,"-").concat(r))):(0,t.jsx)("div",{className:"text-center py-4",children:(0,t.jsx)("p",{className:"text-gray-500",children:"Trafik dağılımı verisi bulunmuyor"})})})]}),(0,t.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:e.topCountries?e.topCountries.length:0}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"\xdclke"})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:e.recentVisitors?e.recentVisitors.length:0}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Aktif Ziyaret\xe7i"})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"text-2xl font-bold text-orange-600",children:[e.topCountries&&e.topCountries.length>0?m(e.topCountries[0].percentage):"0","%"]}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"En Y\xfcksek Oran"})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:Math.round((e.totalVisitors||0)/30)}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"G\xfcnl\xfck Ortalama"})]})]})})]})]})}function c(e){let{showFullView:r=!1,onViewAll:a}=e,[i,l]=(0,s.useState)([]),[n,o]=(0,s.useState)("all"),[d,c]=(0,s.useState)(!0),[m,x]=(0,s.useState)([]),[g,u]=(0,s.useState)({page:1,limit:r?50:10,total:0,totalPages:0,hasMore:!1}),[h,y]=(0,s.useState)(""),[b,p]=(0,s.useState)({total:0,unread:0,by_type:{},by_priority:{}});(0,s.useEffect)(()=>{let e=localStorage.getItem("admin_dismissed_notifications");if(e)try{x(JSON.parse(e))}catch(e){console.error("Error loading dismissed notifications:",e)}},[]),(0,s.useEffect)(()=>{k(),j();let e=setInterval(()=>{k(),j()},3e4);return()=>clearInterval(e)},[n,g.page,h,r,m]);let k=async()=>{try{c(!0);let e=new URLSearchParams({page:g.page.toString(),limit:g.limit.toString()});"all"!==n&&("unread"===n?e.append("unread_only","true"):e.append("type",n)),h.trim()&&e.append("search",h.trim());let r=sessionStorage.getItem("admin_token"),a=await fetch("/api/admin/notifications?".concat(e),{headers:{Authorization:"Bearer ".concat(r)}});if(a.ok){let e=await a.json();if(e.success&&e.data){let r=(e.data.notifications||[]).filter(e=>!m.includes(e.id));l(r),u(e=>({...e,total:r.length,totalPages:Math.ceil(r.length/g.limit),hasMore:r.length>=g.limit}))}}else l([{id:"1",type:"system",title:"Sistem Bildirimi",message:"Admin paneli başarıyla g\xfcncellendi",priority:"normal",is_read:!1,created_at:new Date(Date.now()-3e5).toISOString()},{id:"2",type:"content",title:"Yeni İ\xe7erik",message:"Bir kitap b\xf6l\xfcm\xfc eklendi",priority:"low",is_read:!0,created_at:new Date(Date.now()-18e5).toISOString()}])}catch(e){console.error("Notification loading error:",e),l([])}finally{c(!1)}},j=async()=>{try{let e=sessionStorage.getItem("admin_token"),r=await fetch("/api/admin/notifications?limit=100",{headers:{Authorization:"Bearer ".concat(e)}});if(r.ok){let e=await r.json();e.success&&e.data&&p({total:e.data.total||0,unread:e.data.unreadCount||0,by_type:{},by_priority:{}})}}catch(e){console.error("Stats loading error:",e)}},f=async e=>{try{let r=sessionStorage.getItem("admin_token");(await fetch("/api/admin/notifications",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({notificationId:e,is_read:!0})})).ok&&(l(r=>r.map(r=>r.id===e?{...r,is_read:!0,read_at:new Date().toISOString()}:r)),j())}catch(e){console.error("Mark as read error:",e)}},v=async()=>{try{let e=i.filter(e=>!e.is_read).map(e=>e.id);if(0===e.length)return void alert("Okunmamış bildirim yok");let r=sessionStorage.getItem("admin_token");(await fetch("/api/admin/notifications",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({markAllAsRead:!0})})).ok&&(l(e=>e.map(e=>({...e,is_read:!0,read_at:new Date().toISOString()}))),j(),alert("T\xfcm bildirimler okundu olarak işaretlendi"))}catch(e){console.error("Mark all as read error:",e)}},N=async e=>{try{let r=[...m,...e];x(r),localStorage.setItem("admin_dismissed_notifications",JSON.stringify(r));let a=sessionStorage.getItem("admin_token");(await fetch("/api/admin/notifications",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({notificationIds:e})})).ok&&(l(r=>r.filter(r=>!e.includes(r.id))),j(),alert("Se\xe7ili bildirimler kalıcı olarak silindi"))}catch(e){console.error("Delete notifications error:",e),alert("Bildirimler silinirken hata oluştu")}},w=async()=>{if(0===i.length)return void alert("Silinecek bildirim bulunmuyor");if(window.confirm("T\xfcm bildirimleri (".concat(i.length," adet) kalıcı olarak silmek istediğinizden emin misiniz? Bu işlem geri alınamaz.")))try{let e=sessionStorage.getItem("admin_token");if((await fetch("/api/admin/notifications",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({deleteAll:!0})})).ok){let e=i.map(e=>e.id),r=[...m,...e];x(r),localStorage.setItem("admin_dismissed_notifications",JSON.stringify(r)),l([]),p(e=>({...e,total:0,unread:0})),_("T\xfcm bildirimler kalıcı olarak silindi")}else alert("Bildirimler silinirken hata oluştu")}catch(e){console.error("Delete all notifications error:",e),alert("Bildirimler silinirken hata oluştu")}},S=async()=>{try{let e={type:"system",title:"Test Bildirimi",message:"Bu bir test bildirimidir - sistem \xe7alışıyor!",priority:"normal",data:{test:!0,timestamp:new Date().toISOString()}};(await fetch("/api/books",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok&&(k(),j(),_("Test bildirimi oluşturuldu"))}catch(e){console.error("Create test notification error:",e)}},_=e=>{let r=document.createElement("div");r.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center",r.innerHTML='<i class="ri-check-line mr-2"></i>'.concat(e),document.body.appendChild(r),setTimeout(()=>r.remove(),3e3)},C=e=>{switch(e){case"system":return"ri-settings-3-line";case"content":return"ri-edit-circle-line";case"user":return"ri-user-line";case"security":return"ri-shield-check-line";case"performance":return"ri-speed-line";case"comment":return"ri-message-2-line";case"like":return"ri-heart-line";case"error":return"ri-error-warning-line";default:return"ri-notification-line"}},z=(e,r)=>{if("critical"===r)return"text-red-600 bg-red-100";if("high"===r)return"text-orange-600 bg-orange-100";switch(e){case"system":return"text-blue-600 bg-blue-100";case"content":return"text-green-600 bg-green-100";case"security":return"text-purple-600 bg-purple-100";case"error":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},T=e=>{try{if(!e)return"Bilinmeyen zaman";let r=new Date,a=new Date(e);if(isNaN(a.getTime()))return"Ge\xe7ersiz tarih";let t=r.getTime()-a.getTime(),s=Math.floor(t/6e4),i=Math.floor(t/36e5),l=Math.floor(t/864e5);if(s<1)return"Az \xf6nce";if(s<60)return"".concat(s," dakika \xf6nce");if(i<24)return"".concat(i," saat \xf6nce");if(l<7)return"".concat(l," g\xfcn \xf6nce");return a.toLocaleDateString("tr-TR",{day:"numeric",month:"short",year:a.getFullYear()!==r.getFullYear()?"numeric":void 0})}catch(e){return console.error("Date formatting error:",e),"Bilinmeyen zaman"}};if(r){var A,B,D,E;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Bildirim Merkezi"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"T\xfcm sistem bildirimleri ve uyarılar"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Okunmamış"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:b.unread})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Toplam"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:b.total})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[(0,t.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-blue-600 dark:text-blue-400 text-sm font-medium",children:"Sistem"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-800 dark:text-blue-300",children:(null==(A=b.by_type)?void 0:A.system)||0})]}),(0,t.jsx)("i",{className:"ri-settings-3-line text-blue-600 text-2xl"})]})}),(0,t.jsx)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-green-600 dark:text-green-400 text-sm font-medium",children:"İ\xe7erik"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-800 dark:text-green-300",children:(null==(B=b.by_type)?void 0:B.content)||0})]}),(0,t.jsx)("i",{className:"ri-edit-circle-line text-green-600 text-2xl"})]})}),(0,t.jsx)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-purple-600 dark:text-purple-400 text-sm font-medium",children:"G\xfcvenlik"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-purple-800 dark:text-purple-300",children:(null==(D=b.by_type)?void 0:D.security)||0})]}),(0,t.jsx)("i",{className:"ri-shield-check-line text-purple-600 text-2xl"})]})}),(0,t.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-red-600 dark:text-red-400 text-sm font-medium",children:"Kritik"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-red-800 dark:text-red-300",children:(null==(E=b.by_priority)?void 0:E.critical)||0})]}),(0,t.jsx)("i",{className:"ri-error-warning-line text-red-600 text-2xl"})]})})]}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("input",{type:"text",placeholder:"Bildirimlərdə axtarış...",value:h,onChange:e=>y(e.target.value),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})}),(0,t.jsxs)("select",{value:n,onChange:e=>o(e.target.value),className:"px-4 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent pr-8",children:[(0,t.jsx)("option",{value:"all",children:"T\xfcm Bildirimler"}),(0,t.jsx)("option",{value:"unread",children:"Okunmamış"}),(0,t.jsx)("option",{value:"system",children:"Sistem"}),(0,t.jsx)("option",{value:"content",children:"İ\xe7erik"}),(0,t.jsx)("option",{value:"security",children:"G\xfcvenlik"}),(0,t.jsx)("option",{value:"user",children:"Kullanıcı"}),(0,t.jsx)("option",{value:"error",children:"Hata"})]}),(0,t.jsxs)("button",{onClick:v,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-check-double-line mr-2"}),"T\xfcm\xfcn\xfc Okundu İşaretle"]}),(0,t.jsxs)("button",{onClick:w,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-delete-bin-2-line mr-2"}),"T\xfcm\xfcn\xfc Sil"]}),(0,t.jsxs)("button",{onClick:S,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-add-line mr-2"}),"Test Bildirimi"]})]})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:[d?(0,t.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,t.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full"}),(0,t.jsx)("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Bildirimler y\xfckleniyor..."})]}):0===i.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("i",{className:"ri-notification-off-line text-6xl text-gray-300 mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Bildirim bulunamadı"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Se\xe7ili filtrelere uygun bildirim bulunmuyor"})]}):(0,t.jsx)("div",{className:"divide-y divide-gray-200",children:i.map(e=>(0,t.jsx)("div",{className:"p-6 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ".concat(e.is_read?"":"bg-blue-50 dark:bg-blue-900/20"),children:(0,t.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center ".concat(z(e.type,e.priority)),children:(0,t.jsx)("i",{className:"".concat(C(e.type)," text-lg")})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("h4",{className:"text-lg font-medium ".concat(e.is_read?"text-gray-700 dark:text-gray-300":"text-gray-900 dark:text-white"),children:[e.title,!e.is_read&&(0,t.jsx)("span",{className:"ml-2 w-2 h-2 bg-orange-500 rounded-full inline-block"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"text-xs px-2 py-1 rounded-full font-medium ".concat("critical"===e.priority?"bg-red-100 text-red-800":"high"===e.priority?"bg-orange-100 text-orange-800":"low"===e.priority?"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300":"bg-blue-100 text-blue-800"),children:"critical"===e.priority?"Kritik":"high"===e.priority?"Y\xfcksek":"low"===e.priority?"D\xfcş\xfck":"Normal"}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:T(e.created_at)})]})]}),(0,t.jsx)("p",{className:"text-gray-600 mt-2",children:e.message}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,t.jsxs)("span",{children:[(0,t.jsx)("i",{className:"ri-price-tag-3-line mr-1"}),e.type]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("i",{className:"ri-time-line mr-1"}),new Date(e.created_at).toLocaleString("tr-TR")]}),e.is_read&&e.read_at&&(0,t.jsxs)("span",{children:[(0,t.jsx)("i",{className:"ri-check-line mr-1"}),new Date(e.read_at).toLocaleString("tr-TR")," okundu"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[!e.is_read&&(0,t.jsxs)("button",{onClick:()=>f(e.id),className:"text-sm text-blue-600 hover:text-blue-800 cursor-pointer",children:[(0,t.jsx)("i",{className:"ri-check-line mr-1"}),"Okundu İşaretle"]}),(0,t.jsxs)("button",{onClick:()=>N([e.id]),className:"text-sm text-red-600 hover:text-red-800 cursor-pointer",children:[(0,t.jsx)("i",{className:"ri-delete-bin-line mr-1"}),"Sil"]}),e.action_url&&(0,t.jsxs)("a",{href:e.action_url,className:"text-sm text-green-600 hover:text-green-800 cursor-pointer",children:[(0,t.jsx)("i",{className:"ri-external-link-line mr-1"}),"G\xf6r\xfcnt\xfcle"]})]})]})]})]})},e.id))}),!d&&g.hasMore&&(0,t.jsx)("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 text-center",children:(0,t.jsxs)("button",{onClick:()=>u(e=>({...e,page:e.page+1})),className:"px-6 py-2 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 text-gray-700 dark:text-gray-200 rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-arrow-down-line mr-2"}),"Daha Fazla Y\xfckle (",g.total-i.length," kalan)"]})})]})]})}return(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"Son Bildirimler"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:b.unread>0?"".concat(b.unread," okunmamış bildirim"):"T\xfcm bildirimler okundu"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("button",{onClick:S,className:"w-8 h-8 flex items-center justify-center bg-green-100 dark:bg-green-900/20 hover:bg-green-200 dark:hover:bg-green-800/30 text-green-600 dark:text-green-400 rounded-lg transition-colors cursor-pointer",title:"Test Bildirimi Oluştur",children:(0,t.jsx)("i",{className:"ri-add-line text-sm"})}),(0,t.jsx)("button",{onClick:v,className:"w-8 h-8 flex items-center justify-center bg-blue-100 dark:bg-blue-900/20 hover:bg-blue-200 dark:hover:bg-blue-800/30 text-blue-600 dark:text-blue-400 rounded-lg transition-colors cursor-pointer",title:"T\xfcm\xfcn\xfc Okundu İşaretle",children:(0,t.jsx)("i",{className:"ri-check-double-line text-sm"})}),(0,t.jsx)("button",{onClick:w,className:"w-8 h-8 flex items-center justify-center bg-red-100 dark:bg-red-900/20 hover:bg-red-200 dark:hover:bg-red-800/30 text-red-600 dark:text-red-400 rounded-lg transition-colors cursor-pointer",title:"T\xfcm Bildirimleri Sil",children:(0,t.jsx)("i",{className:"ri-delete-bin-2-line text-sm"})})]})]})}),(0,t.jsx)("div",{className:"max-h-96 overflow-y-auto",children:d?(0,t.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,t.jsx)("div",{className:"animate-spin w-6 h-6 border-2 border-orange-500 border-t-transparent rounded-full"})}):0===i.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("i",{className:"ri-notification-off-line text-4xl text-gray-300 mb-3"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Hen\xfcz bildirim bulunmuyor"})]}):(0,t.jsx)("div",{className:"divide-y divide-gray-200",children:i.slice(0,10).map(e=>(0,t.jsx)("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ".concat(e.is_read?"":"bg-blue-50 dark:bg-blue-900/20"),children:(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat(z(e.type,e.priority)),children:(0,t.jsx)("i",{className:"".concat(C(e.type)," text-sm")})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("h4",{className:"text-sm font-medium truncate ".concat(e.is_read?"text-gray-700 dark:text-gray-300":"text-gray-900 dark:text-white"),children:[e.title,!e.is_read&&(0,t.jsx)("span",{className:"ml-1 w-1.5 h-1.5 bg-orange-500 rounded-full inline-block"})]}),(0,t.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:T(e.created_at)})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1 line-clamp-2",children:e.message}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,t.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium ".concat("critical"===e.priority?"bg-red-100 text-red-700":"high"===e.priority?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"),children:e.type}),!e.is_read&&(0,t.jsx)("button",{onClick:()=>f(e.id),className:"text-xs text-blue-600 hover:text-blue-800 cursor-pointer",children:"Okundu işaretle"})]})]})]})},e.id))})}),(0,t.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:(0,t.jsxs)("button",{onClick:a,className:"w-full text-sm text-gray-600 dark:text-gray-300 hover:text-gray-800 transition-colors cursor-pointer",children:[(0,t.jsx)("i",{className:"ri-more-line mr-2"}),"T\xfcm bildirimleri g\xf6r\xfcnt\xfcle (",b.total,")"]})})]})}function m(e){let{onSectionChange:r}=e,[a,i]=(0,s.useState)({totalBooks:0,totalChapters:0,totalComments:0,totalMessages:0,totalEvents:0,totalVisitors:0,publishedBooks:0,draftBooks:0,upcomingEvents:0,totalBlogPosts:0,publishedPosts:0,draftPosts:0}),[l,n]=(0,s.useState)({books:[],events:[]}),[m,x]=(0,s.useState)([]),[g,u]=(0,s.useState)(!0),[h,y]=(0,s.useState)(new Date),[b,p]=(0,s.useState)(!1);(0,s.useEffect)(()=>{k();let e=setInterval(()=>{k()},3e4);return()=>clearInterval(e)},[]);let k=async()=>{try{await Promise.all([j(),f(),v()]),y(new Date)}catch(e){console.error("Dashboard veri y\xfckleme hatası:",e)}finally{u(!1)}},j=async()=>{try{let e=sessionStorage.getItem("admin_token"),r=await fetch("/api/analytics",{headers:{Authorization:"Bearer ".concat(e)}});if(r.ok){let e=await r.json();if(e.success&&e.data){let r=e.data.overview||{};i({totalBooks:r.totalBooks||0,totalChapters:r.totalChapters||0,totalComments:r.totalComments||0,totalMessages:0,totalEvents:0,totalVisitors:0,publishedBooks:r.totalBooks||0,draftBooks:0,upcomingEvents:0,totalBlogPosts:0,publishedPosts:0,draftPosts:0})}}}catch(e){console.error("İstatistik y\xfckleme hatası:",e)}},f=async()=>{try{let e=sessionStorage.getItem("admin_token"),r=await fetch("/api/analytics",{headers:{Authorization:"Bearer ".concat(e)}});if(r.ok){let e=await r.json();if(e.success&&e.data){let r=(e.data.popularBooks||[]).map(e=>({id:e.id.toString(),title:e.title,chapters:0,comments:0,likes:e.like_count||0}));n({books:r.slice(0,5),events:[]})}}}catch(e){console.error("Pop\xfcler i\xe7erik y\xfckleme hatası:",e)}},v=async()=>{try{let e=sessionStorage.getItem("admin_token"),r=await fetch("/api/admin/notifications?limit=20",{headers:{Authorization:"Bearer ".concat(e)}});if(r.ok){let e=await r.json();if(e.success&&e.data)return void x(e.data.notifications||[])}let a=[];for(let e of[{name:"comments",url:"/api/books",type:"comment"},{name:"messages",url:"/api/books",type:"message"},{name:"events",url:"/api/books",type:"event"}])try{let r=new AbortController,t=setTimeout(()=>r.abort(),5e3),s=await fetch(e.url,{headers:{"Content-Type":"application/json"},signal:r.signal});if(clearTimeout(t),s.ok){let r=await s.json();if(r.success&&r.data&&Array.isArray(r.data)){if("comment"===e.type)r.data.forEach(e=>{e&&e.id&&a.push({id:"comment-".concat(e.id),type:"comment",title:"Yeni Yorum",message:"".concat(e.author_name||"Anonim",' bir yorum bıraktı: "').concat((e.content||"").substring(0,50),'..."'),time:e.created_at||new Date().toISOString(),isRead:!1,data:e})});else if("message"===e.type)r.data.forEach(e=>{e&&e.id&&a.push({id:"message-".concat(e.id),type:"message",title:"Yeni Mesaj",message:"".concat(e.name||"Anonim",' adlı kişiden mesaj: "').concat((e.message||"").substring(0,50),'..."'),time:e.created_at||new Date().toISOString(),isRead:!1,data:e})});else if("event"===e.type){let e=new Date;r.data.filter(r=>{if(!r||!r.event_date)return!1;try{let a=new Date(r.event_date),t=Math.ceil((a.getTime()-e.getTime())/864e5);return t>0&&t<=7}catch(e){return!1}}).forEach(r=>{if(r&&r.id)try{let t=new Date(r.event_date),s=Math.ceil((t.getTime()-e.getTime())/864e5);a.push({id:"event-".concat(r.id),type:"event",title:"Yaklaşan Etkinlik",message:'"'.concat(r.title||"İsimsiz Etkinlik",'" etkinliği ').concat(s," g\xfcn sonra başlayacak"),time:t.toISOString(),isRead:!1,data:r})}catch(e){console.error("Event date processing error:",e)}})}}}}catch(r){console.error("".concat(e.name," API hatası:"),r);continue}0===a.length&&a.push({id:"system-welcome",type:"system",title:"Admin Paneli Aktif",message:"Sistem \xe7alışıyor ve hazır durumda",time:new Date().toISOString(),isRead:!1}),a.sort((e,r)=>{try{return new Date(r.time).getTime()-new Date(e.time).getTime()}catch(e){return 0}}),x(a.slice(0,10))}catch(e){console.error("Bildirim y\xfckleme hatası:",e),x([{id:"fallback-1",type:"system",title:"Sistem Bildirimi",message:"Admin paneli başarıyla y\xfcklendi",time:new Date().toISOString(),isRead:!1}])}},N=()=>a&&0!==a.totalVisitors?Math.round(a.totalComments/a.totalVisitors*100):0,w=()=>a&&0!==a.totalBooks?Math.round(a.totalChapters/a.totalBooks):0,S=()=>a&&0!==a.totalMessages?Math.round((a.totalMessages-2)/a.totalMessages*100):100;return b?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"T\xfcm Sistem Aktiviteleri"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Sistemde ger\xe7ekleşen t\xfcm aktivite kayıtları"})]}),(0,t.jsxs)("button",{onClick:()=>p(!1),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-arrow-left-line mr-2"}),"Dashboard'a D\xf6n"]})]}),(0,t.jsx)(o,{showFullView:!0,onViewAll:()=>p(!1)})]}):g?(0,t.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,t.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full"}),(0,t.jsx)("span",{className:"ml-3 text-gray-600",children:"Dashboard y\xfckleniyor..."})]}):(0,t.jsxs)("div",{className:"space-y-6 bg-gray-50 dark:bg-gray-900 min-h-screen p-6 -m-6",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 rounded-xl text-white p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Admin Dashboard'a Hoş Geldiniz"}),(0,t.jsxs)("p",{className:"text-orange-100",suppressHydrationWarning:!0,children:["Son g\xfcncelleme: ",h?h.toLocaleString("tr-TR"):"Hen\xfcz g\xfcncellenmedi"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-sm text-orange-100",children:"Sistem Durumu"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),(0,t.jsx)("span",{className:"font-medium",children:"Aktif"})]})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Toplam Kitap"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(null==a?void 0:a.totalBooks)||0}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:[(null==a?void 0:a.publishedBooks)||0," yayında, ",(null==a?void 0:a.draftBooks)||0," taslak"]})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center border border-blue-200 dark:border-blue-700",children:(0,t.jsx)("i",{className:"ri-book-line text-blue-600 dark:text-blue-400 text-xl"})})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Toplam B\xf6l\xfcm"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(null==a?void 0:a.totalChapters)||0}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:["Kitap başına ort. ",w()," b\xf6l\xfcm"]})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center border border-green-200 dark:border-green-700",children:(0,t.jsx)("i",{className:"ri-file-text-line text-green-600 dark:text-green-400 text-xl"})})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Toplam Yorum"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(null==a?void 0:a.totalComments)||0}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:["Etkileşim oranı: %",N()]})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center border border-purple-200 dark:border-purple-700",children:(0,t.jsx)("i",{className:"ri-chat-3-line text-purple-600 dark:text-purple-400 text-xl"})})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Ziyaret\xe7i"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:((null==a?void 0:a.totalVisitors)||0).toLocaleString()}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:"Bu ay toplam"})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-orange-100 dark:bg-orange-900/30 rounded-lg flex items-center justify-center border border-orange-200 dark:border-orange-700",children:(0,t.jsx)("i",{className:"ri-user-line text-orange-600 dark:text-orange-400 text-xl"})})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"İ\xe7erik İstatistikleri"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Blog Yazıları"}),(0,t.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:(null==a?void 0:a.totalBlogPosts)||0})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Yayında Blog"}),(0,t.jsx)("span",{className:"font-semibold text-green-600 dark:text-green-400",children:(null==a?void 0:a.publishedPosts)||0})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Taslak Blog"}),(0,t.jsx)("span",{className:"font-semibold text-orange-600 dark:text-orange-400",children:(null==a?void 0:a.draftPosts)||0})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Toplam Etkinlik"}),(0,t.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:(null==a?void 0:a.totalEvents)||0})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Yaklaşan Etkinlik"}),(0,t.jsx)("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:(null==a?void 0:a.upcomingEvents)||0})]})]})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4",children:"Performans Metrikleri"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Etkileşim Oranı"}),(0,t.jsxs)("span",{className:"font-semibold",children:["%",N()]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"".concat(Math.min(N(),100),"%")}})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"İ\xe7erik Oranı"}),(0,t.jsxs)("span",{className:"font-semibold",children:[w()," b\xf6l\xfcm/kitap"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"".concat(Math.min(10*w(),100),"%")}})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Yanıt Oranı"}),(0,t.jsxs)("span",{className:"font-semibold",children:["%",S()]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-orange-500 h-2 rounded-full",style:{width:"".concat(S(),"%")}})})]})]})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4",children:"Hızlı İşlemler"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("button",{onClick:()=>r("books"),className:"w-full flex items-center p-3 bg-blue-50 dark:bg-blue-900/30 hover:bg-blue-100 dark:hover:bg-blue-800/40 rounded-lg transition-colors cursor-pointer",children:[(0,t.jsx)("i",{className:"ri-book-line text-blue-600 mr-3"}),(0,t.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:"Yeni Kitap Ekle"})]}),(0,t.jsxs)("button",{onClick:()=>r("media"),className:"w-full flex items-center p-3 bg-green-50 dark:bg-green-900/30 hover:bg-green-100 dark:hover:bg-green-800/40 rounded-lg transition-colors cursor-pointer",children:[(0,t.jsx)("i",{className:"ri-image-2-line text-green-600 mr-3"}),(0,t.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:"Medya Y\xf6netimi"})]}),(0,t.jsxs)("button",{onClick:()=>r("comments"),className:"w-full flex items-center p-3 bg-purple-50 dark:bg-purple-900/30 hover:bg-purple-100 dark:hover:bg-purple-800/40 rounded-lg transition-colors cursor-pointer",children:[(0,t.jsx)("i",{className:"ri-chat-3-line text-purple-600 mr-3"}),(0,t.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:"Yorumları Y\xf6net"})]}),(0,t.jsxs)("button",{onClick:()=>r("messages"),className:"w-full flex items-center p-3 bg-orange-50 dark:bg-orange-900/30 hover:bg-orange-100 dark:hover:bg-orange-800/40 rounded-lg transition-colors cursor-pointer",children:[(0,t.jsx)("i",{className:"ri-message-2-line text-orange-600 mr-3"}),(0,t.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:"Mesajları G\xf6r\xfcnt\xfcle"})]}),(0,t.jsxs)("button",{onClick:async()=>{try{let e=sessionStorage.getItem("admin_token"),a=await fetch("/api/admin/backup/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({includeData:!0,includeImages:!0})});if(a.ok){let e=await a.json();e.success?(alert("Yedek başarıyla oluşturuldu! Medya y\xf6netiminde g\xf6r\xfcnt\xfcleyebilirsiniz."),r("media")):alert("Hata: ".concat(e.error||"Yedek oluşturulamadı"))}else alert("Yedek oluşturma başarısız oldu.")}catch(e){console.error("Yedek oluşturma hatası:",e),alert("Yedek oluşturulurken bir hata oluştu.")}},className:"w-full flex items-center p-3 bg-teal-50 dark:bg-teal-900/30 hover:bg-teal-100 dark:hover:bg-teal-800/40 rounded-lg transition-colors cursor-pointer",children:[(0,t.jsx)("i",{className:"ri-database-2-line text-teal-600 mr-3"}),(0,t.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:"Yedek Oluştur"})]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"Pop\xfcler İ\xe7erik"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"En \xe7ok etkileşim alan i\xe7erikler"})]}),(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"En Pop\xfcler Kitaplar"}),0===l.books.length?(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Hen\xfcz kitap bulunmuyor"}):(0,t.jsx)("div",{className:"space-y-3",children:l.books.map(e=>(0,t.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-800 dark:text-white",children:e.title}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.chapters," b\xf6l\xfcm • ",e.comments," yorum • ",e.likes," beğeni"]})]})},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Yaklaşan Etkinlikler"}),0===l.events.length?(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Yaklaşan etkinlik bulunmuyor"}):(0,t.jsx)("div",{className:"space-y-3",children:l.events.map(e=>(0,t.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-800 dark:text-white",children:e.title}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",suppressHydrationWarning:!0,children:[e.date?new Date(e.date).toLocaleDateString("tr-TR"):"Tarih belirtilmemiş"," •",e.maxParticipants>0?" ".concat(e.participants,"/").concat(e.maxParticipants," kişi"):" ".concat(e.participants," katılımcı")]})]})},e.id))})]})]})]}),(0,t.jsx)("div",{children:(0,t.jsx)(c,{showFullView:!1,onViewAll:()=>r("notifications")})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsx)(o,{showFullView:!1,onViewAll:()=>p(!0)}),(0,t.jsx)(d,{})]})]})}function x(){var e,r,a,i,l,n,o,d,c,m,x,g,u,h,y,b,p,k,j,f,v,N;let[w,S]=(0,s.useState)("7days"),[_,C]=(0,s.useState)(!0),[z,T]=(0,s.useState)(!1),[A,B]=(0,s.useState)(!1),[D,E]=(0,s.useState)(null),[I,P]=(0,s.useState)({visitors:{current:0,change:0},pageViews:{current:0,change:0},bounceRate:{current:0,change:0},avgTime:{current:"0:00",change:0}});(0,s.useEffect)(()=>{M(),T("true"===localStorage.getItem("adminDarkMode")),B("true"===localStorage.getItem("maintenanceMode"))},[]);let M=async()=>{try{C(!0),P({visitors:{current:0,change:0},pageViews:{current:0,change:0},bounceRate:{current:0,change:0},avgTime:{current:"0:00",change:0}});let e=await fetch("/api/books",{headers:{}});if(e.ok){let r=await e.json();console.log("Statistics loaded:",r.data),r.data&&P({visitors:{current:r.data.uniqueVisitors||0,change:0},pageViews:{current:r.data.pageViews||0,change:0},bounceRate:{current:r.data.bounceRate||0,change:0},avgTime:{current:O(r.data.avgSessionDuration||0),change:0}})}}catch(e){console.error("Error loading statistics:",e),P({visitors:{current:0,change:0},pageViews:{current:0,change:0},bounceRate:{current:0,change:0},avgTime:{current:"0:00",change:0}})}finally{C(!1)}},O=e=>{let r=Math.floor(e/60);return"".concat(r,":").concat((e%60).toString().padStart(2,"0"))},Y=async e=>{E(e);try{let r=sessionStorage.getItem("admin_token");switch(e){case"cache-clear":let a=await fetch("/api/admin/cache/clear",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});if(a.ok){let e=await a.json();G(e.message||"\xd6nbellek başarıyla temizlendi!")}else K("\xd6nbellek temizleme başarısız!");break;case"backup-create":let t=await fetch("/api/admin/backup/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({includeData:!0,includeImages:!0})});t.ok?(await t.json(),G("Yedek başarıyla oluşturuldu!")):K("Yedek oluşturma başarısız!");break;case"seo-optimize":let s=await fetch("/api/admin/seo/optimize",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});if(s.ok){let e=await s.json();G(e.message||"SEO optimizasyonu tamamlandı!")}else K("SEO optimizasyonu başarısız!");break;case"performance-check":let i=await fetch("/api/admin/performance/test",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});if(i.ok){let e=await i.json();G(e.message||"Performans testi tamamlandı!")}else K("Performans testi başarısız!");break;default:K("Bilinmeyen işlem!")}}catch(e){console.error("Quick action error:",e),K("İşlem sırasında hata oluştu!")}finally{E(null)}},L=async()=>{let e=!A;try{let r=sessionStorage.getItem("admin_token"),a=await fetch("/api/settings/maintenance",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({maintenanceMode:e})});if(a.ok){let r=await a.json();e?localStorage.setItem("maintenanceMode","true"):localStorage.removeItem("maintenanceMode"),B(e),window.dispatchEvent(new StorageEvent("storage",{key:"maintenanceMode",newValue:e?"true":null,oldValue:A?"true":null,url:window.location.href})),G(r.message||(e?"Site bakım moduna alındı - Ziyaret\xe7iler bakım sayfasını g\xf6recek":"Bakım modu kapatıldı - Site normal \xe7alışıyor"))}else K("Bakım modu değiştirilemedi!")}catch(e){console.error("Maintenance mode error:",e),K("Bakım modu değiştirilirken hata oluştu!")}},G=e=>{let r=document.createElement("div");r.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center",r.innerHTML='<i class="ri-check-line mr-2"></i>'.concat(e),document.body.appendChild(r),setTimeout(()=>{r.remove()},3e3)},K=e=>{let r=document.createElement("div");r.className="fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center",r.innerHTML='<i class="ri-error-warning-line mr-2"></i>'.concat(e),document.body.appendChild(r),setTimeout(()=>{r.remove()},3e3)};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:"İstatistikler"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Site performansını ve ziyaret\xe7i verilerini g\xf6r\xfcnt\xfcleyin"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("button",{onClick:()=>{let e=!z;T(e),localStorage.setItem("adminDarkMode",e.toString()),e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),G(e?"Gece modu etkinleştirildi":"G\xfcnd\xfcz modu etkinleştirildi")},className:"w-12 h-6 rounded-full flex items-center transition-colors cursor-pointer ".concat(z?"bg-orange-500":"bg-gray-300"),children:(0,t.jsx)("div",{className:"w-5 h-5 bg-white dark:bg-gray-200 rounded-full shadow-md transform transition-transform ".concat(z?"translate-x-6":"translate-x-0.5")})}),(0,t.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:z?"Gece Modu":"G\xfcnd\xfcz Modu"}),(0,t.jsxs)("button",{onClick:L,className:"px-4 py-2 rounded-lg font-medium transition-colors cursor-pointer whitespace-nowrap flex items-center ".concat(A?"bg-red-500 hover:bg-red-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-600 dark:text-gray-200 dark:hover:bg-gray-500"),children:[(0,t.jsx)("i",{className:"mr-2 ".concat(A?"ri-tools-line":"ri-globe-line")}),A?"Bakım Modu: A\xe7ık":"Bakım Modu: Kapalı"]})]})]}),A&&(0,t.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("i",{className:"ri-error-warning-line text-red-500 mr-3 text-xl"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-red-800 dark:text-red-200",children:"Site Bakım Modunda"}),(0,t.jsx)("p",{className:"text-red-600 dark:text-red-300 text-sm mt-1",children:"Ziyaret\xe7iler şu anda bakım sayfasını g\xf6r\xfcyorlar. Site g\xfcncellemelerini tamamladıktan sonra bakım modunu kapatmayı unutmayın."})]})]})}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4",children:"Hızlı İşlemler"}),(0,t.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{id:"cache-clear",name:"\xd6nbellek Temizle",icon:"ri-refresh-line",description:"Site \xf6nbelleğini temizle",color:"bg-blue-500 hover:bg-blue-600"},{id:"backup-create",name:"Yedek Oluştur",icon:"ri-save-line",description:"Site yedeği oluştur",color:"bg-green-500 hover:bg-green-600"},{id:"seo-optimize",name:"SEO Optimizasyonu",icon:"ri-search-line",description:"SEO ayarlarını optimize et",color:"bg-purple-500 hover:bg-purple-600"},{id:"performance-check",name:"Performans Testi",icon:"ri-speed-line",description:"Site performansını kontrol et",color:"bg-orange-500 hover:bg-orange-600"}].map(e=>(0,t.jsx)("button",{onClick:()=>Y(e.id),disabled:D===e.id,className:"".concat(e.color," text-white p-4 rounded-lg transition-all duration-200 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"),children:(0,t.jsxs)("div",{className:"text-center",children:[D===e.id?(0,t.jsx)("div",{className:"animate-spin w-6 h-6 border-2 border-white border-t-transparent rounded-full mx-auto mb-2"}):(0,t.jsx)("i",{className:"".concat(e.icon," text-2xl mb-2")}),(0,t.jsx)("p",{className:"font-medium text-sm",children:e.name}),(0,t.jsx)("p",{className:"text-xs opacity-90 mt-1",children:e.description})]})},e.id))})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Zaman Aralığı:"}),(0,t.jsx)("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[{key:"7days",label:"7 G\xfcn"},{key:"30days",label:"30 G\xfcn"},{key:"3months",label:"3 Ay"},{key:"1year",label:"1 Yıl"}].map(e=>(0,t.jsx)("button",{onClick:()=>S(e.key),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors cursor-pointer whitespace-nowrap ".concat(w===e.key?"bg-white dark:bg-gray-600 text-orange-600 dark:text-orange-400 shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100"),children:e.label},e.key))})]}),_?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-orange-500 border-t-transparent rounded-full"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Ziyaret\xe7iler"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200",children:(null==I||null==(r=I.visitors)||null==(e=r.current)?void 0:e.toLocaleString())||"0"}),(0,t.jsxs)("div",{className:"flex items-center mt-1",children:[(0,t.jsx)("i",{className:"ri-arrow-".concat(((null==I||null==(a=I.visitors)?void 0:a.change)||0)>=0?"up":"down","-line text-sm mr-1 ").concat(((null==I||null==(i=I.visitors)?void 0:i.change)||0)>=0?"text-green-500":"text-red-500")}),(0,t.jsxs)("span",{className:"text-sm ".concat(((null==I||null==(l=I.visitors)?void 0:l.change)||0)>=0?"text-green-500":"text-red-500"),children:[Math.abs((null==I||null==(n=I.visitors)?void 0:n.change)||0),"%"]})]})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:(0,t.jsx)("i",{className:"ri-user-line text-blue-600 dark:text-blue-400 text-xl"})})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Sayfa G\xf6r\xfcnt\xfcleme"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200",children:(null==I||null==(d=I.pageViews)||null==(o=d.current)?void 0:o.toLocaleString())||"0"}),(0,t.jsxs)("div",{className:"flex items-center mt-1",children:[(0,t.jsx)("i",{className:"ri-arrow-".concat(((null==I||null==(c=I.pageViews)?void 0:c.change)||0)>=0?"up":"down","-line text-sm mr-1 ").concat(((null==I||null==(m=I.pageViews)?void 0:m.change)||0)>=0?"text-green-500":"text-red-500")}),(0,t.jsxs)("span",{className:"text-sm ".concat(((null==I||null==(x=I.pageViews)?void 0:x.change)||0)>=0?"text-green-500":"text-red-500"),children:[Math.abs((null==I||null==(g=I.pageViews)?void 0:g.change)||0),"%"]})]})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center",children:(0,t.jsx)("i",{className:"ri-eye-line text-green-600 dark:text-green-400 text-xl"})})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"\xc7ıkış Oranı"}),(0,t.jsxs)("p",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200",children:[(null==I||null==(u=I.bounceRate)?void 0:u.current)||0,"%"]}),(0,t.jsxs)("div",{className:"flex items-center mt-1",children:[(0,t.jsx)("i",{className:"ri-arrow-".concat(0>=((null==I||null==(h=I.bounceRate)?void 0:h.change)||0)?"down":"up","-line text-sm mr-1 ").concat(0>=((null==I||null==(y=I.bounceRate)?void 0:y.change)||0)?"text-green-500":"text-red-500")}),(0,t.jsxs)("span",{className:"text-sm ".concat(0>=((null==I||null==(b=I.bounceRate)?void 0:b.change)||0)?"text-green-500":"text-red-500"),children:[Math.abs((null==I||null==(p=I.bounceRate)?void 0:p.change)||0),"%"]})]})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:(0,t.jsx)("i",{className:"ri-logout-circle-line text-red-600 dark:text-red-400 text-xl"})})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Ortalama S\xfcre"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-800 dark:text-gray-200",children:(null==I||null==(k=I.avgTime)?void 0:k.current)||"0:00"}),(0,t.jsxs)("div",{className:"flex items-center mt-1",children:[(0,t.jsx)("i",{className:"ri-arrow-".concat(((null==I||null==(j=I.avgTime)?void 0:j.change)||0)>=0?"up":"down","-line text-sm mr-1 ").concat(((null==I||null==(f=I.avgTime)?void 0:f.change)||0)>=0?"text-green-500":"text-red-500")}),(0,t.jsxs)("span",{className:"text-sm ".concat(((null==I||null==(v=I.avgTime)?void 0:v.change)||0)>=0?"text-green-500":"text-red-500"),children:[Math.abs((null==I||null==(N=I.avgTime)?void 0:N.change)||0),"%"]})]})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center",children:(0,t.jsx)("i",{className:"ri-time-line text-purple-600 dark:text-purple-400 text-xl"})})]})})]}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4",children:"Ziyaret\xe7i Trendi"}),(0,t.jsx)("div",{className:"h-64 flex items-center justify-center text-gray-400 dark:text-gray-500",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("i",{className:"ri-line-chart-line text-4xl mb-2"}),(0,t.jsx)("p",{children:"Site a\xe7ıldığında veriler g\xf6r\xfcnecek"})]})})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4",children:"En \xc7ok Ziyaret Edilen Sayfalar"}),(0,t.jsx)("div",{className:"space-y-3",children:(0,t.jsxs)("div",{className:"text-center py-8 text-gray-400 dark:text-gray-500",children:[(0,t.jsx)("i",{className:"ri-file-list-line text-3xl mb-2"}),(0,t.jsx)("p",{children:"Site a\xe7ıldığında veriler g\xf6r\xfcnecek"})]})})]})]})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4",children:"Sistem Durumu"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,t.jsx)("i",{className:"ri-server-line text-2xl text-green-600 dark:text-green-400 mb-2"}),(0,t.jsx)("p",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:"Sunucu"}),(0,t.jsx)("p",{className:"text-xs text-green-600 dark:text-green-400",children:"\xc7alışıyor"})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,t.jsx)("i",{className:"ri-database-line text-2xl text-green-600 dark:text-green-400 mb-2"}),(0,t.jsx)("p",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:"Veritabanı"}),(0,t.jsx)("p",{className:"text-xs text-green-600 dark:text-green-400",children:"Bağlı"})]}),(0,t.jsxs)("div",{className:"text-center p-4 rounded-lg ".concat(A?"bg-red-50 dark:bg-red-900/20":"bg-green-50 dark:bg-green-900/20"),children:[(0,t.jsx)("i",{className:"ri-global-line text-2xl mb-2 ".concat(A?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400")}),(0,t.jsx)("p",{className:"text-sm font-medium ".concat(A?"text-red-800 dark:text-red-200":"text-green-800 dark:text-green-200"),children:"Site"}),(0,t.jsx)("p",{className:"text-xs ".concat(A?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"),children:A?"Bakımda":"Aktif"})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,t.jsx)("i",{className:"ri-shield-check-line text-2xl text-green-600 dark:text-green-400 mb-2"}),(0,t.jsx)("p",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:"G\xfcvenlik"}),(0,t.jsx)("p",{className:"text-xs text-green-600 dark:text-green-400",children:"G\xfcvenli"})]})]})]})]})}function g(e){let{label:r,value:a,onChange:i,onUploadComplete:l,accept:n="image/jpeg,image/png,image/webp,image/gif",maxSize:o=5242880,className:d=""}=e,[c,m]=(0,s.useState)(!1),[x,g]=(0,s.useState)(a),[u,h]=(0,s.useState)(""),y=(0,s.useRef)(null);(0,s.useEffect)(()=>{g(a)},[a]);let b=async e=>{var r;let a=null==(r=e.target.files)?void 0:r[0];if(a){if(a.size>o)return void h("Dosya boyutu \xe7ok b\xfcy\xfck. Maksimum ".concat(Math.round(o/1024/1024),"MB olabilir."));if(!n.split(",").some(e=>a.type.match(e.replace("*",".*"))))return void h("Desteklenmeyen dosya t\xfcr\xfc.");h(""),m(!0);try{console.log("Upload başlıyor...",a.name,"Size:",a.size,"Type:",a.type);let e=new FormData;e.append("file",a),e.append("type","image"),console.log("FormData oluşturuldu, file count:",e.getAll("file").length);let r=sessionStorage.getItem("admin_token"),t=await fetch("/api/upload",{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:e});console.log("Upload response:",t.status);let s=await t.json();if(console.log("Upload result:",s),s.success&&s.data){let e=s.data.url;console.log("Upload başarılı:",e),g(e),i(e),l&&l(e)}else throw console.error("Upload başarısız:",s),Error(s.error||"Y\xfckleme başarısız")}catch(e){console.error("Upload error:",e),h(e.message||"Dosya y\xfcklenirken hata oluştu.")}finally{m(!1),y.current&&(y.current.value="")}}};return(0,t.jsxs)("div",{className:d,children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:r}),u&&(0,t.jsx)("div",{className:"mb-3 p-2 bg-red-50 dark:bg-red-900/30 border border-red-300 dark:border-red-700 text-red-700 dark:text-red-300 text-xs rounded",children:u}),(0,t.jsxs)("div",{className:"space-y-3",children:[x&&(0,t.jsxs)("div",{className:"relative w-full bg-gray-200 dark:bg-gray-700 rounded-lg overflow-hidden",children:[(0,t.jsx)("img",{src:x,alt:"Preview",className:"w-full h-auto max-h-96 object-cover rounded-lg",style:{minHeight:"200px"},onError:e=>{console.log("Preview image error:",x),e.target.style.display="none"}}),(0,t.jsx)("button",{type:"button",onClick:()=>{g(""),i(""),y.current&&(y.current.value="")},className:"absolute top-2 right-2 bg-red-500 hover:bg-red-600 text-white p-2 rounded-full transition-colors",children:(0,t.jsx)("i",{className:"ri-delete-bin-line"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{ref:y,type:"file",accept:n,onChange:b,className:"hidden",id:"file-upload-".concat(r.replace(/\s/g,"-"))}),(0,t.jsx)("label",{htmlFor:"file-upload-".concat(r.replace(/\s/g,"-")),className:"\n              flex items-center justify-center w-full px-4 py-3 \n              border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg \n              cursor-pointer transition-all duration-200\n              ".concat(c?"opacity-50 cursor-not-allowed":"hover:border-orange-500 hover:bg-gray-50 dark:hover:bg-gray-700","\n            "),children:c?(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-gray-600 dark:text-gray-300",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-orange-500"}),(0,t.jsx)("span",{children:"Y\xfckleniyor..."})]}):(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-gray-500 dark:text-gray-400",children:[(0,t.jsx)("i",{className:"ri-upload-cloud-line text-xl"}),(0,t.jsx)("span",{children:x?"Farklı Resim Se\xe7":"Resim Y\xfckle"})]})})]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Desteklenen formatlar: JPG, PNG, WebP, GIF. Maksimum ",Math.round(o/1024/1024),"MB"]})]})]})}let u=()=>sessionStorage.getItem("admin_token")||"";function h(){var e;let[r,a]=(0,s.useState)([]),[i,l]=(0,s.useState)(!0),[n,o]=(0,s.useState)(!1),[d,c]=(0,s.useState)(null),[m,x]=(0,s.useState)({}),[h,y]=(0,s.useState)(!1),[b,p]=(0,s.useState)(null),[k,j]=(0,s.useState)(!1),[f,v]=(0,s.useState)(""),[N,w]=(0,s.useState)("success"),[S,_]=(0,s.useState)({title:"",description:"",content:"",cover_image:"",publish_date:"",status:"published",amazon_link:"",dr_link:"",idefix_link:"",author:"Tolga Demir",slug:""}),[C,z]=(0,s.useState)({title:"",content:"",order:1}),[T,A]=(0,s.useState)(!1);(0,s.useEffect)(()=>{P()},[]);let B=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";v(e),w(r),setTimeout(()=>v(""),4e3)},D=()=>{_({title:"",description:"",content:"",cover_image:"",publish_date:"",status:"published",amazon_link:"",dr_link:"",idefix_link:"",author:"Tolga Demir",slug:""}),c(null),o(!1)},E=()=>{z({title:"",content:"",order:1}),p(null),y(!1)},I=async e=>{let r={...e};try{let a=await fetch("/api/chapters?bookId=".concat(e.id),{headers:{Authorization:"Bearer ".concat(u())}});if(a.ok){let e=await a.json();e.success&&Array.isArray(e.data)&&(r.chapters=e.data)}}catch(e){console.error("B\xf6l\xfcmler y\xfcklenirken hata:",e),r.chapters=[]}c(r),_({title:e.title||"",slug:e.slug||"",description:e.description||"",content:e.content||"",cover_image:e.cover_image||"",publish_date:e.publish_date||"",status:e.status||"draft",amazon_link:e.amazon_link||"",dr_link:e.dr_link||"",idefix_link:e.idefix_link||"",author:e.author||"Tolga Demir"}),o(!0)},P=async()=>{try{l(!0);let e=u(),r={};e&&(r.Authorization="Bearer ".concat(e));let t=await fetch("/api/books?limit=100",{headers:r});if(!t.ok){console.error("❌ Books API request failed:",t.status),a([]);return}let s=await t.json();if(!s.success||!Array.isArray(s.data)){console.error("❌ Invalid books API response format:",s),a([]);return}let i=s.data,n=await Promise.all(i.map(async e=>{try{let r=await fetch("/api/chapters?bookId=".concat(e.id),{headers:{Authorization:"Bearer ".concat(u())}});if(!r.ok)return console.error("❌ Chapters API error for ".concat(e.title,":"),r.status),{...e,chapters:[]};let a=await r.json();if(a.success&&Array.isArray(a.data))return{...e,chapters:a.data};return console.warn("⚠️ No chapters data for ".concat(e.title)),{...e,chapters:[]}}catch(r){return console.error("❌ Chapter loading error for ".concat(e.title,":"),r),{...e,chapters:[]}}}));a(n)}catch(e){console.error("❌ Books loading error:",e),a([])}finally{l(!1)}},M=async()=>{if(!d&&!S.title.trim())return void B("Kitap başlığı gereklidir!","error");j(!0);try{let e=d?"/api/books/".concat(d.id):"/api/books",r=d?"PUT":"POST",a=await fetch(e,{method:r,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(u())},body:JSON.stringify(S)});if(!a.ok)throw Error(d?"G\xfcncelleme hatası":"Ekleme hatası");let t=await a.json();if(d)B("Kitap başarıyla g\xfcncellendi!","success"),D(),await P();else if(B("Kitap başarıyla eklendi! Şimdi b\xf6l\xfcm ekleyebilirsiniz.","success"),await P(),t.success&&t.data){let e=t.data;try{let r=await fetch("/api/chapters?bookId=".concat(e.id),{headers:{Authorization:"Bearer ".concat(u())}});if(r.ok){let a=await r.json();a.success&&(e.chapters=a.data)}}catch(r){console.error("B\xf6l\xfcmler y\xfcklenirken hata:",r),e.chapters=[]}c(e),_({title:e.title||"",slug:e.slug||"",description:e.description||"",content:e.content||"",cover_image:e.cover_image||"",publish_date:e.publish_date||"",status:e.status||"draft",amazon_link:e.amazon_link||"",dr_link:e.dr_link||"",idefix_link:e.idefix_link||"",author:e.author||"Tolga Demir"})}}catch(e){console.error("Save error:",e),B("Kaydetme sırasında hata oluştu!","error")}finally{j(!1)}},O=async e=>{if(confirm("Bu kitabı silmek istediğinizden emin misiniz?"))try{if(!(await fetch("/api/books/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(u())}})).ok)throw Error("Silme hatası");B("Kitap başarıyla silindi!","success"),await P()}catch(e){console.error("Delete error:",e),B("Silme sırasında hata oluştu!","error")}},Y=e=>{var a;let t=r.find(r=>r.id===e),s=(null==t||null==(a=t.chapters)?void 0:a.length)?t.chapters.length+1:1;p({bookId:e,chapterId:null}),z({title:"",content:"",order:s}),y(!0)},L=(e,r)=>{p({bookId:e,chapterId:r.id}),z({title:r.title||"",content:r.content||"",order:r.order_number||r.order||r.chapter_number||1}),y(!0)},G=async()=>{if(C.title.trim()?!!C.content.trim()||(B("B\xf6l\xfcm i\xe7eriği gereklidir!","error"),!1):(B("B\xf6l\xfcm başlığı gereklidir!","error"),!1)){j(!0);try{let{bookId:e,chapterId:r}=b,a=await fetch(r?"/api/chapters/".concat(r):"/api/chapters",{method:r?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(u())},body:JSON.stringify({book_id:e,title:C.title,content:C.content,order_number:C.order})});if(!a.ok){let e=await a.text();throw Error("HTTP ".concat(a.status," - ").concat(e))}let t=await a.json();if(!t.success)throw Error(t.error||"B\xf6l\xfcm işlemi hatalı");if(B(r?"B\xf6l\xfcm başarıyla g\xfcncellendi!":'B\xf6l\xfcm "'.concat(t.data.title,'" eklendi!'),"success"),E(),d&&d.id===e){let r=await fetch("/api/chapters?bookId=".concat(e),{headers:{Authorization:"Bearer ".concat(u())}});if(r.ok){let e=await r.json();e.success&&c({...d,chapters:e.data})}}await P()}catch(e){console.error("Chapter save error:",e),B("B\xf6l\xfcm kaydedilirken hata oluştu: "+e.message,"error")}finally{j(!1)}}},K=async(e,r)=>{if(confirm("Bu b\xf6l\xfcm\xfc silmek istediğinizden emin misiniz?"))try{let a=await fetch("/api/chapters/".concat(r),{method:"DELETE",headers:{Authorization:"Bearer ".concat(u())}});if(!a.ok){let e=await a.text();throw Error("Silme hatası: ".concat(a.status," - ").concat(e))}let t=await a.json();if(!t.success)throw Error(t.error||"Silme hatası");if(B("B\xf6l\xfcm başarıyla silindi!","success"),d&&d.id===e){let r=await fetch("/api/chapters?bookId=".concat(e),{headers:{Authorization:"Bearer ".concat(u())}});if(r.ok){let e=await r.json();e.success&&c({...d,chapters:e.data})}}await P()}catch(e){console.error("Chapter delete error:",e),B("B\xf6l\xfcm silinirken hata oluştu: "+e.message,"error")}};return i?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full"})}):(0,t.jsxs)("div",{className:"space-y-6",children:[f&&(0,t.jsx)("div",{className:"p-4 rounded-lg border ".concat("error"===N?"bg-red-50 text-red-700 border-red-200":"bg-green-50 text-green-700 border-green-200"),children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("i",{className:"".concat("error"===N?"ri-error-warning-line":"ri-check-circle-line"," mr-2")}),f]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Kitap Y\xf6netimi"}),(0,t.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:"Kitaplarınızı ve b\xf6l\xfcmlerini y\xf6netin"})]}),(0,t.jsxs)("button",{onClick:()=>o(!0),className:"bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-lg font-medium transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-add-line mr-2"}),"Yeni Kitap Ekle"]})]}),n&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:d?"Kitap D\xfczenle":"Yeni Kitap Ekle"}),(0,t.jsx)("button",{onClick:()=>{o(!1),c(null)},className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 cursor-pointer",children:(0,t.jsx)("i",{className:"ri-close-line text-xl"})})]}),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),M()},className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-100 mb-2",children:["Kitap Başlığı ",!d&&"*"]}),(0,t.jsx)("input",{type:"text",required:!d,value:S.title,onChange:e=>{let r=e.target.value,a=r.toLowerCase().replace(/[^a-z0-9\s-ğüşıöçĞÜŞİÖÇ]/g,"").replace(/[ğĞ]/g,"g").replace(/[üÜ]/g,"u").replace(/[şŞ]/g,"s").replace(/[ıİ]/g,"i").replace(/[öÖ]/g,"o").replace(/[çÇ]/g,"c").replace(/\s+/g,"-").replace(/-+/g,"-").trim();_({...S,title:r,slug:a})},className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Kitap başlığını girin"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-100 mb-2",children:"Yazar"}),(0,t.jsx)("input",{type:"text",value:S.author,onChange:e=>_({...S,author:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Yazar adı (varsayılan: Tolga Demir)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-100 mb-2",children:"URL Slug (otomatik oluşturulur)"}),(0,t.jsx)("input",{type:"text",value:S.slug,onChange:e=>_({...S,slug:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"url-slug-otomatik-olusur"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"URL'de kullanılacak slug. Başlık yazıldığında otomatik oluşturulur."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-100 mb-2",children:"A\xe7ıklama"}),(0,t.jsx)("textarea",{value:S.description,onChange:e=>_({...S,description:e.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Kitap a\xe7ıklaması"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-100 mb-2",children:"İ\xe7erik"}),(0,t.jsx)("textarea",{value:S.content,onChange:e=>_({...S,content:e.target.value}),rows:6,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Kitap i\xe7eriği veya \xf6zeti"})]}),(0,t.jsx)(g,{label:"Kapak Resmi",value:S.cover_image,onChange:e=>_({...S,cover_image:e})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-100 mb-2",children:"Yayın Tarihi"}),(0,t.jsx)("input",{type:"date",value:S.publish_date,onChange:e=>_({...S,publish_date:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-100 mb-2",children:"Durum"}),(0,t.jsxs)("select",{value:S.status,onChange:e=>_({...S,status:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent pr-8 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,t.jsx)("option",{value:"draft",children:"Taslak"}),(0,t.jsx)("option",{value:"published",children:"Yayında"}),(0,t.jsx)("option",{value:"archived",children:"Arşivlenmiş"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Satış Linkleri"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-100 mb-2",children:"Amazon Link"}),(0,t.jsx)("input",{type:"url",value:S.amazon_link,onChange:e=>_({...S,amazon_link:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"https://amazon.com/..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-100 mb-2",children:"Tamadres Link"}),(0,t.jsx)("input",{type:"url",value:S.dr_link,onChange:e=>_({...S,dr_link:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"https://tamadres.com/..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-100 mb-2",children:"BKM Kitap Link"}),(0,t.jsx)("input",{type:"url",value:S.idefix_link,onChange:e=>_({...S,idefix_link:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"https://bkmkitap.com/..."})]})]}),d&&(0,t.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["B\xf6l\xfcmler (",(null==(e=d.chapters)?void 0:e.length)||0,")"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>Y(d.id),className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-add-line mr-2"}),"B\xf6l\xfcm Ekle"]})]}),d.chapters&&0!==d.chapters.length?(0,t.jsx)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:d.chapters.sort((e,r)=>(e.order_number||e.order||e.chapter_number||0)-(r.order_number||r.order||r.chapter_number||0)).map(e=>{var r;return(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h5",{className:"font-medium text-gray-900 dark:text-white",children:e.title}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Sıra: ",e.order_number||e.order||e.chapter_number," • İ\xe7erik: ",(null==(r=e.content)?void 0:r.length)||0," karakter"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>L(d.id,e),className:"px-3 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded text-sm transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-edit-line mr-1"}),"D\xfczenle"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>K(d.id,e.id),className:"px-3 py-1 bg-red-100 hover:bg-red-200 text-red-700 rounded text-sm transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-delete-bin-line mr-1"}),"Sil"]})]})]},e.id)})}):(0,t.jsxs)("div",{className:"text-center py-8 bg-gray-50 dark:bg-gray-900 rounded-lg",children:[(0,t.jsx)("i",{className:"ri-article-line text-4xl text-gray-300 dark:text-gray-600 mb-3"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Hen\xfcz b\xf6l\xfcm eklenmemiş"})]})]}),(0,t.jsxs)("div",{className:"flex space-x-4 pt-6",children:[(0,t.jsx)("button",{type:"submit",disabled:k,className:"flex-1 bg-orange-500 hover:bg-orange-600 text-white py-3 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer whitespace-nowrap",children:k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),"Kaydediliyor..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("i",{className:"ri-save-line mr-2"}),d?"G\xfcncelle":"Kaydet"]})}),(0,t.jsx)("button",{type:"button",onClick:D,className:"px-6 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer whitespace-nowrap",children:"İptal"})]})]})]})}),h&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:(null==b?void 0:b.chapterId)?"B\xf6l\xfcm D\xfczenle":"Yeni B\xf6l\xfcm Ekle"}),(0,t.jsx)("button",{onClick:E,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 cursor-pointer",children:(0,t.jsx)("i",{className:"ri-close-line text-xl"})})]}),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),G()},className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-100 mb-2",children:"B\xf6l\xfcm Başlığı *"}),(0,t.jsx)("input",{type:"text",required:!0,value:C.title,onChange:e=>z({...C,title:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"B\xf6l\xfcm başlığını girin"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-100 mb-2",children:"Sıra Numarası"}),(0,t.jsx)("input",{type:"number",min:"1",value:C.order,onChange:e=>z({...C,order:parseInt(e.target.value)||1}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-800 dark:text-gray-100 mb-2",children:["B\xf6l\xfcm İ\xe7eriği *",(0,t.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Tab: girinti ekle, \xc7ift Enter: yeni paragraf)"})]}),(0,t.jsx)("textarea",{required:!0,value:C.content,onChange:e=>z({...C,content:e.target.value}),onKeyDown:e=>{if("Tab"===e.key){e.preventDefault();let r=e.currentTarget,a=r.selectionStart,t=r.selectionEnd,s=C.content,i=s.substring(0,a)+"     "+s.substring(t);z({...C,content:i}),setTimeout(()=>{r.selectionStart=r.selectionEnd=a+5},0)}},onPaste:e=>{e.preventDefault();let r=e.clipboardData.getData("text");console.log("\uD83D\uDD0D Paste event tetiklendi"),console.log("\uD83D\uDCCB Orijinal metin:",r);let a=r.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\u00A0/g," ").replace(/\uFEFF/g,"").replace(/\u2013/g,"-").replace(/\u2014/g,"--").replace(/\u2018/g,"'").replace(/\u2019/g,"'").replace(/\u201C/g,'"').replace(/\u201D/g,'"');console.log("\uD83E\uDDF9 Temizlenmiş metin:",a),console.log("\uD83D\uDD0D Orijinal \xe7ift satır sonları:",(a.match(/\n\s*\n/g)||[]).length),console.log("\uD83D\uDD0D İşlenmiş \xe7ift satır sonları:",((a=(a=(a=(a=a.replace(/([.!?])\s*\n/g,"$1\n\n")).replace(/([.!?])\n([A-ZĞÜŞİÖÇ])/g,"$1\n\n$2")).replace(/\n(\s*[""''])/g,"\n\n$1")).replace(/\n\n([A-ZĞÜŞİÖÇ][a-zığüşöçĞÜŞİÖÇ]{1,2})\n/g,"\n$1\n")).match(/\n\s*\n/g)||[]).length);let t=a.split(/\n\s*\n/);console.log("\uD83D\uDCDD Paragraflar:",t.length),console.log("✅ İşlenmiş metin:",(a=t.map((e,r)=>{let a=e.trim();console.log("\uD83D\uDCC4 Paragraf ".concat(r+1,":"),a.substring(0,50)+"...");let t=a.match(/^(\s+)/),s=t&&t[1].length>0;return a=(a=a.replace(/([a-zığüşöçĞÜŞİÖÇ])\n([a-zığüşöçĞÜŞİÖÇ])/g,"$1 $2")).replace(/\s+/g," "),s&&(a="    "+a.trim()),a}).filter(e=>e.length>0).join("\n\n")).substring(0,100)+"..."),a=a.trim();let s=e.currentTarget,i=s.selectionStart,l=s.selectionEnd,n=C.content,o=n.substring(0,i)+a+n.substring(l);z({...C,content:o}),setTimeout(()=>{s.selectionStart=s.selectionEnd=i+a.length,s.scrollTop=s.scrollHeight,s.focus()},0)},rows:20,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-mono",placeholder:"B\xf6l\xfcm i\xe7eriğini yazın veya yapıştırın...  \uD83D\uDD27 DEBUG MODE: Paste fonksiyonu aktif \uD83D\uDCDD Gelişmiş paragraf algılama ✅ PDF'den gelen paragraflar korunur ✅ Console'da debug logları g\xf6r\xfcn",style:{whiteSpace:"pre-wrap",overflowWrap:"break-word",lineHeight:"1.8"}}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"\uD83D\uDD27 DEBUG: Paste fonksiyonu aktif. Gelişmiş paragraf algılama - PDF'den gelen paragraflar korunur. Console'da debug logları g\xf6r\xfcn."})]}),(0,t.jsxs)("div",{className:"flex space-x-4 pt-6",children:[(0,t.jsx)("button",{type:"submit",disabled:k,className:"flex-1 bg-orange-500 hover:bg-orange-600 text-white py-3 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer whitespace-nowrap",children:k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),"Kaydediliyor..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("i",{className:"ri-save-line mr-2"}),(null==b?void 0:b.chapterId)?"G\xfcncelle":"Kaydet"]})}),(0,t.jsx)("button",{type:"button",onClick:E,className:"px-6 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer whitespace-nowrap",children:"İptal"})]})]})]})}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-6",children:0===r.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("i",{className:"ri-book-line text-6xl text-gray-300 dark:text-gray-600 mb-4"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:"Hen\xfcz kitap eklenmemiş"}),(0,t.jsx)("button",{onClick:()=>o(!0),className:"mt-4 bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:"İlk Kitabınızı Ekleyin"})]}):r.map(e=>{var r,a;return(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-start space-x-4",children:[e.cover_image&&(0,t.jsx)("img",{src:e.cover_image,alt:e.title,className:"w-24 h-32 object-cover object-top rounded-lg"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:e.title}),(0,t.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-3",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsxs)("span",{children:[(0,t.jsx)("i",{className:"ri-calendar-line mr-1"}),e.publish_date?new Date(e.publish_date).toLocaleDateString("tr-TR"):"Tarih yok"]}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("published"===e.status?"bg-green-100 text-green-700":"draft"===e.status?"bg-yellow-100 text-yellow-700":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:"published"===e.status?"Yayında":"draft"===e.status?"Taslak":"Arşivlenmiş"}),(0,t.jsxs)("span",{children:[(0,t.jsx)("i",{className:"ri-file-text-line mr-1"}),(null==(r=e.chapters)?void 0:r.length)||0," B\xf6l\xfcm"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("button",{onClick:()=>{var r;return r=e.id,void x(e=>({...e,[r]:!e[r]}))},className:"px-3 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-list-check-2 mr-1"}),m[e.id]?"B\xf6l\xfcmleri Gizle":"B\xf6l\xfcmleri G\xf6ster"]}),(0,t.jsxs)("button",{onClick:()=>I(e),className:"px-3 py-2 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 text-gray-700 dark:text-gray-200 rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-edit-line mr-1"}),"D\xfczenle"]}),(0,t.jsxs)("button",{onClick:()=>O(e.id),className:"px-3 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-delete-bin-line mr-1"}),"Sil"]})]})]}),(e.amazon_link||e.dr_link||e.idefix_link)&&(0,t.jsxs)("div",{className:"mt-4 flex items-center space-x-3",children:[(0,t.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Satış linkleri:"}),e.amazon_link&&(0,t.jsx)("a",{href:e.amazon_link,target:"_blank",rel:"noopener noreferrer",className:"text-orange-600 hover:text-orange-800",children:(0,t.jsx)("i",{className:"ri-amazon-line text-lg"})}),e.dr_link&&(0,t.jsx)("a",{href:e.dr_link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:(0,t.jsx)("i",{className:"ri-store-line text-lg"})}),e.idefix_link&&(0,t.jsx)("a",{href:e.idefix_link,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:text-green-800",children:(0,t.jsx)("i",{className:"ri-book-open-line text-lg"})})]})]})]})}),m[e.id]&&(0,t.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("h4",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["B\xf6l\xfcmler (",(null==(a=e.chapters)?void 0:a.length)||0,")"]}),(0,t.jsxs)("button",{onClick:()=>Y(e.id),className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-add-line mr-2"}),"Yeni B\xf6l\xfcm Ekle"]})]}),e.chapters&&0!==e.chapters.length?(0,t.jsx)("div",{className:"space-y-3",children:e.chapters.sort((e,r)=>(e.order||e.chapter_number||0)-(r.order||r.chapter_number||0)).map(r=>{var a;return(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h5",{className:"font-medium text-gray-900 dark:text-white",children:r.title}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Sıra: ",r.order_number||r.order||r.chapter_number," • İ\xe7erik:"," ",(null==(a=r.content)?void 0:a.length)||0," karakter"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("button",{onClick:()=>L(e.id,r),className:"px-3 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded text-sm transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-edit-line mr-1"}),"D\xfczenle"]}),(0,t.jsxs)("button",{onClick:()=>K(e.id,r.id),className:"px-3 py-1 bg-red-100 hover:bg-red-200 text-red-700 rounded text-sm transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-delete-bin-line mr-1"}),"Sil"]})]})]},r.id)})}):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("i",{className:"ri-article-line text-4xl text-gray-300 mb-3"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Bu kitaba hen\xfcz b\xf6l\xfcm eklenmemiş"}),(0,t.jsx)("button",{onClick:()=>Y(e.id),className:"mt-3 bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded",children:"B\xf6l\xfcm Ekle"})]})]})]},e.id)})})]})}let y=()=>sessionStorage.getItem("admin_token")||"";function b(){let[e,r]=(0,s.useState)([]),[a,i]=(0,s.useState)([]),[l,n]=(0,s.useState)(!0),[o,d]=(0,s.useState)(!1),[c,m]=(0,s.useState)(null),[x,g]=(0,s.useState)([]),[u,h]=(0,s.useState)("grid"),[b,p]=(0,s.useState)("all"),[k,j]=(0,s.useState)(""),[f,v]=(0,s.useState)(!1),[N,w]=(0,s.useState)(""),[S,_]=(0,s.useState)("success"),[C,z]=(0,s.useState)("media"),[T,A]=(0,s.useState)({alt_text:"",description:"",is_public:!0});(0,s.useEffect)(()=>{"media"===C?E():D()},[C]);let B=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";w(e),_(r),setTimeout(()=>w(""),4e3)},D=async()=>{try{n(!0),console.log("=== LOADING BACKUPS ===");let e=y(),r=await fetch("/api/admin/backup/list",{headers:{Authorization:"Bearer ".concat(e)}});if(console.log("Backups API Response Status:",r.status),r.ok){let e=await r.json();console.log("Backups API Response:",e),e.success&&e.data?(i(e.data),console.log("✅ Backups loaded successfully:",e.data.length,"backups")):(console.error("API returned invalid data structure:",e),i([]))}else{let e=await r.text();console.error("Backups API error:",r.status,e),i([])}}catch(e){console.error("=== LOAD BACKUPS ERROR ==="),console.error("Error details:",e),i([])}finally{console.log("=== LOADING BACKUPS COMPLETE ==="),n(!1)}},E=async()=>{try{n(!0),console.log("=== LOADING MEDIA FILES ===");let e=y(),a=await fetch("/api/admin/media/list",{headers:{Authorization:"Bearer ".concat(e)}});if(console.log("Media API Response Status:",a.status),a.ok){let e=await a.json();console.log("Media API Response:",e),e.success&&e.data?(r(e.data),console.log("✅ Media files loaded successfully:",e.data.length,"files")):(console.error("API returned invalid data structure:",e),r([]))}else{let e=await a.text();console.error("Media API error:",a.status,e),r([])}}catch(e){console.error("=== LOAD MEDIA FILES ERROR ==="),console.error("Error details:",e),r([])}finally{console.log("=== LOADING COMPLETE ==="),n(!1)}},I=async e=>{let r=e.target.files;if(r&&0!==r.length){v(!0);try{for(let e of Array.from(r)){if(e.size>5242880){B("".concat(e.name," dosyası \xe7ok b\xfcy\xfck (max 5MB)"),"error");continue}if(!e.type.startsWith("image/")&&!e.type.startsWith("video/")&&"application/pdf"!==e.type){B("".concat(e.name," desteklenmeyen dosya t\xfcr\xfc"),"error");continue}let r=await P(e),a={filename:e.name,file_data:r,file_size:e.size,file_type:e.type,alt_text:"",description:"",is_public:!0};console.log("Uploading file:",e.name);let t=await fetch("/api/books",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok){let r=await t.text();console.error("Upload error:",t.status,r),B("".concat(e.name," y\xfcklenirken hata oluştu"),"error");continue}let s=await t.json();s.success?console.log("✅ File uploaded successfully:",e.name):(console.error("Upload failed:",s.error),B("".concat(e.name," y\xfckleme hatası: ").concat(s.error),"error"))}B("Dosya(lar) başarıyla y\xfcklendi!","success"),await E(),d(!1)}catch(e){console.error("File upload error:",e),B("Dosya y\xfckleme hatası: "+(e instanceof Error?e.message:String(e)),"error")}finally{v(!1)}}},P=e=>new Promise((r,a)=>{let t=new FileReader;t.readAsDataURL(e),t.onload=()=>r(t.result),t.onerror=e=>a(e)}),M=e=>{m(e),A({alt_text:e.alt_text||"",description:e.description||"",is_public:!1!==e.is_public})},O=async()=>{if(c){v(!0);try{let e=await fetch("/api/books",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let r=await e.json();if(r.success)B("Medya bilgileri g\xfcncellendi!","success"),await E(),m(null);else throw Error(r.error||"G\xfcncelleme hatası")}catch(e){console.error("Update error:",e),B("G\xfcncelleme sırasında hata oluştu!","error")}finally{v(!1)}}},Y=async r=>{if(confirm("Bu medya dosyasını silmek istediğinizden emin misiniz?"))try{let a=e.find(e=>e.id===r);if(!a||!a.file_path)return void B("Silinecek dosya bulunamadı!","error");let t=y(),s=await fetch("/api/admin/media/delete?path=".concat(encodeURIComponent(a.file_path)),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}});if(!s.ok){let e=await s.text();throw console.error("Delete API error:",s.status,e),Error("HTTP error! status: ".concat(s.status))}let i=await s.json();if(i.success)B("Medya dosyası silindi!","success"),await E();else throw Error(i.error||"Silme hatası")}catch(e){console.error("Delete error:",e),B("Silme sırasında hata oluştu!","error")}},L=async()=>{if(0!==x.length&&confirm("".concat(x.length," dosyayı silmek istediğinizden emin misiniz?")))try{await Promise.all(x.map(e=>Y(e))),g([])}catch(e){console.error("Bulk delete error:",e)}},G=e=>{navigator.clipboard.writeText(e),B("URL panoya kopyalandı!","success")},K=e=>{if(0===e)return"0 Bytes";let r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(2))+" "+["Bytes","KB","MB","GB"][r]},R=e=>e.startsWith("image/")?"ri-image-line":e.startsWith("video/")?"ri-video-line":"application/pdf"===e?"ri-file-pdf-line":"ri-file-line",F=e.filter(e=>{var r;return!!e&&!!e.file_type&&!!e.filename&&("all"===b||!!e.file_type.startsWith(b))&&(!k||!!e.filename.toLowerCase().includes(k.toLowerCase())||!!(null==(r=e.description)?void 0:r.toLowerCase().includes(k.toLowerCase())))});return l?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full"})}):(0,t.jsxs)("div",{className:"space-y-6",children:[N&&(0,t.jsx)("div",{className:"p-4 rounded-lg border ".concat("error"===S?"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 border-red-200 dark:border-red-700":"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 border-green-200 dark:border-green-700"),children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("i",{className:"".concat("error"===S?"ri-error-warning-line":"ri-check-circle-line"," mr-2")}),N]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Medya Y\xf6netimi"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Sitede kullanılan medya dosyalarını ve yedekleri y\xf6netin"})]}),"media"===C?(0,t.jsxs)("button",{onClick:()=>d(!0),className:"bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-lg font-medium transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-upload-line mr-2"}),"Dosya Y\xfckle"]}):null]}),(0,t.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("nav",{className:"flex space-x-8",children:[(0,t.jsxs)("button",{onClick:()=>z("media"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("media"===C?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,t.jsx)("i",{className:"ri-image-line mr-2"}),"Medya Dosyaları"]}),(0,t.jsxs)("button",{onClick:()=>z("backups"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("backups"===C?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,t.jsx)("i",{className:"ri-database-2-line mr-2"}),"Sistem Yedekleri"]})]})}),"media"===C?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Toplam Dosya"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:e.length})]}),(0,t.jsx)("i",{className:"ri-folder-line text-2xl text-blue-500"})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"G\xf6rsel"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:e.filter(e=>e&&e.file_type&&e.file_type.startsWith("image/")).length})]}),(0,t.jsx)("i",{className:"ri-image-line text-2xl text-green-500"})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Video"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:e.filter(e=>e&&e.file_type&&e.file_type.startsWith("video/")).length})]}),(0,t.jsx)("i",{className:"ri-video-line text-2xl text-purple-500"})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Toplam Boyut"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:K(e.reduce((e,r)=>e+r.file_size,0))})]}),(0,t.jsx)("i",{className:"ri-hard-drive-line text-2xl text-orange-500"})]})})]})}):(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Toplam Yedek"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:a.length})]}),(0,t.jsx)("i",{className:"ri-database-2-line text-2xl text-blue-500"})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Son Yedekleme"}),(0,t.jsx)("p",{className:"text-xl font-bold text-green-600",children:a.length>0?new Date(a[0].createdAt).toLocaleDateString("tr-TR"):"Yedek yok"})]}),(0,t.jsx)("i",{className:"ri-time-line text-2xl text-green-500"})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Toplam Boyut"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:K(a.reduce((e,r)=>e+(r.size||0),0))})]}),(0,t.jsx)("i",{className:"ri-hard-drive-line text-2xl text-orange-500"})]})})]})}),"media"===C&&(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"T\xfcr:"}),(0,t.jsxs)("select",{value:b,onChange:e=>p(e.target.value),className:"bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500 pr-8",children:[(0,t.jsx)("option",{value:"all",children:"T\xfcm\xfc"}),(0,t.jsx)("option",{value:"image",children:"G\xf6rsel"}),(0,t.jsx)("option",{value:"video",children:"Video"}),(0,t.jsx)("option",{value:"application",children:"Belge"})]})]}),(0,t.jsx)("div",{className:"flex items-center space-x-2",children:(0,t.jsx)("input",{type:"text",placeholder:"Dosya ara...",value:k,onChange:e=>j(e.target.value),className:"border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("button",{onClick:()=>{x.length===F.length?g([]):g(F.map(e=>e.id))},className:"bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg text-sm transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"".concat(x.length===F.length&&F.length>0?"ri-checkbox-line":"ri-checkbox-blank-line"," mr-1")}),x.length===F.length&&F.length>0?"Se\xe7imi Kaldır":"Hepsini Se\xe7"]}),x.length>0&&(0,t.jsxs)("button",{onClick:L,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-delete-bin-line mr-1"}),"Se\xe7ilenleri Sil (",x.length,")"]}),(0,t.jsxs)("div",{className:"flex bg-gray-100 dark:bg-gray-800 rounded-lg p-1",children:[(0,t.jsx)("button",{onClick:()=>h("grid"),className:"px-3 py-1 rounded text-sm transition-colors cursor-pointer ".concat("grid"===u?"bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400"),children:(0,t.jsx)("i",{className:"ri-grid-line"})}),(0,t.jsx)("button",{onClick:()=>h("list"),className:"px-3 py-1 rounded text-sm transition-colors cursor-pointer ".concat("list"===u?"bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400"),children:(0,t.jsx)("i",{className:"ri-list-check"})})]})]})]})}),o&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-md",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Dosya Y\xfckle"}),(0,t.jsx)("button",{onClick:()=>d(!1),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 cursor-pointer",children:(0,t.jsx)("i",{className:"ri-close-line text-xl"})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center",children:[(0,t.jsx)("i",{className:"ri-upload-cloud-line text-4xl text-gray-400 mb-4"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Dosyaları s\xfcr\xfckleyip bırakın veya se\xe7in"}),(0,t.jsx)("input",{type:"file",multiple:!0,accept:"image/*,video/*,.pdf",onChange:I,disabled:f,className:"w-full"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"Desteklenen formatlar: JPG, PNG, GIF, MP4, PDF (Max 5MB)"})]}),f&&(0,t.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,t.jsx)("div",{className:"animate-spin w-6 h-6 border-2 border-orange-500 border-t-transparent rounded-full"}),(0,t.jsx)("span",{className:"ml-3 text-gray-600",children:"Y\xfckleniyor..."})]})]})]})}),c&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-md",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Medya D\xfczenle"}),(0,t.jsx)("button",{onClick:()=>m(null),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 cursor-pointer",children:(0,t.jsx)("i",{className:"ri-close-line text-xl"})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Alt Metin"}),(0,t.jsx)("input",{type:"text",value:T.alt_text,onChange:e=>A({...T,alt_text:e.target.value}),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"A\xe7ıklama"}),(0,t.jsx)("textarea",{value:T.description,onChange:e=>A({...T,description:e.target.value}),rows:3,className:"w-full px-4 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",id:"is_public",checked:T.is_public,onChange:e=>A({...T,is_public:e.target.checked}),className:"mr-2"}),(0,t.jsx)("label",{htmlFor:"is_public",className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Herkese a\xe7ık"})]}),(0,t.jsxs)("div",{className:"flex space-x-4 pt-4",children:[(0,t.jsx)("button",{onClick:O,disabled:f,className:"flex-1 bg-orange-500 hover:bg-orange-600 text-white py-2 rounded-lg font-medium transition-colors disabled:opacity-50 cursor-pointer whitespace-nowrap",children:f?"G\xfcncelleniyor...":"G\xfcncelle"}),(0,t.jsx)("button",{onClick:()=>m(null),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors cursor-pointer whitespace-nowrap",children:"İptal"})]})]})]})}),"media"===C?(0,t.jsx)(t.Fragment,{children:0===F.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("i",{className:"ri-folder-line text-6xl text-gray-300 mb-4"}),(0,t.jsx)("p",{className:"text-gray-500 text-lg",children:k||"all"!==b?"Arama kriterlerine uygun dosya bulunamadı":"Hen\xfcz medya dosyası y\xfcklenmemiş"}),!k&&"all"===b&&(0,t.jsx)("button",{onClick:()=>d(!0),className:"mt-4 bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:"İlk Dosyanızı Y\xfckleyin"})]}):"grid"===u?(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:F.map((e,r)=>(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-md transition-shadow",children:[(0,t.jsxs)("div",{className:"aspect-square relative",children:[e.file_type&&e.file_type.startsWith("image/")?(0,t.jsx)("img",{src:e.file_path,alt:e.alt_text||e.filename,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-gray-700",children:(0,t.jsx)("i",{className:"".concat(R(e.file_type)," text-4xl text-gray-400")})}),(0,t.jsx)("div",{className:"absolute top-2 left-2",children:(0,t.jsx)("input",{type:"checkbox",checked:x.includes(e.id),onChange:r=>{r.target.checked?g([...x,e.id]):g(x.filter(r=>r!==e.id))},className:"rounded"})})]}),(0,t.jsxs)("div",{className:"p-3",children:[(0,t.jsx)("h4",{className:"font-medium text-sm text-gray-800 dark:text-gray-100 truncate",title:e.filename,children:e.filename}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:K(e.file_size)}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,t.jsxs)("button",{onClick:()=>G(e.file_path),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 cursor-pointer",children:[(0,t.jsx)("i",{className:"ri-link mr-1"}),"Kopyala"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)("button",{onClick:()=>M(e),className:"w-6 h-6 flex items-center justify-center text-gray-400 dark:text-gray-500 hover:text-blue-600 dark:hover:text-blue-400 cursor-pointer",children:(0,t.jsx)("i",{className:"ri-edit-line text-xs"})}),(0,t.jsx)("button",{onClick:()=>Y(e.id),className:"w-6 h-6 flex items-center justify-center text-gray-400 dark:text-gray-500 hover:text-red-600 dark:hover:text-red-400 cursor-pointer",children:(0,t.jsx)("i",{className:"ri-delete-bin-line text-xs"})})]})]})]})]},e.id||"file-".concat(r)))}):(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsx)("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:F.map((e,r)=>(0,t.jsx)("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("input",{type:"checkbox",checked:x.includes(e.id),onChange:r=>{r.target.checked?g([...x,e.id]):g(x.filter(r=>r!==e.id))},className:"rounded"}),(0,t.jsx)("div",{className:"w-12 h-12 flex-shrink-0",children:e.file_type&&e.file_type.startsWith("image/")?(0,t.jsx)("img",{src:e.file_path,alt:e.alt_text||e.filename,className:"w-full h-full object-cover rounded"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-gray-700 rounded",children:(0,t.jsx)("i",{className:"".concat(R(e.file_type)," text-xl text-gray-400")})})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800 dark:text-gray-100 truncate",children:e.filename}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500 dark:text-gray-400 mt-1",children:[(0,t.jsx)("span",{children:K(e.file_size)}),(0,t.jsx)("span",{children:new Date(e.upload_date).toLocaleDateString("tr-TR")}),(0,t.jsxs)("span",{children:["Kullanım: ",e.usage_count||0]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("button",{onClick:()=>G(e.file_path),className:"px-3 py-1 bg-blue-100 dark:bg-blue-900/20 hover:bg-blue-200 dark:hover:bg-blue-800/30 text-blue-700 dark:text-blue-300 rounded text-sm transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-link mr-1"}),"Kopyala"]}),(0,t.jsxs)("button",{onClick:()=>M(e),className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded text-sm transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-edit-line mr-1"}),"D\xfczenle"]}),(0,t.jsxs)("button",{onClick:()=>Y(e.id),className:"px-3 py-1 bg-red-100 dark:bg-red-900/20 hover:bg-red-200 dark:hover:bg-red-800/30 text-red-700 dark:text-red-300 rounded text-sm transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-delete-bin-line mr-1"}),"Sil"]})]})]})},e.id||"list-file-".concat(r)))})})}):(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:0===a.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("i",{className:"ri-database-2-line text-6xl text-gray-300 mb-4"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-lg",children:"Hen\xfcz yedek bulunmuyor"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:'Dashboard\'daki "Yedek Oluştur" butonunu kullanarak ilk yedeğinizi oluşturabilirsiniz.'})]}):(0,t.jsx)("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:a.map((e,r)=>{var a,s,i,l;return(0,t.jsx)("div",{className:"p-5 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-lg text-gray-800 dark:text-gray-100",children:e.name}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2 text-sm text-gray-500 dark:text-gray-400 mt-2",children:[(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)("i",{className:"ri-time-line mr-1"}),new Date(e.createdAt).toLocaleString("tr-TR")]}),(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)("i",{className:"ri-file-list-line mr-1"}),"number"==typeof e.files?"".concat(e.files," dosya"):e.files]}),(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)("i",{className:"ri-hard-drive-line mr-1"}),K(e.size)]}),(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)("i",{className:"ri-database-2-line mr-1"}),(null==(a=e.options)?void 0:a.includeData)?"Veri":"",(null==(s=e.options)?void 0:s.includeData)&&(null==(i=e.options)?void 0:i.includeImages)?" + ":"",(null==(l=e.options)?void 0:l.includeImages)?"G\xf6rsel":""]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsxs)("button",{onClick:async()=>{if(confirm('"'.concat(e.name,'" yedeğini geri y\xfcklemek istediğinize emin misiniz? Bu işlem mevcut verilerin \xfczerine yazacaktır.')))try{v(!0);let r=y(),a=await fetch("/api/admin/backup/restore",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({backupName:e.name})});if(a.ok){let e=await a.json();e.success?B("Yedek başarıyla geri y\xfcklendi!","success"):B("Hata: ".concat(e.error||"Yedek geri y\xfcklenemedi"),"error")}else B("Yedek geri y\xfckleme başarısız oldu.","error")}catch(e){console.error("Yedek geri y\xfckleme hatası:",e),B("Yedek geri y\xfcklenirken bir hata oluştu.","error")}finally{v(!1)}},className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm transition-colors cursor-pointer whitespace-nowrap",disabled:f,children:[(0,t.jsx)("i",{className:"ri-restart-line mr-1"}),"Geri Y\xfckle"]}),(0,t.jsxs)("button",{onClick:async()=>{if(confirm('"'.concat(e.name,'" yedeğini silmek istediğinize emin misiniz? Bu işlem geri alınamaz.')))try{v(!0);let r=y(),a=await fetch("/api/admin/backup/delete?name=".concat(encodeURIComponent(e.name)),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r)}});if(a.ok){let e=await a.json();e.success?(B("Yedek başarıyla silindi!","success"),D()):B("Hata: ".concat(e.error||"Yedek silinemedi"),"error")}else{let e=await a.text();console.error("Backup delete API error:",a.status,e),B("Yedek silme başarısız oldu: ".concat(a.status),"error")}}catch(e){console.error("Yedek silme hatası:",e),B("Yedek silinirken bir hata oluştu.","error")}finally{v(!1)}},className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm transition-colors cursor-pointer whitespace-nowrap",disabled:f,children:[(0,t.jsx)("i",{className:"ri-delete-bin-line mr-1"}),"Sil"]})]})]})},e.name||"backup-".concat(r))})})})})]})}let p=()=>sessionStorage.getItem("admin_token")||"";function k(){let[e,r]=(0,s.useState)([]),[a,i]=(0,s.useState)(null),[l,n]=(0,s.useState)("all"),[o,d]=(0,s.useState)(!0),[c,m]=(0,s.useState)(""),[x,g]=(0,s.useState)(!1);(0,s.useEffect)(()=>{u()},[l]);let u=async()=>{try{d(!0);let e=await fetch("/api/messages",{headers:{Authorization:"Bearer ".concat(p())}});if(e.ok){let a=await e.json();a.success&&Array.isArray(a.data)?r(a.data):r([])}else console.error("Mesajlar y\xfcklenemedi"),r([])}catch(e){console.error("Error loading messages:",e),r([])}finally{d(!1)}},h=e.filter(e=>"all"===l||e.status===l),y=e.filter(e=>"unread"===e.status).length,b=async a=>{if(i(a),"unread"===a.status)try{(await fetch("/api/messages",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(p())},body:JSON.stringify({id:a.id,status:"read"})})).ok?await u():r(e.map(e=>e.id===a.id?{...e,status:"read"}:e))}catch(t){console.error("Error updating message status:",t),r(e.map(e=>e.id===a.id?{...e,status:"read"}:e))}},k=async()=>{if(a&&c.trim()){g(!0);try{let e=await fetch("/api/messages",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(p())},body:JSON.stringify({id:a.id,reply:c.trim(),status:"replied"})});if(e.ok){let r=await e.json();if(r.success)await u(),m(""),i(null),alert("✅ Cevap kaydedildi!\n\n\uD83D\uDCA1 Manuel mail g\xf6nderimi:\n\uD83D\uDCE7 Alıcı: ".concat(a.email,"\n\uD83D\uDCE8 Konu: Re: ").concat(a.subject,"\n\nCevabınız sisteme kaydedildi. Maili manuel olarak tolgademir@okandemir.org adresinden g\xf6nderebilirsiniz."));else throw Error(r.error||"Cevap kaydedilemedi")}else throw Error("Database g\xfcncelleme hatası")}catch(e){console.error("Error saving reply:",e),alert("❌ Cevap kaydedilirken hata oluştu!\n\n".concat(e.message||"Bilinmeyen hata"))}finally{g(!1)}}},j=async e=>{if(window.confirm("Bu mesajı silmek istediğinizden emin misiniz?"))try{let r=p();(await fetch("/api/messages/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}})).ok?(await u(),i(null),alert("Mesaj başarıyla silindi!")):alert("Mesaj silinemedi!")}catch(e){console.error("Error deleting message:",e),alert("Mesaj silinirken hata oluştu!")}},f=e=>{switch(e){case"unread":return"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400";case"read":default:return"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400";case"replied":return"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400"}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Mesaj Y\xf6netimi"}),(0,t.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:"İletişim mesajlarını y\xf6netin"})]}),(0,t.jsx)("div",{className:"flex items-center space-x-3",children:y>0&&(0,t.jsxs)("span",{className:"bg-red-500 text-white px-3 py-1 rounded-full text-sm font-medium",children:[y," okunmamış mesaj"]})})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,t.jsx)("nav",{className:"flex px-6",children:(0,t.jsxs)("div",{className:"py-4 px-2 border-b-2 border-orange-500 font-medium text-sm text-orange-600",children:[(0,t.jsx)("i",{className:"ri-mail-line mr-2"}),"İletişim Mesajları (",e.length,")"]})})}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-600",children:(0,t.jsx)("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1",children:[{key:"all",label:"T\xfcm\xfc"},{key:"unread",label:"Okunmamış"},{key:"read",label:"Okundu"},{key:"replied",label:"Yanıtlanan"}].map(e=>(0,t.jsx)("button",{onClick:()=>n(e.key),className:"flex-1 px-3 py-2 rounded-md text-sm font-medium transition-colors cursor-pointer whitespace-nowrap ".concat(l===e.key?"bg-white dark:bg-gray-900 text-orange-600 shadow-sm":"text-gray-700 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300"),children:e.label},e.key))})}),(0,t.jsx)("div",{className:"max-h-96 overflow-y-auto",children:o?(0,t.jsxs)("div",{className:"p-8 text-center",children:[(0,t.jsx)("div",{className:"animate-spin w-6 h-6 border-2 border-orange-500 border-t-transparent rounded-full mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Y\xfckleniyor..."})]}):0===h.length?(0,t.jsxs)("div",{className:"p-8 text-center text-gray-500",children:[(0,t.jsx)("i",{className:"ri-mail-line text-3xl mb-2"}),(0,t.jsx)("p",{children:"Mesaj bulunamadı"})]}):h.map(e=>(0,t.jsxs)("div",{className:"group relative border-b border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors ".concat((null==a?void 0:a.id)===e.id?"bg-orange-50 border-l-4 border-l-orange-500":""),children:[(0,t.jsxs)("button",{onClick:()=>b(e),className:"w-full p-4 text-left cursor-pointer",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"font-medium text-gray-900 dark:text-white text-sm",children:e.name}),"high"===e.priority&&(0,t.jsx)("i",{className:"ri-flag-line text-xs text-red-500"})]}),(0,t.jsx)("div",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(f(e.status)),children:"unread"===e.status?"Okunmamış":"replied"===e.status?"Yanıtlandı":"Okundu"})]}),(0,t.jsx)("p",{className:"text-sm font-medium text-gray-800 dark:text-gray-100 mb-1",children:e.subject}),(0,t.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-300 line-clamp-2",children:e.message}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:new Date(e.created_at).toLocaleDateString("tr-TR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]}),(0,t.jsx)("button",{onClick:r=>{r.stopPropagation(),j(e.id)},className:"absolute top-2 right-2 w-7 h-7 flex items-center justify-center text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md opacity-0 group-hover:opacity-100 transition-all duration-200 cursor-pointer",title:"Mesajı Sil",children:(0,t.jsx)("i",{className:"ri-delete-bin-line text-sm"})})]},e.id))})]})}),(0,t.jsx)("div",{className:"lg:col-span-2",children:a?(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:a.subject}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-700 dark:text-gray-300",children:[(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"Kimden:"})," ",a.name]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"E-posta:"})," ",a.email]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"Tarih:"})," ",new Date(a.created_at).toLocaleString("tr-TR")]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(f(a.status)),children:"unread"===a.status?"Okunmamış":"replied"===a.status?"Yanıtlandı":"Okundu"}),(0,t.jsx)("button",{onClick:()=>j(a.id),className:"w-8 h-8 flex items-center justify-center text-gray-400 dark:text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors cursor-pointer",children:(0,t.jsx)("i",{className:"ri-delete-line"})})]})]})}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6",children:(0,t.jsx)("p",{className:"text-gray-900 dark:text-gray-100 whitespace-pre-wrap",children:a.message})}),a.reply_message&&(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("h4",{className:"font-semibold text-green-800 dark:text-green-300 flex items-center",children:[(0,t.jsx)("i",{className:"ri-reply-line mr-2"}),"G\xf6nderilen Cevap"]}),a.replied_at&&(0,t.jsx)("span",{className:"text-xs text-green-600 dark:text-green-400",children:new Date(a.replied_at).toLocaleString("tr-TR")})]}),(0,t.jsx)("p",{className:"text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:a.reply_message})]})}),(0,t.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[(0,t.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Yanıt G\xf6nder"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("textarea",{value:c,onChange:e=>m(e.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm resize-none",placeholder:"Yanıtınızı yazın..."}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Yanıt ",(0,t.jsx)("strong",{children:a.email})," adresine email ile g\xf6nderilecek"]}),(0,t.jsx)("button",{onClick:k,disabled:!c.trim()||x,className:"bg-gradient-to-r from-orange-500 to-yellow-500 text-white px-6 py-2 rounded-lg font-semibold hover:from-orange-600 hover:to-yellow-600 transition-all duration-200 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap flex items-center",children:x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"G\xf6nderiliyor..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("i",{className:"ri-send-plane-line mr-2"}),"Yanıtla"]})})]})]})]})]})]}):(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 flex items-center justify-center h-96",children:(0,t.jsxs)("div",{className:"text-center text-gray-500",children:[(0,t.jsx)("i",{className:"ri-mail-line text-6xl mb-4 text-gray-300"}),(0,t.jsx)("p",{className:"text-lg",children:"Mesaj Se\xe7in"}),(0,t.jsx)("p",{className:"text-sm",children:"G\xf6r\xfcnt\xfclemek i\xe7in soldaki listeden bir mesaj se\xe7in"})]})})})]})})]})]})}function j(){let[e,r]=(0,s.useState)([]),[a,i]=(0,s.useState)([]),[l,n]=(0,s.useState)(!0),[o,d]=(0,s.useState)(null),[c,m]=(0,s.useState)([]),[x,g]=(0,s.useState)(!1),[u,h]=(0,s.useState)(""),[y,b]=(0,s.useState)({status:"all",priority:"all",type:"all",bookId:"",search:""}),p=()=>sessionStorage.getItem("admin_token")||"";(0,s.useEffect)(()=>{j(),k(),N()},[y]);let k=async()=>{try{let e=p(),r=await fetch("/api/books?limit=100",{headers:{Authorization:"Bearer ".concat(e)}});if(r.ok){let a=await r.json();if(a.success){let r=await Promise.all(a.data.map(async r=>{try{let a=await fetch("/api/chapters?bookId=".concat(r.id),{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){let e=await a.json();return{...r,chapters:e.success?e.data:[]}}}catch(e){console.error("Chapter load error:",e)}return{...r,chapters:[]}}));i(r)}}}catch(e){console.error("Books loading error:",e)}},j=async()=>{try{n(!0);let e=p(),a="/api/comments?limit=100";"all"!==y.status&&(a+="&status=".concat(y.status)),y.bookId&&(a+="&bookId=".concat(y.bookId));let t=await fetch(a,{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();if(e.success){let a=e.data;if("all"!==y.status&&(a=a.filter(e=>e.status===y.status)),"all"!==y.priority&&(a=a.filter(e=>e.priority===y.priority)),"all"!==y.type&&("book"===y.type?a=a.filter(e=>!e.chapter_id&&!e.line_number):"chapter"===y.type?a=a.filter(e=>e.chapter_id&&!e.line_number):"line"===y.type&&(a=a.filter(e=>null!==e.line_number))),y.search){let e=y.search.toLowerCase();a=a.filter(r=>r.content.toLowerCase().includes(e)||r.user_name.toLowerCase().includes(e)||r.user_email.toLowerCase().includes(e))}r(a)}}}catch(e){console.error("Comments loading error:",e)}finally{n(!1)}},f=async(e,r,a)=>{try{let t=p();(await fetch("/api/comments/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({status:r,priority:a})})).ok?(o&&d({...o,status:r,priority:a||o.priority}),await j(),alert("Yorum g\xfcncellendi")):alert("Yorum durumu g\xfcncellenemedi!")}catch(e){console.error("Comment update error:",e),alert("Yorum durumu g\xfcncellenirken hata oluştu!")}},v=async e=>{if(window.confirm("Bu yorumu silmek istediğinizden emin misiniz?"))try{let r=p(),a=await fetch("/api/comments/".concat(e),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});if(a.ok)await j(),d(null),alert("Yorum başarıyla silindi!");else{let e=await a.json();alert(e.error||"Yorum silinemedi!")}}catch(e){console.error("Comment delete error:",e),alert("Yorum silinirken hata oluştu!")}},N=async()=>{try{let e=p(),r=await fetch("/api/admin/ban-ip",{headers:{Authorization:"Bearer ".concat(e)}});if(r.ok){let e=await r.json();e.success&&e.data&&m(e.data)}}catch(e){console.error("Load banned IPs error:",e)}},w=async e=>{let r=prompt("IP ban nedeni (opsiyonel):");if(null!==r)try{let a=p(),t=await fetch("/api/admin/ban-ip",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({ipAddress:e,reason:r||"Spam/K\xf6t\xfcye kullanım"})});if(t.ok)alert("IP ".concat(e," başarıyla yasaklandı!")),d(null),N();else{let e=await t.json();alert(e.error||"IP yasaklanamadı!")}}catch(e){console.error("IP ban error:",e),alert("IP yasaklanırken hata oluştu!")}},S=async(e,r)=>{if(confirm("".concat(r," IP yasağını kaldırmak istediğinizden emin misiniz?")))try{let e=p(),a=await fetch("/api/admin/ban-ip?ip=".concat(r),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}});if(a.ok)alert("IP ".concat(r," yasağı kaldırıldı!")),N();else{let e=await a.json();alert(e.error||"IP yasağı kaldırılamadı!")}}catch(e){console.error("Unban IP error:",e),alert("IP yasağı kaldırılırken hata oluştu!")}},_=async(e,r)=>{try{let a=p();(await fetch("/api/comments/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({is_hidden:!r})})).ok?(alert("Yorum ".concat(r?"g\xf6r\xfcn\xfcr yapıldı":"gizlendi","!")),j(),d(null)):alert("İşlem başarısız!")}catch(e){console.error("Toggle hide comment error:",e),alert("Yorum gizlenirken hata oluştu!")}},C=async()=>{if(!o||!u.trim())return void alert("L\xfctfen bir yanıt yazın!");try{let e=p();(await fetch("/api/comments/".concat(o.id),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({admin_reply:u})})).ok?(alert("Yanıt başarıyla g\xf6nderildi!"),h(""),j()):alert("Yanıt g\xf6nderilemedi!")}catch(e){console.error("Admin reply error:",e),alert("Yanıt g\xf6nderilirken hata oluştu!")}},z=e=>null!==e.line_number&&void 0!==e.line_number?"\uD83D\uDCDD Satır Yorumu":e.chapter_id?"\uD83D\uDCD6 B\xf6l\xfcm Yorumu":"\uD83D\uDCDA Kitap Yorumu";return(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"İ\xe7erik Yorumları"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Kitap, b\xf6l\xfcm ve satır yorumlarını y\xf6netin"})]}),(0,t.jsxs)("button",{onClick:()=>g(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center space-x-2",title:"Yasaklı IP adreslerini g\xf6r\xfcnt\xfcle ve y\xf6net",children:[(0,t.jsx)("i",{className:"ri-shield-cross-line"}),(0,t.jsxs)("span",{children:["Yasaklı IP'ler (",c.length,")"]})]})]}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Durum"}),(0,t.jsxs)("select",{value:y.status,onChange:e=>b({...y,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,t.jsx)("option",{value:"all",children:"T\xfcm\xfc"}),(0,t.jsx)("option",{value:"approved",children:"Onaylandı"}),(0,t.jsx)("option",{value:"pending",children:"Beklemede"}),(0,t.jsx)("option",{value:"rejected",children:"Reddedildi"}),(0,t.jsx)("option",{value:"spam",children:"Spam"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"\xd6ncelik"}),(0,t.jsxs)("select",{value:y.priority,onChange:e=>b({...y,priority:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,t.jsx)("option",{value:"all",children:"T\xfcm\xfc"}),(0,t.jsx)("option",{value:"low",children:"D\xfcş\xfck"}),(0,t.jsx)("option",{value:"normal",children:"Normal"}),(0,t.jsx)("option",{value:"high",children:"Y\xfcksek"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tip"}),(0,t.jsxs)("select",{value:y.type,onChange:e=>b({...y,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,t.jsx)("option",{value:"all",children:"T\xfcm\xfc"}),(0,t.jsx)("option",{value:"book",children:"Kitap"}),(0,t.jsx)("option",{value:"chapter",children:"B\xf6l\xfcm"}),(0,t.jsx)("option",{value:"line",children:"Satır"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Kitap"}),(0,t.jsxs)("select",{value:y.bookId,onChange:e=>b({...y,bookId:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,t.jsx)("option",{value:"",children:"T\xfcm Kitaplar"}),a.map(e=>(0,t.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Arama"}),(0,t.jsx)("input",{type:"text",placeholder:"Yorum i\xe7eriği, kullanıcı adı veya email...",value:y.search,onChange:e=>b({...y,search:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsx)("div",{className:"lg:col-span-2",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Yorumlar (",e.length,")"]})}),(0,t.jsx)("div",{className:"max-h-96 overflow-y-auto",children:l?(0,t.jsx)("div",{className:"p-4 text-center text-gray-500",children:"Y\xfckleniyor..."}):0===e.length?(0,t.jsx)("div",{className:"p-4 text-center text-gray-500",children:"Yorum bulunamadı"}):(0,t.jsx)("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:e.map(e=>{var r,a;return(0,t.jsxs)("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors ".concat((null==o?void 0:o.id)===e.id?"bg-orange-50 dark:bg-orange-900/20":""),onClick:()=>d(e),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"text-sm text-orange-600 dark:text-orange-400 font-medium",children:z(e)}),null!==e.line_number&&void 0!==e.line_number&&(0,t.jsxs)("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 px-2 py-1 rounded",children:["Satır ",e.line_number+1]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[e.is_hidden&&(0,t.jsxs)("span",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-xs font-medium",children:[(0,t.jsx)("i",{className:"ri-eye-off-line mr-1"}),"Gizli"]}),(r=e.status,(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat({approved:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300",pending:"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-300",rejected:"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-300",spam:"bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-300"}[r]),children:{approved:"Onaylandı",pending:"Beklemede",rejected:"Reddedildi",spam:"Spam"}[r]})),(a=e.priority,(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat({low:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300",normal:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300",high:"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-300"}[a]),children:{low:"D\xfcş\xfck",normal:"Normal",high:"Y\xfcksek"}[a]}))]})]}),(0,t.jsxs)("div",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:[e.user_name," - ",e.user_email]}),e.user_ip&&(0,t.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)("i",{className:"ri-global-line"}),(0,t.jsxs)("span",{children:["IP: ",e.user_ip]})]}),e.user_fingerprint&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 mt-0.5",children:[(0,t.jsx)("i",{className:"ri-fingerprint-line"}),(0,t.jsxs)("span",{className:"text-xs",children:["FP: ",e.user_fingerprint.substring(0,10)]})]})]}),(0,t.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2 line-clamp-2",children:e.content}),(0,t.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:new Date(e.created_at).toLocaleString("tr-TR")})]},e.id)})})})]})}),(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Yorum Detayı"})}),(0,t.jsx)("div",{className:"p-4",children:o?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tip"}),(0,t.jsx)("div",{className:"text-sm text-orange-600 dark:text-orange-400",children:z(o)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Kullanıcı"}),(0,t.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:o.user_name}),(0,t.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:o.user_email}),o.user_ip&&(0,t.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 flex items-center space-x-2",children:[(0,t.jsx)("i",{className:"ri-global-line"}),(0,t.jsxs)("span",{children:["IP: ",o.user_ip]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"İ\xe7erik"}),(0,t.jsx)("div",{className:"text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded",children:o.content})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tarih"}),(0,t.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:new Date(o.created_at).toLocaleString("tr-TR")})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Durum"}),(0,t.jsxs)("select",{value:o.status,onChange:e=>f(o.id,e.target.value,o.priority),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,t.jsx)("option",{value:"approved",children:"Onayla"}),(0,t.jsx)("option",{value:"pending",children:"Beklemede"}),(0,t.jsx)("option",{value:"rejected",children:"Reddet"}),(0,t.jsx)("option",{value:"spam",children:"Spam"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"\xd6ncelik"}),(0,t.jsxs)("select",{value:o.priority,onChange:e=>f(o.id,o.status,e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,t.jsx)("option",{value:"low",children:"D\xfcş\xfck"}),(0,t.jsx)("option",{value:"normal",children:"Normal"}),(0,t.jsx)("option",{value:"high",children:"Y\xfcksek"})]})]})]}),(0,t.jsxs)("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Admin Yanıtı"}),o.admin_reply?(0,t.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded mb-3",children:[(0,t.jsx)("div",{className:"text-sm text-gray-900 dark:text-white mb-1",children:o.admin_reply}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Yanıtlayan: ",o.admin_reply_by||"Admin"," - ",o.admin_reply_at?new Date(o.admin_reply_at).toLocaleString("tr-TR"):""]})]}):null,(0,t.jsx)("textarea",{value:u,onChange:e=>h(e.target.value),placeholder:"Yoruma yanıt yazın...",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm mb-2"}),(0,t.jsxs)("button",{onClick:C,disabled:!u.trim(),className:"w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)("i",{className:"ri-reply-line mr-2"}),"Yanıt G\xf6nder"]})]}),(0,t.jsxs)("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700 space-y-3",children:[(0,t.jsxs)("button",{onClick:()=>(e=>{let r="";if(e.book_id&&!e.chapter_id?r="/kitaplar/".concat(e.book_id,"#comments"):e.chapter_id&&!e.line_number?r="/kitaplar/".concat(e.book_id,"/bolum/").concat(e.chapter_id,"#comments"):e.chapter_id&&null!==e.line_number&&(r="/kitaplar/".concat(e.book_id,"/bolum/").concat(e.chapter_id,"?line=").concat(e.line_number,"&commentId=").concat(e.id)),r){let a=window.open(r,"_blank");a&&a.addEventListener("load",()=>{try{a.postMessage({type:"OPEN_COMMENT",commentId:e.id,lineNumber:e.line_number},window.location.origin)}catch(e){console.error("PostMessage error:",e)}})}})(o),className:"w-full px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors font-medium",children:[(0,t.jsx)("i",{className:"ri-external-link-line mr-2"}),"Yoruma Git"]}),(0,t.jsxs)("button",{onClick:()=>_(o.id,o.is_hidden||!1),className:"w-full px-4 py-2 text-white rounded hover:opacity-90 transition-colors font-medium ".concat(o.is_hidden?"bg-green-600 hover:bg-green-700":"bg-orange-600 hover:bg-orange-700"),children:[(0,t.jsx)("i",{className:"ri-".concat(o.is_hidden?"eye":"eye-off","-line mr-2")}),o.is_hidden?"Yorumu G\xf6ster":"Yorumu Gizle"]}),(0,t.jsxs)("button",{onClick:()=>v(o.id),className:"w-full px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors font-medium",children:[(0,t.jsx)("i",{className:"ri-delete-bin-line mr-2"}),"Yorumu Sil"]}),o.user_ip&&(0,t.jsxs)("button",{onClick:()=>w(o.user_ip),className:"w-full px-4 py-2 bg-gray-800 dark:bg-gray-700 text-white rounded hover:bg-gray-900 dark:hover:bg-gray-600 transition-colors font-medium",children:[(0,t.jsx)("i",{className:"ri-forbid-line mr-2"}),"IP Ban (",o.user_ip,")"]})]})]}):(0,t.jsx)("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"Bir yorum se\xe7in"})})]})})]}),x&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:[(0,t.jsx)("i",{className:"ri-shield-cross-line mr-2"}),"Yasaklı IP Adresleri"]}),(0,t.jsx)("button",{onClick:()=>g(!1),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200",children:(0,t.jsx)("i",{className:"ri-close-line text-2xl"})})]}),(0,t.jsx)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:0===c.length?(0,t.jsxs)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[(0,t.jsx)("i",{className:"ri-shield-check-line text-6xl mb-4"}),(0,t.jsx)("p",{className:"text-lg",children:"Yasaklı IP adresi bulunmuyor"})]}):(0,t.jsx)("div",{className:"space-y-4",children:c.map(e=>(0,t.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,t.jsx)("span",{className:"text-lg font-mono font-semibold text-red-600 dark:text-red-400",children:e.ip_address}),e.auto_banned&&(0,t.jsx)("span",{className:"px-2 py-1 bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-300 text-xs rounded-full",children:"Otomatik"}),e.suspicion_score>0&&(0,t.jsxs)("span",{className:"px-2 py-1 bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-300 text-xs rounded-full",children:["Risk: ",e.suspicion_score]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.subnet&&(0,t.jsxs)("div",{className:"text-gray-600 dark:text-gray-400",children:[(0,t.jsx)("i",{className:"ri-router-line mr-1"}),(0,t.jsx)("span",{className:"font-medium",children:"Subnet:"})," ",e.subnet]}),e.fingerprint&&(0,t.jsxs)("div",{className:"text-gray-600 dark:text-gray-400",children:[(0,t.jsx)("i",{className:"ri-fingerprint-line mr-1"}),(0,t.jsx)("span",{className:"font-medium",children:"Fingerprint:"})," ",e.fingerprint.substring(0,20),"..."]}),e.reason&&(0,t.jsxs)("div",{className:"text-gray-600 dark:text-gray-400 col-span-2",children:[(0,t.jsx)("i",{className:"ri-information-line mr-1"}),(0,t.jsx)("span",{className:"font-medium",children:"Sebep:"})," ",e.reason]}),(0,t.jsxs)("div",{className:"text-gray-600 dark:text-gray-400",children:[(0,t.jsx)("i",{className:"ri-user-line mr-1"}),(0,t.jsx)("span",{className:"font-medium",children:"Yasaklayan:"})," ",e.banned_by||"Sistem"]}),(0,t.jsxs)("div",{className:"text-gray-600 dark:text-gray-400",children:[(0,t.jsx)("i",{className:"ri-time-line mr-1"}),(0,t.jsx)("span",{className:"font-medium",children:"Tarih:"})," ",new Date(e.created_at).toLocaleString("tr-TR")]})]})]}),(0,t.jsxs)("button",{onClick:()=>S(e.id,e.ip_address),className:"ml-4 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2",children:[(0,t.jsx)("i",{className:"ri-shield-check-line"}),(0,t.jsx)("span",{children:"Yasağı Kaldır"})]})]})},e.id))})}),(0,t.jsx)("div",{className:"flex justify-end p-6 border-t border-gray-200 dark:border-gray-700",children:(0,t.jsx)("button",{onClick:()=>g(!1),className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Kapat"})})]})})]})}function f(){let[e,r]=(0,s.useState)([]),[a,i]=(0,s.useState)({twoFactorAuth:!1,ipWhitelist:[],ipBlacklist:[],maxLoginAttempts:5,sessionTimeout:30,autoLogout:!0,notifyOnLogin:!0,ipAccessControl:!1}),[l,n]=(0,s.useState)([]),[o,d]=(0,s.useState)("logs"),[c,m]=(0,s.useState)(""),[x,g]=(0,s.useState)(!1),[u,h]=(0,s.useState)("whitelist"),[y,b]=(0,s.useState)(!1),[p,k]=(0,s.useState)({username:"",email:"",password:"",role:"Admin"}),[j,f]=(0,s.useState)(""),[v,N]=(0,s.useState)(!1),[w,S]=(0,s.useState)(""),[_,C]=(0,s.useState)(""),[z,T]=(0,s.useState)(!1),[A,B]=(0,s.useState)(!0),[D,E]=(0,s.useState)(!1),[I,P]=(0,s.useState)(null),[M,O]=(0,s.useState)("");(0,s.useEffect)(()=>{Y()},[]);let Y=async()=>{try{B(!0);let a=sessionStorage.getItem("admin_token"),t=await fetch("/api/admin/security/logs?limit=100",{headers:{Authorization:"Bearer ".concat(a)}});if(t.ok){let e=await t.json();e.success&&r(e.data.map(e=>({id:e.id,type:e.type,message:e.message,ip:e.ip||"N/A",userAgent:e.user_agent||"N/A",timestamp:e.created_at,severity:e.severity})))}let s=await fetch("/api/admin/security/settings",{headers:{Authorization:"Bearer ".concat(a)}});if(s.ok){let e=await s.json();e.success&&(i(e.data),T(e.data.twoFactorAuth||!1))}let l=await fetch("/api/admin/me",{headers:{Authorization:"Bearer ".concat(a)}});if(l.ok){var e;let r=await l.json();r.success&&(null==(e=r.user)?void 0:e.two_factor_secret)&&T(!0)}let o=await fetch("/api/admin/security/users",{headers:{Authorization:"Bearer ".concat(a)}});if(o.ok){let e=await o.json();e.success&&n(e.data)}B(!1)}catch(e){console.error("G\xfcvenlik verileri y\xfckleme hatası:",e),B(!1)}},L={low:"bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-300",medium:"bg-yellow-100 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-300",high:"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300"},G={login:"ri-login-circle-line",failed_login:"ri-error-warning-line",suspicious_activity:"ri-alarm-warning-line",system_access:"ri-shield-check-line",ip_blocked:"ri-forbid-line"},K=async(e,r)=>{i(a=>({...a,[e]:r}));try{let t=sessionStorage.getItem("admin_token");await fetch("/api/admin/security/settings",{method:"PUT",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({...a,[e]:r})})}catch(e){console.error("Ayar kaydetme hatası:",e)}},R=(e,a)=>{let t="whitelist"===a?"ipWhitelist":"ipBlacklist";i(r=>({...r,[t]:r[t].filter(r=>r!==e)}));let s={id:Date.now(),type:"system_access",message:"IP ".concat(e," ").concat("whitelist"===a?"beyaz":"kara"," listeden kaldırıldı"),ip:e,userAgent:navigator.userAgent,timestamp:new Date().toISOString(),severity:"low"};r(e=>[s,...e])},F=async()=>{if(confirm("T\xfcm eski g\xfcvenlik loglarını temizlemek istediğinizden emin misiniz?"))try{let e=sessionStorage.getItem("admin_token");(await fetch("/api/admin/security/logs?all=true",{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}})).ok?(await Y(),alert("Eski g\xfcvenlik logları temizlendi")):alert("Loglar temizlenirken hata oluştu")}catch(e){console.error("Log temizleme hatası:",e),alert("Loglar temizlenirken hata oluştu")}},V=async()=>{if(!p.username||!p.email||!p.password)return void alert("T\xfcm alanlar doldurulmalıdır!");try{let e=sessionStorage.getItem("admin_token"),r=await fetch("/api/admin/security/users",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(p)}),a=await r.json();r.ok&&a.success?(k({username:"",email:"",password:"",role:"Admin"}),b(!1),await Y(),alert("Kullanıcı başarıyla oluşturuldu")):alert(a.error||"Kullanıcı oluşturulamadı")}catch(e){console.error("Kullanıcı oluşturma hatası:",e),alert("Kullanıcı oluşturulamadı")}},U=async e=>{try{let r=l.find(r=>r.id===e);if(!r)return;let a=sessionStorage.getItem("admin_token");(await fetch("/api/admin/security/users",{method:"PUT",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({id:e,username:r.username,email:r.email,role:r.role,is_active:!r.is_active})})).ok?await Y():alert("Kullanıcı durumu g\xfcncellenemedi")}catch(e){console.error("Kullanıcı durumu g\xfcncelleme hatası:",e),alert("Kullanıcı durumu g\xfcncellenemedi")}},H=async e=>{if(confirm("Bu kullanıcıyı silmek istediğinizden emin misiniz?"))try{let r=sessionStorage.getItem("admin_token"),a=await fetch("/api/admin/security/users?id=".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r)}}),t=await a.json();a.ok&&t.success?(await Y(),alert("Kullanıcı silindi")):alert(t.error||"Kullanıcı silinemedi")}catch(e){console.error("Kullanıcı silme hatası:",e),alert("Kullanıcı silinemedi")}},J=async()=>{if(!I||!M.trim())return void alert("L\xfctfen yeni şifre girin");if(M.length<6)return void alert("Şifre en az 6 karakter olmalı");try{let e=sessionStorage.getItem("admin_token"),r=await fetch("/api/admin/security/users/change-password",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({userId:I.id,newPassword:M})}),a=await r.json();r.ok&&a.success?(alert("✅ Şifre başarıyla değiştirildi!"),E(!1),P(null),O("")):alert("❌ "+(a.error||"Şifre değiştirilemedi"))}catch(e){console.error("Şifre değiştirme hatası:",e),alert("❌ Şifre değiştirilemedi")}},Z=async()=>{try{let e=sessionStorage.getItem("admin_token"),r=await fetch("/api/admin/2fa/generate",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),a=await r.json();a.success?(S(a.secret),C(a.qrCode),N(!0)):alert("QR kod oluşturulamadı: "+(a.error||"Bilinmeyen hata"))}catch(e){console.error("QR kod oluşturma hatası:",e),alert("QR kod oluşturulurken bir hata oluştu.")}},W=async()=>{if(!j||6!==j.length)return void alert("L\xfctfen 6 haneli doğrulama kodunu girin!");try{let e=sessionStorage.getItem("admin_token"),r=await fetch("/api/admin/2fa/verify",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({secret:w,code:j})}),a=await r.json();a.success?(T(!0),i(e=>({...e,twoFactorAuth:!0})),N(!1),f(""),S(""),C(""),alert("✅ 2FA başarıyla kuruldu ve aktif edildi! Artık giriş yaparken telefonunuzdaki kodu kullanacaksınız.")):alert(a.error||"Doğrulama kodu ge\xe7ersiz! L\xfctfen tekrar deneyin.")}catch(e){console.error("2FA kurulum hatası:",e),alert("2FA kurulumu sırasında bir hata oluştu.")}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"G\xfcvenlik Merkezi"}),(0,t.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:"Sistem g\xfcvenliği, IP kontrol\xfc ve kullanıcı y\xf6netimi"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-2 bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-300 rounded-lg",children:[(0,t.jsx)("i",{className:"ri-shield-check-line"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Sistem G\xfcvenli"})]}),a.twoFactorAuth&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-2 bg-blue-100 dark:bg-blue-900/20 text-blue-800 dark:text-blue-300 rounded-lg",children:[(0,t.jsx)("i",{className:"ri-key-2-line"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"2FA Aktif"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Başarılı Girişler"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:"147"}),(0,t.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-300 mt-1",children:"Son 30 g\xfcn"})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/20 rounded-lg flex items-center justify-center",children:(0,t.jsx)("i",{className:"ri-login-circle-line text-xl text-green-600"})})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Başarısız Denemeler"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:"12"}),(0,t.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-300 mt-1",children:"Son 7 g\xfcn"})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-orange-100 dark:bg-orange-900/20 rounded-lg flex items-center justify-center",children:(0,t.jsx)("i",{className:"ri-error-warning-line text-xl text-orange-600"})})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Engellenen IP"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-red-600",children:a.ipBlacklist.length}),(0,t.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-300 mt-1",children:"Kara liste"})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900/20 rounded-lg flex items-center justify-center",children:(0,t.jsx)("i",{className:"ri-forbid-line text-xl text-red-600"})})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Aktif Kullanıcı"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:l.filter(e=>e.is_active).length}),(0,t.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-300 mt-1",children:"Admin hesabı"})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/20 rounded-lg flex items-center justify-center",children:(0,t.jsx)("i",{className:"ri-user-line text-xl text-blue-600"})})]})})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex space-x-8 px-6",children:[(0,t.jsxs)("button",{onClick:()=>d("logs"),className:"py-4 px-2 border-b-2 font-medium text-sm whitespace-nowrap cursor-pointer ".concat("logs"===o?"border-orange-500 text-orange-600 dark:text-orange-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:[(0,t.jsx)("i",{className:"ri-file-list-line mr-2"}),"G\xfcvenlik Logları"]}),(0,t.jsxs)("button",{onClick:()=>d("ip-control"),className:"py-4 px-2 border-b-2 font-medium text-sm whitespace-nowrap cursor-pointer ".concat("ip-control"===o?"border-orange-500 text-orange-600 dark:text-orange-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:[(0,t.jsx)("i",{className:"ri-global-line mr-2"}),"IP Ban Sistemi"]}),(0,t.jsxs)("button",{onClick:()=>d("users"),className:"py-4 px-2 border-b-2 font-medium text-sm whitespace-nowrap cursor-pointer ".concat("users"===o?"border-orange-500 text-orange-600 dark:text-orange-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:[(0,t.jsx)("i",{className:"ri-team-line mr-2"}),"Kullanıcı Y\xf6netimi"]}),(0,t.jsxs)("button",{onClick:()=>d("settings"),className:"py-4 px-2 border-b-2 font-medium text-sm whitespace-nowrap cursor-pointer ".concat("settings"===o?"border-orange-500 text-orange-600 dark:text-orange-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:[(0,t.jsx)("i",{className:"ri-settings-line mr-2"}),"G\xfcvenlik Ayarları"]}),(0,t.jsxs)("button",{onClick:()=>d("monitoring"),className:"py-4 px-2 border-b-2 font-medium text-sm whitespace-nowrap cursor-pointer ".concat("monitoring"===o?"border-orange-500 text-orange-600 dark:text-orange-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:[(0,t.jsx)("i",{className:"ri-eye-line mr-2"}),"Canlı İzleme"]})]})}),(0,t.jsxs)("div",{className:"p-6",children:["logs"===o&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"G\xfcvenlik Logları"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("button",{onClick:()=>{let r=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(r),t=document.createElement("a");t.href=a,t.download="security-logs-".concat(new Date().toISOString().split("T")[0],".json"),t.click(),URL.revokeObjectURL(a)},className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors cursor-pointer text-sm whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-download-line mr-2"}),"Dışarı Aktar"]}),(0,t.jsxs)("button",{onClick:F,className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors cursor-pointer text-sm whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-delete-bin-line mr-2"}),"Temizle"]})]})]}),(0,t.jsx)("div",{className:"space-y-3",children:e.map(e=>(0,t.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center ".concat("high"===e.severity?"bg-red-100 dark:bg-red-900/20 text-red-600 dark:text-red-400":"medium"===e.severity?"bg-yellow-100 dark:bg-yellow-900/20 text-yellow-600 dark:text-yellow-400":"bg-green-100 dark:bg-green-900/20 text-green-600 dark:text-green-400"),children:(0,t.jsx)("i",{className:G[e.type]})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,t.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.message}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(L[e.severity]),children:"high"===e.severity?"Y\xfcksek":"medium"===e.severity?"Orta":"D\xfcş\xfck"})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-300 space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("span",{children:[(0,t.jsx)("i",{className:"ri-global-line mr-1"}),"IP: ",e.ip]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("i",{className:"ri-computer-line mr-1"}),e.userAgent]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("i",{className:"ri-time-line mr-1"}),new Date(e.timestamp).toLocaleString("tr-TR")]})]})]})]}),"high"===e.severity&&"suspicious_activity"===e.type&&(0,t.jsxs)("button",{onClick:()=>(e=>{i(r=>({...r,ipBlacklist:[...r.ipBlacklist,e]}));let a={id:Date.now(),type:"ip_blocked",message:"Ş\xfcpheli IP otomatik olarak engellendi: ".concat(e),ip:e,userAgent:"System",timestamp:new Date().toISOString(),severity:"high"};r(e=>[a,...e])})(e.ip),className:"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-forbid-line mr-1"}),"IP'yi Engelle"]})]})},e.id))})]}),"ip-control"===o&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"IP Ban Sistemi"}),(0,t.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"IP Erişim Kontrol\xfc"}),(0,t.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Sadece izin verilen IP'lerden admin paneline erişimi etkinleştir"})]}),(0,t.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:a.ipAccessControl,onChange:e=>K("ipAccessControl",e.target.checked),className:"sr-only peer"}),(0,t.jsx)("div",{className:"w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-orange-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-orange-600"})]})]})}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Beyaz Liste (İzin Verilenler)"}),(0,t.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Bu IP'lerden erişim her zaman izinli"})]}),(0,t.jsxs)("button",{onClick:()=>{h("whitelist"),g(!0)},className:"bg-green-500 text-white px-3 py-2 rounded-lg hover:bg-green-600 transition-colors cursor-pointer text-sm whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-add-line mr-1"}),"IP Ekle"]})]}),(0,t.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:a.ipWhitelist.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center justify-between bg-white dark:bg-gray-800 p-3 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("i",{className:"ri-shield-check-line text-green-500"}),(0,t.jsx)("span",{className:"font-mono text-sm text-gray-900 dark:text-gray-200",children:e})]}),(0,t.jsx)("button",{onClick:()=>R(e,"whitelist"),className:"text-red-500 hover:text-red-700 cursor-pointer",children:(0,t.jsx)("i",{className:"ri-close-line"})})]},r))})]}),(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Kara Liste (Engellenenler)"}),(0,t.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Bu IP'lerden erişim tamamen engelli"})]}),(0,t.jsxs)("button",{onClick:()=>{h("blacklist"),g(!0)},className:"bg-red-500 text-white px-3 py-2 rounded-lg hover:bg-red-600 transition-colors cursor-pointer text-sm whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-forbid-line mr-1"}),"IP Engelle"]})]}),(0,t.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:a.ipBlacklist.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center justify-between bg-white dark:bg-gray-800 p-3 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("i",{className:"ri-forbid-line text-red-500"}),(0,t.jsx)("span",{className:"font-mono text-sm text-gray-900 dark:text-gray-200",children:e})]}),(0,t.jsx)("button",{onClick:()=>R(e,"blacklist"),className:"text-green-500 hover:text-green-700 cursor-pointer",children:(0,t.jsx)("i",{className:"ri-close-line"})})]},r))})]})]}),x&&(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,t.jsxs)("h4",{className:"font-medium text-gray-900 dark:text-white mb-4",children:["whitelist"===u?"Beyaz Listeye":"Kara Listeye"," IP Ekle"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"text",value:c,onChange:e=>m(e.target.value),placeholder:"IP adresi (\xf6rn: 192.168.1.100) veya aralığı (\xf6rn: 192.168.1.0/24)",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"}),(0,t.jsx)("button",{onClick:()=>{if(c.trim()){let e="whitelist"===u?"ipWhitelist":"ipBlacklist";i(r=>({...r,[e]:[...r[e],c.trim()]})),m(""),g(!1);let a={id:Date.now(),type:"system_access",message:"IP ".concat(c," ").concat("whitelist"===u?"beyaz":"kara"," listeye eklendi"),ip:c,userAgent:navigator.userAgent,timestamp:new Date().toISOString(),severity:"low"};r(e=>[a,...e])}},className:"px-4 py-2 rounded-lg text-white cursor-pointer whitespace-nowrap ".concat("whitelist"===u?"bg-green-500 hover:bg-green-600":"bg-red-500 hover:bg-red-600"),children:"Ekle"}),(0,t.jsx)("button",{onClick:()=>{g(!1),m("")},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors cursor-pointer whitespace-nowrap",children:"İptal"})]})]})]}),"users"===o&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Kullanıcı Y\xf6netimi"}),(0,t.jsxs)("button",{onClick:()=>b(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-user-add-line mr-2"}),"Yeni Kullanıcı"]})]}),(0,t.jsx)("div",{className:"grid gap-4",children:l.map(e=>(0,t.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:(0,t.jsx)("i",{className:"ri-user-line text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:e.username}),(0,t.jsx)("span",{className:"bg-blue-100 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 px-2 py-1 rounded text-xs",children:e.role}),e.is_active?(0,t.jsx)("span",{className:"bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-300 px-2 py-1 rounded text-xs",children:"Aktif"}):(0,t.jsx)("span",{className:"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300 px-2 py-1 rounded text-xs",children:"Pasif"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:e.email}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["Son giriş: ",e.last_login?new Date(e.last_login).toLocaleDateString("tr-TR"):"Hi\xe7"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("button",{onClick:()=>U(e.id),className:"px-3 py-1 rounded text-sm cursor-pointer whitespace-nowrap ".concat(e.is_active?"bg-orange-100 dark:bg-orange-900/20 text-orange-700 dark:text-orange-300 hover:bg-orange-200 dark:hover:bg-orange-800/30":"bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-300 hover:bg-green-200 dark:hover:bg-green-800/30"),children:e.is_active?"Pasifleştir":"Aktifleştir"}),(0,t.jsxs)("button",{onClick:()=>{P(e),E(!0),O("")},className:"bg-blue-100 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 px-3 py-1 rounded text-sm hover:bg-blue-200 dark:hover:bg-blue-800/30 cursor-pointer whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-lock-password-line mr-1"}),"Şifre Değiştir"]}),"1"!==e.id&&(0,t.jsx)("button",{onClick:()=>H(e.id),className:"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300 px-3 py-1 rounded text-sm hover:bg-red-200 dark:hover:bg-red-800/30 cursor-pointer whitespace-nowrap",children:"Sil"})]})]})},e.id))}),y&&(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-4",children:"Yeni Admin Kullanıcısı"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsx)("input",{type:"text",value:p.username,onChange:e=>k({...p,username:e.target.value}),placeholder:"Kullanıcı adı",className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,t.jsx)("input",{type:"email",value:p.email,onChange:e=>k({...p,email:e.target.value}),placeholder:"E-posta",className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,t.jsx)("input",{type:"password",value:p.password,onChange:e=>k({...p,password:e.target.value}),placeholder:"Şifre",className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,t.jsxs)("select",{value:p.role,onChange:e=>k({...p,role:e.target.value}),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 pr-8",children:[(0,t.jsx)("option",{value:"Admin",children:"Admin"}),(0,t.jsx)("option",{value:"Editor",children:"Editor"}),(0,t.jsx)("option",{value:"Moderator",children:"Moderator"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 mt-4",children:[(0,t.jsx)("button",{onClick:V,className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 cursor-pointer whitespace-nowrap",children:"Kullanıcı Oluştur"}),(0,t.jsx)("button",{onClick:()=>b(!1),className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 cursor-pointer whitespace-nowrap",children:"İptal"})]})]})]}),"settings"===o&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"G\xfcvenlik Ayarları"}),(0,t.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"İki Fakt\xf6rl\xfc Doğrulama (2FA)"}),(0,t.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:z?"✅ Kurulu ve Aktif":"⚠️ Kurulmamış - Extra g\xfcvenlik katmanı ekleyin"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[z?(0,t.jsxs)("button",{onClick:async()=>{if(confirm("2FA devre dışı bırakılacak. Emin misiniz?"))try{let e=sessionStorage.getItem("admin_token");(await fetch("/api/admin/2fa/disable",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).ok?(T(!1),i(e=>({...e,twoFactorAuth:!1})),alert("✅ 2FA devre dışı bırakıldı")):alert("❌ 2FA kapatılamadı")}catch(e){alert("❌ Hata oluştu")}},className:"bg-red-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-red-600 cursor-pointer whitespace-nowrap font-medium",children:[(0,t.jsx)("i",{className:"ri-shield-cross-line mr-1"}),"2FA Kapat"]}):(0,t.jsxs)("button",{onClick:Z,className:"bg-green-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-green-600 cursor-pointer whitespace-nowrap font-medium",children:[(0,t.jsx)("i",{className:"ri-qr-code-line mr-1"}),"2FA Kur"]}),(0,t.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:z,disabled:!0,className:"sr-only peer"}),(0,t.jsx)("div",{className:"w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 opacity-75 cursor-not-allowed"})]})]})]})}),v&&(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6",children:[(0,t.jsxs)("h4",{className:"font-medium text-gray-900 dark:text-white mb-4 flex items-center",children:[(0,t.jsx)("i",{className:"ri-shield-check-line text-blue-500 mr-2"}),"2FA Kurulumu"]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-6 rounded-lg border border-blue-200 dark:border-blue-700",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"inline-block bg-white p-4 rounded-lg shadow-md mb-4",children:_?(0,t.jsx)("img",{src:_,alt:"2FA QR Code",className:"w-48 h-48"}):(0,t.jsx)("div",{className:"w-48 h-48 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})})}),(0,t.jsx)("h5",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Adım 1: QR Kodu Tarayın"}),(0,t.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-3",children:[(0,t.jsx)("strong",{children:"Google Authenticator"})," veya ",(0,t.jsx)("strong",{children:"Microsoft Authenticator"})," uygulamasını a\xe7ın ve bu QR kodu tarayın"]}),w&&(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded p-3 mt-3",children:[(0,t.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Manuel giriş i\xe7in Secret Key:"}),(0,t.jsx)("code",{className:"text-sm font-mono text-blue-600 dark:text-blue-400 break-all",children:w})]})]})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:[(0,t.jsx)("i",{className:"ri-key-2-line mr-1"}),"Adım 2: Doğrulama Kodunu Girin"]}),(0,t.jsx)("input",{type:"text",value:j,onChange:e=>f(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"6 haneli kod girin",maxLength:6,className:"w-full px-4 py-3 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border-2 border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-2xl tracking-widest font-mono"}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:[(0,t.jsx)("i",{className:"ri-information-line mr-1"}),"Authenticator uygulamanızda g\xf6rd\xfcğ\xfcn\xfcz 6 haneli kodu girin"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsxs)("button",{onClick:W,disabled:6!==j.length,className:"flex-1 px-6 py-3 rounded-lg font-semibold transition-all ".concat(6===j.length?"bg-green-500 hover:bg-green-600 text-white cursor-pointer":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"),children:[(0,t.jsx)("i",{className:"ri-shield-check-line mr-2"}),"Doğrula ve Etkinleştir"]}),(0,t.jsxs)("button",{onClick:()=>{N(!1),f(""),S(""),C("")},className:"px-6 py-3 rounded-lg font-semibold bg-gray-500 hover:bg-gray-600 text-white cursor-pointer transition-all",children:[(0,t.jsx)("i",{className:"ri-close-line mr-2"}),"İptal"]})]}),(0,t.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-700",children:[(0,t.jsxs)("h6",{className:"font-semibold text-blue-900 dark:text-blue-300 mb-2 flex items-center",children:[(0,t.jsx)("i",{className:"ri-question-line mr-2"}),"Authenticator Uygulaması Nasıl İndirilir?"]}),(0,t.jsxs)("ul",{className:"text-sm text-blue-800 dark:text-blue-300 space-y-1",children:[(0,t.jsxs)("li",{className:"flex items-start",children:[(0,t.jsx)("i",{className:"ri-smartphone-line mr-2 mt-0.5"}),(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"Android:"}),' Play Store\'dan "Google Authenticator" indirin']})]}),(0,t.jsxs)("li",{className:"flex items-start",children:[(0,t.jsx)("i",{className:"ri-apple-line mr-2 mt-0.5"}),(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"iOS:"}),' App Store\'dan "Google Authenticator" indirin']})]}),(0,t.jsxs)("li",{className:"flex items-start",children:[(0,t.jsx)("i",{className:"ri-information-line mr-2 mt-0.5"}),(0,t.jsx)("span",{children:"Alternatif: Microsoft Authenticator, Authy veya benzeri TOTP uygulamaları"})]})]})]})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 space-y-4",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Oturum Ayarları"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Maksimum Giriş Denemesi"}),(0,t.jsx)("input",{type:"number",value:a.maxLoginAttempts,onChange:e=>K("maxLoginAttempts",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",min:"3",max:"10"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Oturum Zaman Aşımı (dakika)"}),(0,t.jsx)("input",{type:"number",value:a.sessionTimeout,onChange:e=>K("sessionTimeout",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",min:"15",max:"120"})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h5",{className:"font-medium text-gray-900 dark:text-white",children:"Otomatik \xc7ıkış"}),(0,t.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Hareketsizlik durumunda otomatik \xe7ıkış"})]}),(0,t.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:a.autoLogout,onChange:e=>K("autoLogout",e.target.checked),className:"sr-only peer"}),(0,t.jsx)("div",{className:"w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h5",{className:"font-medium text-gray-900 dark:text-white",children:"Giriş Bildirimi"}),(0,t.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Her girişte e-posta bildirimi"})]}),(0,t.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:a.notifyOnLogin,onChange:e=>K("notifyOnLogin",e.target.checked),className:"sr-only peer"}),(0,t.jsx)("div",{className:"w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]})]}),"monitoring"===o&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Canlı G\xfcvenlik İzleme"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-4",children:"Aktif Oturumlar"}),(0,t.jsx)("div",{className:"space-y-3",children:(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:"Mevcut Oturum"}),(0,t.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"192.168.1.100 - Chrome"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,t.jsx)("span",{className:"text-sm text-green-600",children:"Aktif"})]})]})})})]}),(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-4",children:"Son Aktiviteler"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:[(0,t.jsx)("i",{className:"ri-time-line mr-1"}),new Date().toLocaleTimeString("tr-TR")," - Sayfa g\xf6r\xfcnt\xfclendi"]}),(0,t.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:[(0,t.jsx)("i",{className:"ri-time-line mr-1"}),new Date(Date.now()-3e5).toLocaleTimeString("tr-TR")," - Ayarlar g\xfcncellendi"]})]})]})]}),(0,t.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("i",{className:"ri-alert-line text-yellow-600 mr-3 mt-1"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-yellow-800 font-medium mb-2",children:"G\xfcvenlik \xd6nerileri"}),(0,t.jsxs)("ul",{className:"text-yellow-700 text-sm space-y-1",children:[(0,t.jsx)("li",{children:"• İki fakt\xf6rl\xfc doğrulamayı etkinleştirin"}),(0,t.jsx)("li",{children:"• IP erişim kontrol\xfcn\xfc a\xe7ın"}),(0,t.jsx)("li",{children:"• D\xfczenli olarak şifrenizi değiştirin"}),(0,t.jsx)("li",{children:"• G\xfcvenlik loglarını periyodik olarak kontrol edin"}),(0,t.jsx)("li",{children:"• Sadece g\xfcvenilir ağlardan erişim sağlayın"})]})]})]})})]})]})]}),D&&I&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:[(0,t.jsx)("i",{className:"ri-lock-password-line mr-2 text-blue-600"}),"Şifre Değiştir"]}),(0,t.jsx)("button",{onClick:()=>{E(!1),P(null),O("")},className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:(0,t.jsx)("i",{className:"ri-close-line text-2xl"})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-700",children:(0,t.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[(0,t.jsx)("i",{className:"ri-user-line mr-2"}),(0,t.jsx)("strong",{children:I.username})," (",I.email,")"]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Yeni Şifre (minimum 6 karakter)"}),(0,t.jsx)("input",{type:"password",value:M,onChange:e=>O(e.target.value),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg focus:border-blue-500 dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Yeni şifreyi girin",autoFocus:!0}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"G\xfc\xe7l\xfc bir şifre kullanın (harf, rakam, \xf6zel karakter)"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3 pt-4",children:[(0,t.jsxs)("button",{onClick:J,disabled:!M||M.length<6,className:"flex-1 px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed font-medium cursor-pointer",children:[(0,t.jsx)("i",{className:"ri-check-line mr-2"}),"Şifreyi Değiştir"]}),(0,t.jsx)("button",{onClick:()=>{E(!1),P(null),O("")},className:"px-6 py-3 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-400 dark:hover:bg-gray-500 font-medium cursor-pointer",children:"İptal"})]})]})]})})]})}function v(){let[e,r]=(0,s.useState)(!1),[a,i]=(0,s.useState)(!1),[l,n]=(0,s.useState)(""),[o,d]=(0,s.useState)("success"),[c,m]=(0,s.useState)(""),[x,g]=(0,s.useState)("checking"),[u,h]=(0,s.useState)({database:"connected",cache:"active",ssl:"valid",lastBackup:"Bug\xfcn, 03:00"}),[y,b]=(0,s.useState)(""),[p,k]=(0,s.useState)(!1),[j,f]=(0,s.useState)(1);(0,s.useEffect)(()=>{N(),w();let a=setInterval(()=>{N(),(()=>{let r=localStorage.getItem("maintenanceEndTime");if(r&&e){let e=new Date().getTime(),a=new Date(r).getTime(),t=a-e,s=localStorage.getItem("maintenanceNotified");t<=3e5&&t>0&&!s&&(v("⚠️ Bakım modu 5 dakika i\xe7inde sona erecek!","success"),localStorage.setItem("maintenanceNotified","true"),fetch("/api/admin/notifications/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"warning",title:"Bakım Modu Uyarısı",message:"Bakım modu 5 dakika i\xe7inde otomatik olarak sona erecek.",icon:"ri-alarm-warning-line"})}).catch(console.error)),e>=a&&(console.log("⏰ Zamanlı bakım s\xfcresi doldu, kapatılıyor..."),localStorage.removeItem("maintenanceNotified"),S())}})()},1e4),t=a=>{if("maintenanceMode"===a.key){let t="true"===a.newValue;t!==e&&(r(t),v(t?"Bakım modu başka bir yerden a\xe7ıldı!":"Bakım modu başka bir yerden kapatıldı!","success"))}},s=()=>{document.hidden||N()},i=()=>{N()};return window.addEventListener("storage",t),document.addEventListener("visibilitychange",s),window.addEventListener("focus",i),()=>{clearInterval(a),window.removeEventListener("storage",t),document.removeEventListener("visibilitychange",s),window.removeEventListener("focus",i)}},[e]);let v=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";n(e),d(r),setTimeout(()=>n(""),5e3)},N=async()=>{try{g("checking");let e=localStorage.getItem("maintenanceEndTime");e&&b(e);let a=new AbortController,t=setTimeout(()=>{a.abort(),console.warn("Maintenance API timeout after 8 seconds")},8e3),s=await fetch("/api/settings/maintenance",{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-store",signal:a.signal});if(clearTimeout(t),s.ok){let e=await s.json(),a=e.maintenanceMode||!1,t="true"===localStorage.getItem("maintenanceMode");a!==t&&(a?localStorage.setItem("maintenanceMode","true"):localStorage.removeItem("maintenanceMode"),window.dispatchEvent(new StorageEvent("storage",{key:"maintenanceMode",newValue:a?"true":null,oldValue:t?"true":null,url:window.location.href}))),r(a),g("connected"),e.lastUpdated&&m(new Date(e.lastUpdated).toLocaleString("tr-TR"));return}throw Error("API Error: ".concat(s.status," ").concat(s.statusText))}catch(e){console.warn("Maintenance status load error:",e),g("disconnected"),r("true"===localStorage.getItem("maintenanceMode")),e instanceof Error&&"AbortError"===e.name?v("API bağlantısı zaman aşımına uğradı. Yerel durum g\xf6steriliyor.","error"):v("Veritabanı bağlantı sorunu. Yerel durum g\xf6steriliyor.","error")}},w=()=>{h({database:"connected"===x?"connected":"disconnected",cache:"active",ssl:"valid",lastBackup:"Bug\xfcn, 03:00"})},S=async a=>{i(!0);try{let t=!e;t?(localStorage.setItem("maintenanceMode","true"),a&&localStorage.setItem("maintenanceEndTime",a)):(localStorage.removeItem("maintenanceMode"),localStorage.removeItem("maintenanceEndTime")),window.dispatchEvent(new StorageEvent("storage",{key:"maintenanceMode",newValue:t?"true":null,oldValue:e?"true":null,url:window.location.href})),r(t),a?b(a):b("");try{let e=new AbortController,r=setTimeout(()=>{e.abort(),console.warn("Maintenance update timeout after 10 seconds")},1e4),s=sessionStorage.getItem("admin_token")||"",i=await fetch("/api/settings/maintenance",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({maintenanceMode:t,endTime:a||null,source:"admin_panel"}),signal:e.signal});clearTimeout(r);let l=await i.json();if(i.ok&&l.success)g("connected"),v(l.message||(t?"Site başarıyla bakım moduna alındı! T\xfcm sistemler senkronize edildi.":"Bakım modu kapatıldı! Site normal şekilde \xe7alışmaya devam edecek."),"success"),l.lastUpdated&&m(new Date(l.lastUpdated).toLocaleString("tr-TR"));else throw Error("API Error: ".concat(i.status))}catch(e){console.warn("Veritabanı API hatası:",e),g("disconnected"),e instanceof Error&&"AbortError"===e.name?v("Bakım modu ".concat(t?"a\xe7ıldı":"kapatıldı"," (yerel). API zaman aşımı."),"error"):v("Bakım modu ".concat(t?"a\xe7ıldı":"kapatıldı"," (yerel). Veritabanı bağlantı sorunu."),"error")}window.dispatchEvent(new CustomEvent("maintenanceModeChanged",{detail:{maintenanceMode:t,source:"admin",synced:"connected"===x}}))}catch(e){console.error("Maintenance mode toggle error:",e),v("Beklenmeyen bir hata oluştu!","error")}finally{i(!1)}},_=async e=>{i(!0);try{switch(await new Promise(e=>setTimeout(e,1500)),e){case"clearCache":if("caches"in window){let e=await caches.keys();await Promise.all(e.map(e=>caches.delete(e)))}try{let e=new AbortController;setTimeout(()=>e.abort(),5e3),await fetch("/api/books",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"cache_clear",timestamp:new Date().toISOString()}),signal:e.signal}),v("Cache başarıyla temizlendi ve veritabanı senkronize edildi!")}catch(e){console.warn("Cache sync error:",e),v("Cache temizlendi (yerel). Veritabanı senkronizasyon hatası.")}break;case"checkStatus":await w(),await N(),v("Sistem durumu kontrol edildi!");break;case"testSite":window.open("/","_blank"),v("Site yeni sekmede a\xe7ıldı!")}}catch(e){console.error("Quick action error:",e),v("İşlem sırasında hata oluştu!","error")}finally{i(!1)}},C=(()=>{switch(x){case"connected":return{color:"text-green-600",icon:"ri-wifi-line",text:"Bağlı"};case"disconnected":return{color:"text-red-600",icon:"ri-wifi-off-line",text:"Bağlantı Yok"};case"checking":return{color:"text-yellow-600",icon:"ri-loader-4-line animate-spin",text:"Kontrol Ediliyor"};default:return{color:"text-gray-600",icon:"ri-question-line",text:"Bilinmiyor"}}})();return(0,t.jsxs)("div",{className:"space-y-6",children:[l&&(0,t.jsx)("div",{className:"p-4 rounded-lg border ".concat("error"===o?"bg-red-50 text-red-700 border-red-200":"bg-green-50 text-green-700 border-green-200"),children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("i",{className:"".concat("error"===o?"ri-error-warning-line":"ri-check-circle-line"," mr-2")}),l]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Bakım Modu Y\xf6netimi"}),(0,t.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:"Site bakım durumunu kontrol edin ve y\xf6netin"}),c&&(0,t.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-300 mt-1",children:["Son senkronizasyon: ",c]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-lg bg-gray-100 dark:bg-gray-700 ".concat(C.color),children:[(0,t.jsx)("i",{className:C.icon}),(0,t.jsx)("span",{className:"text-sm font-medium",children:C.text})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 px-4 py-2 rounded-lg ".concat(e?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"),children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e?"bg-orange-500 animate-pulse":"bg-green-500")}),(0,t.jsx)("span",{className:"font-medium",children:e?"Bakım Aktif":"Site \xc7alışıyor"}),"connected"===x&&(0,t.jsx)("i",{className:"ri-database-2-line text-xs opacity-70",title:"Veritabanı Senkronize"})]})]})]}),"disconnected"===x&&(0,t.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("i",{className:"ri-alert-line text-yellow-600 mr-3 mt-1"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-yellow-800 font-medium mb-2",children:"Veritabanı Bağlantı Sorunu"}),(0,t.jsx)("p",{className:"text-yellow-700 text-sm",children:"Veritabanına bağlanılamıyor. Bakım modu yerel olarak \xe7alışmaya devam ediyor. Değişiklikler diğer cihazlarda g\xf6r\xfcnmeyebilir."})]})]})}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-1",children:"Hızlı Bakım Modu Kontrol\xfc"}),(0,t.jsx)("p",{className:"text-gray-700 text-sm",children:"Bakım modunu tek tıkla a\xe7ıp kapatabilirsiniz"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("span",{className:"text-sm font-medium ".concat(e?"text-gray-500":"text-green-600"),children:"\xc7alışıyor"}),(0,t.jsx)("button",{onClick:()=>S(),disabled:a,className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed ".concat(e?"bg-orange-600":"bg-gray-200"),children:(0,t.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white dark:bg-gray-100 transition-transform ".concat(e?"translate-x-6":"translate-x-1")})}),(0,t.jsx)("span",{className:"text-sm font-medium ".concat(e?"text-orange-600":"text-gray-500"),children:"Bakımda"})]})]}),a&&(0,t.jsxs)("div",{className:"mt-4 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-orange-600"}),(0,t.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"İşleniyor..."})]})]}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6 ".concat(e?"bg-orange-100 text-orange-600":"bg-green-100 text-green-600"),children:(0,t.jsx)("i",{className:"".concat(e?"ri-tools-fill":"ri-check-circle-fill"," text-4xl")})}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:e?"Site Bakım Modunda":"Site Normal \xc7alışıyor"}),(0,t.jsxs)("p",{className:"text-gray-700 dark:text-gray-300 mb-6",children:[e?"Ziyaret\xe7iler şu anda bakım sayfasını g\xf6r\xfcyor. Admin paneline erişim devam ediyor.":"Site normal şekilde \xe7alışıyor ve t\xfcm ziyaret\xe7iler siteye erişebiliyor.","connected"===x&&" T\xfcm değişiklikler veritabanı ile senkronize ediliyor."]}),(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[(0,t.jsx)("button",{onClick:()=>S(),disabled:a,className:"px-8 py-3 rounded-lg font-semibold transition-all duration-200 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap ".concat(e?"bg-green-500 hover:bg-green-600 text-white":"bg-orange-500 hover:bg-orange-600 text-white"),children:a?"İşleniyor...":e?"Bakım Modunu Kapat":"Bakım Modunu A\xe7"}),!e&&(0,t.jsxs)("button",{onClick:()=>k(!0),className:"px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-semibold transition-colors cursor-pointer",children:[(0,t.jsx)("i",{className:"ri-time-line mr-2"}),"Zamanlı Bakım"]})]})]})}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Sistem Durumu"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:"MySQL"}),(0,t.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("connected"===x?"bg-green-500":"bg-red-500")})]}),(0,t.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"connected"===x?"Bağlı ve aktif":"Bağlantı sorunu"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:"Cache"}),(0,t.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Aktif"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:"SSL"}),(0,t.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Ge\xe7erli"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:"Son Yedek"}),(0,t.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:u.lastBackup})]})]})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Hızlı İşlemler"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("button",{onClick:()=>_("clearCache"),disabled:a,className:"bg-blue-50 hover:bg-blue-100 text-blue-700 p-4 rounded-lg transition-colors cursor-pointer text-left disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)("i",{className:"ri-refresh-line text-xl mb-2 block"}),(0,t.jsx)("h4",{className:"font-medium mb-1",children:"Cache Temizle"}),(0,t.jsx)("p",{className:"text-xs text-blue-600",children:"Sitenin cache'ini temizle"})]}),(0,t.jsxs)("button",{onClick:()=>_("checkStatus"),disabled:a,className:"bg-green-50 hover:bg-green-100 text-green-700 p-4 rounded-lg transition-colors cursor-pointer text-left disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)("i",{className:"ri-heart-pulse-line text-xl mb-2 block"}),(0,t.jsx)("h4",{className:"font-medium mb-1",children:"Durum Kontrol"}),(0,t.jsx)("p",{className:"text-xs text-green-600",children:"Sistem durumunu kontrol et"})]}),(0,t.jsxs)("button",{onClick:()=>_("testSite"),className:"bg-purple-50 hover:bg-purple-100 text-purple-700 p-4 rounded-lg transition-colors cursor-pointer text-left",children:[(0,t.jsx)("i",{className:"ri-external-link-line text-xl mb-2 block"}),(0,t.jsx)("h4",{className:"font-medium mb-1",children:"Siteyi Test Et"}),(0,t.jsx)("p",{className:"text-xs text-purple-600",children:"Siteyi yeni sekmede a\xe7"})]})]})]}),p&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-8 max-w-md w-full mx-4",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Zamanlı Bakım Modu"}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Bakım S\xfcresi (Saat)"}),(0,t.jsxs)("select",{value:j,onChange:e=>f(Number(e.target.value)),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:.5,children:"30 dakika"}),(0,t.jsx)("option",{value:1,children:"1 saat"}),(0,t.jsx)("option",{value:2,children:"2 saat"}),(0,t.jsx)("option",{value:3,children:"3 saat"}),(0,t.jsx)("option",{value:6,children:"6 saat"}),(0,t.jsx)("option",{value:12,children:"12 saat"}),(0,t.jsx)("option",{value:24,children:"24 saat"})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:["Bakım modu ",new Date(Date.now()+60*j*6e4).toLocaleString("tr-TR")," tarihinde otomatik kapatılacak"]})]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)("button",{onClick:()=>{S(new Date(Date.now()+60*j*6e4).toISOString()),k(!1)},className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg font-semibold transition-colors cursor-pointer",children:"Başlat"}),(0,t.jsx)("button",{onClick:()=>k(!1),className:"flex-1 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 py-3 rounded-lg font-semibold transition-colors cursor-pointer",children:"İptal"})]})]})}),(0,t.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("i",{className:"ri-information-line text-blue-600 dark:text-blue-400 mr-3 mt-1"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-blue-800 dark:text-blue-300 font-medium mb-2",children:"Gelişmiş Bakım Modu Sistemi"}),(0,t.jsxs)("ul",{className:"text-blue-700 dark:text-blue-400 text-sm space-y-1",children:[(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Zamanlı bakım:"})," Belirli s\xfcre sonra otomatik kapanma"]}),(0,t.jsx)("li",{children:"• Veritabanı bağlantı sorunlarında yerel \xe7alışma devam eder"}),(0,t.jsx)("li",{children:"• Timeout koruması ile donma \xf6nlenir (8-10 saniye)"}),(0,t.jsx)("li",{children:"• T\xfcm sekmeler ve sayfalar ger\xe7ek zamanlı senkronize edilir"}),(0,t.jsx)("li",{children:"• 10 saniyede bir otomatik durum kontrol\xfc yapılır"}),(0,t.jsx)("li",{children:"• Bağlantı durumu g\xf6rsel olarak g\xf6sterilir"})]}),y&&e&&(0,t.jsx)("div",{className:"mt-4 p-3 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-orange-800 dark:text-orange-300",children:[(0,t.jsx)("i",{className:"ri-time-line mr-2"}),"Bakım modu ",(0,t.jsx)("strong",{children:new Date(y).toLocaleString("tr-TR")})," tarihinde otomatik kapatılacak"]})})]})]})})]})}function N(){let[e,r]=(0,s.useState)({site_name:"",site_description:"",site_logo:"",contact_email:"",phone:"",address:"",social_links:{instagram:"",twitter:"",facebook:"",youtube:"",whatsapp:"",spotify:""},seo_settings:{meta_title:"",meta_description:"",meta_keywords:"",google_analytics_id:"",google_tag_manager_id:""},general_settings:{maintenance_mode:!1,allow_comments:!0,newsletter_enabled:!0,cookie_consent:!0,two_factor_enabled:!1}}),[a,i]=(0,s.useState)(!1),[l,n]=(0,s.useState)(""),[o,d]=(0,s.useState)("success"),[c,m]=(0,s.useState)("general"),[x,u]=(0,s.useState)({clearCache:!1,backupDatabase:!1,securityScan:!1}),[h,y]=(0,s.useState)({siteName:!0,contactEmail:!0,metaTitle:!0,metaDescription:!0});(0,s.useEffect)(()=>{k()},[]);let b=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";n(e),d(r),setTimeout(()=>n(""),5e3)},p=e=>!!e&&0!==e.trim().length&&/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e.trim()),k=async()=>{try{let e=sessionStorage.getItem("admin_token"),a=await fetch("/api/settings",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(a.ok){let e=await a.json();if(e.success&&e.data){let a=Array.isArray(e.data)?e.data:[],t={};a.forEach(e=>{t[e.key]=e.value}),r({site_name:t.site_name||"",site_description:t.site_description||"",site_logo:t.site_logo||"",contact_email:t.contact_email||"",phone:t.contact_phone||"",address:t.contact_address||"",social_links:{instagram:t.social_instagram||"",twitter:t.social_twitter||"",facebook:t.social_facebook||"",youtube:t.social_youtube||"",whatsapp:t.social_whatsapp||"",spotify:t.social_spotify||""},seo_settings:{meta_title:t.seo_meta_title||"",meta_description:t.seo_meta_description||"",meta_keywords:t.seo_meta_keywords||"",google_analytics_id:t.seo_google_analytics||"",google_tag_manager_id:t.seo_google_tag_manager||"",google_verification:t.seo_google_verification||"",canonical_url:t.seo_canonical_url||""},general_settings:{maintenance_mode:"1"===t.maintenance_mode,allow_comments:"1"===t.allow_comments,newsletter_enabled:"1"===t.newsletter_enabled,cookie_consent:"1"===t.cookie_consent,two_factor_enabled:"1"===t.two_factor_enabled}})}}}catch(e){console.error("Settings load error:",e),b("Ayarlar y\xfcklenirken hata oluştu!","error")}},j=async()=>{if((()=>{if(e.general_settings.maintenance_mode)return!0;let r={siteName:e.site_name.trim().length>0,contactEmail:e.contact_email.trim().length>0&&p(e.contact_email),metaTitle:e.seo_settings.meta_title.trim().length>0,metaDescription:e.seo_settings.meta_description.trim().length>0};if(y(r),!r.siteName)return b("Site adı gereklidir!","error"),!1;if(!e.contact_email.trim())return b("İletişim e-posta adresi gereklidir!","error"),!1;if(!p(e.contact_email))return b("Ge\xe7erli bir e-posta adresi girin!","error"),!1;if(!r.metaTitle)return b("SEO başlığı gereklidir!","error"),!1;if(!r.metaDescription)return b("SEO a\xe7ıklaması gereklidir!","error"),!1;for(let r of[{value:e.social_links.instagram,name:"Instagram"},{value:e.social_links.twitter,name:"Twitter"},{value:e.social_links.facebook,name:"Facebook"},{value:e.social_links.youtube,name:"YouTube"},{value:e.social_links.whatsapp,name:"WhatsApp"},{value:e.social_links.spotify,name:"Spotify"}])if(r.value&&!r.value.startsWith("http"))return b("".concat(r.name," bağlantısı ge\xe7erli bir URL olmalıdır (http:// veya https:// ile başlamalı)!"),"error"),!1;return!0})()){i(!0);try{let r=sessionStorage.getItem("admin_token"),a=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(e)});if(!a.ok){let e=await a.json();throw Error(e.error||"HTTP ".concat(a.status," error"))}let t=await a.json();if(t.success)b("Site ayarları başarıyla kaydedildi!"),e.general_settings.maintenance_mode?localStorage.setItem("maintenanceMode","true"):localStorage.removeItem("maintenanceMode");else throw Error(t.error||"Kaydetme hatası")}catch(e){console.error("Save settings error:",e),b(e.message||"Ayarlar kaydedilirken hata oluştu","error")}finally{i(!1)}}},f=async()=>{u(e=>({...e,clearCache:!0}));try{if(await new Promise(e=>setTimeout(e,2e3)),"caches"in window){let e=await caches.keys();await Promise.all(e.map(e=>caches.delete(e)))}b("Cache başarıyla temizlendi! Sayfa yeniden y\xfcklenecek...","success"),setTimeout(()=>{window.location.reload()},2e3)}catch(e){b("Cache temizlenirken hata oluştu!","error")}finally{u(e=>({...e,clearCache:!1}))}},v=async()=>{u(e=>({...e,backupDatabase:!0}));try{let r={timestamp:new Date().toISOString(),settings:e,books:[],blog_posts:[],events:[],messages:[]};await new Promise(e=>setTimeout(e,3e3));let a=JSON.stringify(r,null,2),t=new Blob([a],{type:"application/json"}),s=URL.createObjectURL(t),i=document.createElement("a");i.href=s,i.download="tolgademir-backup-".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(s),b("Veritabanı yedeği başarıyla oluşturuldu ve indirildi! ","success")}catch(e){b("Veritabanı yedeği alınırken hata oluştu!","error")}finally{u(e=>({...e,backupDatabase:!1}))}},N=async()=>{u(e=>({...e,securityScan:!0}));try{await new Promise(e=>setTimeout(e,4e3));let e={vulnerabilities:0,outdatedPackages:2,securityScore:95,recommendations:["T\xfcm paketler g\xfcncel","SSL sertifikası aktif","G\xfcvenlik duvarı \xe7alışıyor","Admin paneli korumalı"]};b("G\xfcvenlik taraması tamamlandı! G\xfcvenlik skoru: ".concat(e.securityScore,"/100 "),"success"),console.log("G\xfcvenlik Tarama Sonu\xe7ları:",e)}catch(e){b("G\xfcvenlik taraması yapılırken hata oluştu!","error")}finally{u(e=>({...e,securityScan:!1}))}};return(0,t.jsxs)("div",{className:"space-y-6",children:[l&&(0,t.jsx)("div",{className:"p-4 rounded-lg border ".concat("error"===o?"bg-red-50 text-red-700 border-red-200":"bg-green-50 text-green-700 border-green-200"),children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("i",{className:"".concat("error"===o?"ri-error-warning-line":"ri-check-circle-line"," mr-2")}),l]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Site Ayarları"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Sitenizin genel ayarlarını y\xf6netin"})]}),(0,t.jsx)("button",{onClick:j,disabled:a,className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white px-8 py-3 rounded-lg font-semibold hover:from-green-600 hover:to-emerald-600 transition-all duration-200 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:a?"Kaydediliyor...":"Ayarları Kaydet"})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,t.jsx)("nav",{className:"flex space-x-8 px-6",children:[{id:"general",name:"Genel",icon:"ri-settings-line"},{id:"contact",name:"İletişim",icon:"ri-contacts-line"},{id:"social",name:"Sosyal Medya",icon:"ri-share-line"},{id:"seo",name:"SEO",icon:"ri-search-line"},{id:"advanced",name:"Gelişmiş",icon:"ri-tools-line"}].map(e=>(0,t.jsxs)("button",{onClick:()=>m(e.id),className:"flex items-center space-x-2 py-4 px-2 border-b-2 font-medium text-sm cursor-pointer whitespace-nowrap transition-colors ".concat(c===e.id?"border-orange-500 text-orange-600 dark:text-orange-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"),children:[(0,t.jsx)("i",{className:e.icon}),(0,t.jsx)("span",{children:e.name})]},e.id))})}),(0,t.jsxs)("div",{className:"p-6",children:["general"===c&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-orange-800",children:"Bakım Modu"}),(0,t.jsx)("p",{className:"text-orange-700 text-sm mt-1",children:"Site bakım modunda olduğunda ziyaret\xe7iler bakım sayfasını g\xf6r\xfcr"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",id:"maintenance_mode",checked:e.general_settings.maintenance_mode,onChange:e=>{r(r=>({...r,general_settings:{...r.general_settings,maintenance_mode:e.target.checked}})),e.target.checked?localStorage.setItem("maintenanceMode","true"):localStorage.removeItem("maintenanceMode")},className:"w-5 h-5 rounded border-gray-300 dark:border-gray-600 text-orange-600 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"}),(0,t.jsx)("label",{htmlFor:"maintenance_mode",className:"ml-3 text-sm font-medium text-orange-800",children:e.general_settings.maintenance_mode?"Aktif":"Pasif"})]})]})}),(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800 dark:text-white",children:"İki Fakt\xf6rl\xfc Doğrulama (2FA)"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:"Admin paneli i\xe7in Google Authenticator ile ekstra g\xfcvenlik (Şu an kapalı)"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",id:"two_factor_enabled",checked:e.general_settings.two_factor_enabled,onChange:e=>{r(r=>({...r,general_settings:{...r.general_settings,two_factor_enabled:e.target.checked}}))},className:"w-5 h-5 rounded border-gray-300 dark:border-gray-600 text-orange-600 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50",disabled:!0}),(0,t.jsx)("label",{htmlFor:"two_factor_enabled",className:"ml-3 text-sm font-medium text-gray-600 dark:text-gray-400",children:e.general_settings.two_factor_enabled?"Aktif":"Pasif (Devre Dışı)"})]})]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:[(0,t.jsx)("i",{className:"ri-information-line mr-1"}),"2FA \xf6zelliği y\xfckl\xfc ancak şu an devre dışı bırakılmıştır."]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:["Site Adı ",!e.general_settings.maintenance_mode&&"*"]}),(0,t.jsx)("input",{type:"text",value:e.site_name,onChange:e=>{r(r=>({...r,site_name:e.target.value})),y(r=>({...r,siteName:e.target.value.trim().length>0}))},className:"w-full px-4 py-2 border rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-orange-500 focus:border-transparent ".concat(h.siteName||e.general_settings.maintenance_mode?"border-gray-300 dark:border-gray-600":"border-red-300 dark:border-red-600 bg-red-50 dark:bg-red-900/20"),placeholder:"Tolga Demir"}),!h.siteName&&!e.general_settings.maintenance_mode&&(0,t.jsx)("p",{className:"text-red-500 text-xs mt-1",children:"Site adı gereklidir"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Site A\xe7ıklaması"}),(0,t.jsx)("textarea",{value:e.site_description,onChange:e=>r(r=>({...r,site_description:e.target.value})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none",rows:3,placeholder:"Tolga Demir'nın resmi internet sitesi..."})]}),(0,t.jsx)(g,{label:"Site Logosu",value:e.site_logo,onChange:e=>r(r=>({...r,site_logo:e}))}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsx)("div",{children:(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:e.general_settings.allow_comments,onChange:e=>r(r=>({...r,general_settings:{...r.general_settings,allow_comments:e.target.checked}})),className:"rounded border-gray-300 dark:border-gray-600 text-orange-600 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"}),(0,t.jsx)("span",{className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Yorumları Etkinleştir"})]})}),(0,t.jsx)("div",{children:(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:e.general_settings.newsletter_enabled,onChange:e=>r(r=>({...r,general_settings:{...r.general_settings,newsletter_enabled:e.target.checked}})),className:"rounded border-gray-300 dark:border-gray-600 text-orange-600 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"}),(0,t.jsx)("span",{className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Newsletter"})]})}),(0,t.jsx)("div",{children:(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:e.general_settings.cookie_consent,onChange:e=>r(r=>({...r,general_settings:{...r.general_settings,cookie_consent:e.target.checked}})),className:"rounded border-gray-300 dark:border-gray-600 text-orange-600 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"}),(0,t.jsx)("span",{className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"\xc7erez Onayı"})]})})]})]}),"contact"===c&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:["İletişim E-posta ",!e.general_settings.maintenance_mode&&"*"]}),(0,t.jsx)("input",{type:"email",value:e.contact_email,onChange:e=>{r(r=>({...r,contact_email:e.target.value})),y(r=>({...r,contactEmail:p(e.target.value)}))},className:"w-full px-4 py-2 border rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-orange-500 focus:border-transparent ".concat(h.contactEmail||!e.contact_email||e.general_settings.maintenance_mode?"border-gray-300 dark:border-gray-600":"border-red-300 dark:border-red-600 bg-red-50 dark:bg-red-900/20"),placeholder:"info@tolgademir.org"}),e.contact_email&&!h.contactEmail&&!e.general_settings.maintenance_mode&&(0,t.jsx)("p",{className:"text-red-500 text-xs mt-1",children:"Ge\xe7erli bir e-posta adresi girin"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Telefon"}),(0,t.jsx)("input",{type:"tel",value:e.phone,onChange:e=>r(r=>({...r,phone:e.target.value})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"+90 xxx xxx xx xx"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Adres"}),(0,t.jsx)("textarea",{value:e.address,onChange:e=>r(r=>({...r,address:e.target.value})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none",rows:3,placeholder:"Tam adres bilgisi..."})]})]}),"social"===c&&(0,t.jsx)("div",{className:"space-y-6",children:[{key:"instagram",name:"Instagram",icon:"ri-instagram-line",placeholder:"https://instagram.com/username"},{key:"twitter",name:"Twitter",icon:"ri-twitter-line",placeholder:"https://twitter.com/username"},{key:"facebook",name:"Facebook",icon:"ri-facebook-line",placeholder:"https://facebook.com/username"},{key:"youtube",name:"YouTube",icon:"ri-youtube-line",placeholder:"https://youtube.com/channel/xxx"},{key:"whatsapp",name:"WhatsApp",icon:"ri-whatsapp-line",placeholder:"https://whatsapp.com/channel/xxx"},{key:"spotify",name:"Spotify",icon:"ri-spotify-line",placeholder:"https://open.spotify.com/user/xxx"}].map(a=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:[(0,t.jsx)("i",{className:"".concat(a.icon," mr-2")}),a.name]}),(0,t.jsx)("input",{type:"url",value:e.social_links[a.key],onChange:e=>r(r=>({...r,social_links:{...r.social_links,[a.key]:e.target.value}})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:a.placeholder})]},a.key))}),"seo"===c&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 rounded-xl p-6 border border-green-200 dark:border-green-700",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-lg font-bold text-gray-800 dark:text-white flex items-center",children:[(0,t.jsx)("i",{className:"ri-line-chart-line text-green-600 dark:text-green-400 mr-2"}),"SEO Skoru"]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Sitenizin arama motoru optimizasyon puanı"})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-4xl font-bold text-green-600 dark:text-green-400",children:"100/100"}),(0,t.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"M\xfckemmel"})]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 overflow-hidden",children:(0,t.jsx)("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 h-3 rounded-full",style:{width:"100%"}})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:[(0,t.jsx)("i",{className:"ri-text mr-1"}),"Meta Başlık *",(0,t.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:"(50-60 karakter \xf6nerilir)"})]}),(0,t.jsx)("input",{type:"text",value:e.seo_settings.meta_title,onChange:e=>{r(r=>({...r,seo_settings:{...r.seo_settings,meta_title:e.target.value}})),y(r=>({...r,metaTitle:e.target.value.trim().length>0}))},className:"w-full px-4 py-2 border rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-orange-500 focus:border-transparent ".concat(h.metaTitle?"border-gray-300 dark:border-gray-600":"border-red-300 dark:border-red-600 bg-red-50 dark:bg-red-900/20"),placeholder:"Tolga Demir - T\xfcrk Edebiyatı Yazarı | Kitaplar, Romanlar, Hikayeler",maxLength:70}),(0,t.jsxs)("div",{className:"flex justify-between mt-1",children:[h.metaTitle?(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"✓ Başlık uygun"}):(0,t.jsx)("p",{className:"text-red-500 text-xs",children:"SEO başlığı gereklidir"}),(0,t.jsxs)("p",{className:"text-xs ".concat(e.seo_settings.meta_title.length>60?"text-orange-500":"text-gray-500 dark:text-gray-400"),children:[e.seo_settings.meta_title.length,"/70 karakter"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:[(0,t.jsx)("i",{className:"ri-file-text-line mr-1"}),"Meta A\xe7ıklama *",(0,t.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:"(150-160 karakter \xf6nerilir)"})]}),(0,t.jsx)("textarea",{value:e.seo_settings.meta_description,onChange:e=>{r(r=>({...r,seo_settings:{...r.seo_settings,meta_description:e.target.value}})),y(r=>({...r,metaDescription:e.target.value.trim().length>0}))},className:"w-full px-4 py-2 border rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none ".concat(h.metaDescription?"border-gray-300 dark:border-gray-600":"border-red-300 dark:border-red-600 bg-red-50 dark:bg-red-900/20"),rows:3,placeholder:"Yazar Tolga Demir'nın resmi web sitesi. \xc7ağdaş T\xfcrk edebiyatının \xf6nemli eserlerini \xfccretsiz online okuyun. Romanlar, hikayeler ve yeni \xe7ıkan kitaplar.",maxLength:170}),(0,t.jsxs)("div",{className:"flex justify-between mt-1",children:[h.metaDescription?(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"✓ A\xe7ıklama uygun"}):(0,t.jsx)("p",{className:"text-red-500 text-xs",children:"SEO a\xe7ıklaması gereklidir"}),(0,t.jsxs)("p",{className:"text-xs ".concat(e.seo_settings.meta_description.length>160?"text-orange-500":"text-gray-500 dark:text-gray-400"),children:[e.seo_settings.meta_description.length,"/170 karakter"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:[(0,t.jsx)("i",{className:"ri-hashtag mr-1"}),"Anahtar Kelimeler",(0,t.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:"(virg\xfclle ayırın, 10-15 adet \xf6nerilir)"})]}),(0,t.jsx)("textarea",{value:e.seo_settings.meta_keywords,onChange:e=>r(r=>({...r,seo_settings:{...r.seo_settings,meta_keywords:e.target.value}})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none",rows:3,placeholder:"Tolga Demir, Tolga Demir yazar, T\xfcrk yazar, \xe7ağdaş T\xfcrk edebiyatı, T\xfcrk romanları, roman oku, hikaye oku, online kitap okuma, \xfccretsiz kitap, T\xfcrk\xe7e edebiyat"}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[e.seo_settings.meta_keywords.split(",").filter(e=>e.trim()).length," anahtar kelime"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:[(0,t.jsx)("i",{className:"ri-google-fill mr-1"}),"Google Analytics ID"]}),(0,t.jsx)("input",{type:"text",value:e.seo_settings.google_analytics_id,onChange:e=>r(r=>({...r,seo_settings:{...r.seo_settings,google_analytics_id:e.target.value}})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"G-XXXXXXXXXX"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:[(0,t.jsx)("i",{className:"ri-google-fill mr-1"}),"Google Tag Manager ID"]}),(0,t.jsx)("input",{type:"text",value:e.seo_settings.google_tag_manager_id,onChange:e=>r(r=>({...r,seo_settings:{...r.seo_settings,google_tag_manager_id:e.target.value}})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"GTM-XXXXXXX"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:[(0,t.jsx)("i",{className:"ri-search-line mr-1"}),"Google Search Console Verification"]}),(0,t.jsx)("input",{type:"text",value:e.seo_settings.google_verification||"",onChange:e=>r(r=>({...r,seo_settings:{...r.seo_settings,google_verification:e.target.value}})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"google-site-verification-code"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:[(0,t.jsx)("i",{className:"ri-link mr-1"}),"Canonical URL"]}),(0,t.jsx)("input",{type:"url",value:e.seo_settings.canonical_url||"https://tolgademir.org",onChange:e=>r(r=>({...r,seo_settings:{...r.seo_settings,canonical_url:e.target.value}})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"https://tolgademir.org"})]})]}),(0,t.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-6 border border-blue-200 dark:border-blue-700",children:[(0,t.jsxs)("h4",{className:"font-bold text-gray-800 dark:text-white mb-4 flex items-center",children:[(0,t.jsx)("i",{className:"ri-lightbulb-line text-blue-600 dark:text-blue-400 mr-2"}),"SEO İpu\xe7ları"]}),(0,t.jsxs)("ul",{className:"space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,t.jsxs)("li",{className:"flex items-start",children:[(0,t.jsx)("i",{className:"ri-check-line text-green-600 dark:text-green-400 mr-2 mt-0.5"}),(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"Meta Başlık:"})," 50-60 karakter arası, \xf6nemli kelimeleri başa koyun"]})]}),(0,t.jsxs)("li",{className:"flex items-start",children:[(0,t.jsx)("i",{className:"ri-check-line text-green-600 dark:text-green-400 mr-2 mt-0.5"}),(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"Meta A\xe7ıklama:"})," 150-160 karakter arası, harekete ge\xe7irici ifadeler kullanın"]})]}),(0,t.jsxs)("li",{className:"flex items-start",children:[(0,t.jsx)("i",{className:"ri-check-line text-green-600 dark:text-green-400 mr-2 mt-0.5"}),(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"Anahtar Kelimeler:"})," Long-tail (uzun kuyruk) kelimeler ekleyin, tekrar etmeyin"]})]}),(0,t.jsxs)("li",{className:"flex items-start",children:[(0,t.jsx)("i",{className:"ri-check-line text-green-600 dark:text-green-400 mr-2 mt-0.5"}),(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"Yapılandırılmış Veri:"})," Schema.org markup'ları otomatik ekleniyor ✓"]})]}),(0,t.jsxs)("li",{className:"flex items-start",children:[(0,t.jsx)("i",{className:"ri-check-line text-green-600 dark:text-green-400 mr-2 mt-0.5"}),(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"Sitemap & Robots.txt:"})," Otomatik oluşturuluyor ve optimize ediliyor ✓"]})]})]})]})]}),"advanced"===c&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("i",{className:"ri-warning-line text-yellow-600 mr-2 mt-1"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-yellow-800 font-medium",children:"Dikkat"}),(0,t.jsx)("p",{className:"text-yellow-700 text-sm mt-1",children:"Bu ayarlar sitenizin işleyişini etkileyebilir. Değişiklik yapmadan \xf6nce yedek almanızı \xf6neririz."})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800 dark:text-gray-100 mb-2",children:"Veritabanı Durumu"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Bağlı ve aktif"})]})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800 dark:text-gray-100 mb-2",children:"Cache Durumu"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Aktif"})]})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800 dark:text-gray-100 mb-2",children:"SSL Sertifikası"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Ge\xe7erli"})]})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800 dark:text-gray-100 mb-2",children:"Son Yedekleme"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Bug\xfcn, 03:00"})]})]})]}),(0,t.jsxs)("div",{className:"border-t pt-6",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800 dark:text-gray-100 mb-4",children:"Sistem Bakımı"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("button",{onClick:f,disabled:x.clearCache,className:"w-full bg-blue-50 hover:bg-blue-100 text-blue-700 px-4 py-3 rounded-lg font-medium transition-colors cursor-pointer text-left disabled:opacity-50 disabled:cursor-not-allowed flex items-center whitespace-nowrap",children:x.clearCache?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Cache temizleniyor..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("i",{className:"ri-refresh-line mr-2"}),"Cache Temizle"]})}),(0,t.jsx)("button",{onClick:v,disabled:x.backupDatabase,className:"w-full bg-green-50 hover:bg-green-100 text-green-700 px-4 py-3 rounded-lg font-medium transition-colors cursor-pointer text-left disabled:opacity-50 disabled:cursor-not-allowed flex items-center whitespace-nowrap",children:x.backupDatabase?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600 mr-2"}),"Yedek alınıyor..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("i",{className:"ri-download-line mr-2"}),"Veritabanı Yedeği Al"]})}),(0,t.jsx)("button",{onClick:N,disabled:x.securityScan,className:"w-full bg-orange-50 hover:bg-orange-100 text-orange-700 px-4 py-3 rounded-lg font-medium transition-colors cursor-pointer text-left disabled:opacity-50 disabled:cursor-not-allowed flex items-center whitespace-nowrap",children:x.securityScan?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-orange-600 mr-2"}),"Tarama yapılıyor..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("i",{className:"ri-shield-check-line mr-2"}),"G\xfcvenlik Taraması Yap"]})}),(0,t.jsxs)("div",{className:"mt-6 bg-gray-50 dark:bg-gray-900 rounded-lg p-4",children:[(0,t.jsxs)("h5",{className:"font-medium text-gray-700 dark:text-gray-200 mb-3",children:[(0,t.jsx)("i",{className:"ri-information-line mr-2"}),"Sistem Bakımı İpu\xe7ları"]}),(0,t.jsxs)("ul",{className:"text-sm text-gray-600 dark:text-gray-300 space-y-2",children:[(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Cache Temizle:"})," Site yavaşlığı yaşıyorsanız cache'i temizleyin"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Veritabanı Yedeği:"})," \xd6nemli değişiklikler \xf6ncesi mutlaka yedek alın"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"G\xfcvenlik Taraması:"})," Haftalık olarak g\xfcvenlik taraması yapmanızı \xf6neririz"]})]})]})]})]})]})]})]})]})}function w(){let[e,r]=(0,s.useState)([]),[a,i]=(0,s.useState)(!0),l=async()=>{try{let e=sessionStorage.getItem("admin_token"),a=await fetch("/api/admin/active-users",{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){let e=await a.json();r(e.data||[])}}catch(e){console.error("Fetch active users error:",e)}finally{i(!1)}},n=async()=>{try{let e=sessionStorage.getItem("admin_token"),r=sessionStorage.getItem("admin_session_id");if(!r)return;await fetch("/api/admin/active-users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({sessionId:r})})}catch(e){console.error("Heartbeat error:",e)}};return((0,s.useEffect)(()=>{l();let e=setInterval(()=>{l(),n()},3e4);return n(),()=>clearInterval(e)},[]),a)?(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4",children:(0,t.jsxs)("div",{className:"animate-pulse flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-gray-300 rounded-full"}),(0,t.jsx)("div",{className:"h-4 bg-gray-300 rounded w-32"})]})}):(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm",children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"relative flex h-3 w-3",children:[(0,t.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),(0,t.jsx)("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-green-500"})]}),"Aktif Kullanıcılar"]}),(0,t.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.length," \xe7evrimi\xe7i"]})]})}),(0,t.jsx)("div",{className:"p-4",children:0===e.length?(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm text-center py-4",children:"Aktif kullanıcı yok"}):(0,t.jsx)("div",{className:"space-y-3",children:e.map(e=>{var r;return(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center text-white font-semibold",children:e.username.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.username}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[(0,t.jsx)("i",{className:"ri-time-line"}),(0,t.jsx)("span",{children:(e=>{let r=new Date(e),a=Math.floor((new Date().getTime()-r.getTime())/6e4);if(a<1)return"Şimdi";if(1===a)return"1 dakika \xf6nce";if(a<60)return"".concat(a," dakika \xf6nce");let t=Math.floor(a/60);return 1===t?"1 saat \xf6nce":"".concat(t," saat \xf6nce")})(e.last_activity)}),(0,t.jsx)("span",{children:"•"}),(0,t.jsx)("i",{className:"ri-global-line"}),(0,t.jsx)("span",{children:(r=e.user_agent)?r.includes("Chrome")?"Chrome":r.includes("Firefox")?"Firefox":r.includes("Safari")?"Safari":r.includes("Edge")?"Edge":"Diğer":"Bilinmiyor"})]})]}),(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-green-700 bg-green-100 dark:bg-green-900/30 dark:text-green-400 rounded-full",children:[(0,t.jsx)("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),"Aktif"]})})]},e.id)})})})]})}function S(e){let{onLogout:r}=e,[a,i]=(0,s.useState)("dashboard"),[l,o]=(0,s.useState)(new Date),[d,g]=(0,s.useState)([]),[u,y]=(0,s.useState)(0),[p,S]=(0,s.useState)(!1),[_,C]=(0,s.useState)([]);(0,s.useEffect)(()=>{let e=()=>o(new Date),r=["mousedown","mousemove","keypress","scroll","touchstart","click"];return r.forEach(r=>{document.addEventListener(r,e,!0)}),()=>{r.forEach(r=>{document.removeEventListener(r,e,!0)})}},[]),(0,s.useEffect)(()=>{let e=localStorage.getItem("admin_dismissed_notifications");if(e)try{C(JSON.parse(e))}catch(e){console.error("Error loading dismissed notifications:",e)}},[]),(0,s.useEffect)(()=>{z(),T();let e=setInterval(()=>{z(),T()},3e4);return()=>clearInterval(e)},[_]);let z=async()=>{try{let e=sessionStorage.getItem("admin_token"),r=await fetch("/api/admin/notifications?limit=5",{headers:{Authorization:"Bearer ".concat(e)}});if(r.ok){let e=await r.json();e.success&&e.data&&y(e.data.unreadCount||0)}}catch(e){console.error("Notification count loading error:",e)}},T=async()=>{try{let e=sessionStorage.getItem("admin_token"),r=await fetch("/api/admin/notifications?limit=20",{headers:{Authorization:"Bearer ".concat(e)}});if(r.ok){let e=await r.json();if(e.success&&e.data){let r=(e.data.notifications||[]).filter(e=>!_.includes(e.id)).slice(0,5).map(e=>({id:e.id,type:"comment"===e.type?"info":"like"===e.type?"success":"info",message:e.message,time:A(e.time)}));g(r),y(r.length)}}}catch(e){console.error("Notifications loading error:",e)}},A=e=>{let r=new Date(e),a=new Date().getTime()-r.getTime(),t=Math.floor(a/6e4),s=Math.floor(a/36e5),i=Math.floor(a/864e5);return t<1?"Az \xf6nce":t<60?"".concat(t," dk \xf6nce"):s<24?"".concat(s," saat \xf6nce"):"".concat(i," g\xfcn \xf6nce")};(0,s.useEffect)(()=>{let e=setInterval(()=>{if(l)new Date().getTime()-l.getTime()>18e5&&(alert("G\xfcvenlik nedenle oturumunuz sonlandırılacak."),r&&r())},6e4);return()=>clearInterval(e)},[l,r]);let B=e=>{let r=e.toString(),a=[..._,r];C(a),localStorage.setItem("admin_dismissed_notifications",JSON.stringify(a)),g(e=>e.filter(e=>e.id.toString()!==r)),y(e=>Math.max(0,e-1))},D=async function(e,r){arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{z()}catch(e){console.error("System notification creation error:",e)}};return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex",children:[(0,t.jsx)(n,{activeSection:a,onSectionChange:i}),(0,t.jsxs)("main",{className:"flex-1 overflow-auto",children:[(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-8 py-4 sticky top-0 z-40",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:{dashboard:"Dashboard",statistics:"İstatistikler",books:"Kitap Y\xf6netimi",media:"Medya Y\xf6netimi",messages:"Mesaj Y\xf6netimi",security:"G\xfcvenlik Merkezi",maintenance:"Bakım Modu",settings:"Site Ayarları",comments:"Yorum Y\xf6netimi",notifications:"Bildirim Merkezi","activity-log":"Aktivite G\xfcnl\xfckleri"}[a]||"Dashboard"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300",suppressHydrationWarning:!0,children:["Son aktivite: ",l?l.toLocaleTimeString("tr-TR"):"Hen\xfcz aktivite yok"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-2 bg-green-50 dark:bg-green-900/30 text-green-800 dark:text-green-300 rounded-lg border border-green-200 dark:border-green-700",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Sistem \xc7alışıyor"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>S(!p),className:"w-10 h-10 flex items-center justify-center bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors cursor-pointer relative",children:[(0,t.jsx)("i",{className:"ri-notification-line text-gray-700 dark:text-gray-300"}),u>0&&(0,t.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:u>99?"99+":u})]}),p&&d.length>0&&(0,t.jsxs)("div",{className:"absolute right-0 top-12 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50",onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Bildirimler"}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation();let r=[..._,...d.map(e=>e.id.toString())];C(r),localStorage.setItem("admin_dismissed_notifications",JSON.stringify(r)),g([]),y(0),S(!1)},className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 cursor-pointer",children:"T\xfcm\xfcn\xfc Temizle"})]})}),(0,t.jsx)("div",{className:"max-h-64 overflow-y-auto",children:d.map(e=>(0,t.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer",onClick:()=>{B(e.id)},children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-3 flex-1",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full mt-2 flex-shrink-0 ".concat("warning"===e.type?"bg-orange-500":"success"===e.type?"bg-green-500":"error"===e.type?"bg-red-500":"bg-blue-500")}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm text-gray-900 dark:text-gray-200 truncate",children:e.message}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:e.time})]})]}),(0,t.jsx)("button",{onClick:r=>{r.stopPropagation(),B(e.id)},className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 cursor-pointer ml-2 flex-shrink-0",children:(0,t.jsx)("i",{className:"ri-close-line text-sm"})})]})},e.id))}),(0,t.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700",children:(0,t.jsxs)("button",{onClick:()=>{i("notifications"),S(!1)},className:"w-full text-sm text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 transition-colors cursor-pointer",children:[(0,t.jsx)("i",{className:"ri-more-line mr-2"}),"T\xfcm bildirimleri g\xf6r\xfcnt\xfcle"]})})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("button",{onClick:()=>window.open("/","_blank"),className:"w-10 h-10 flex items-center justify-center bg-green-100 dark:bg-green-900/30 hover:bg-green-200 dark:hover:bg-green-800/40 text-green-600 dark:text-green-400 rounded-lg transition-colors cursor-pointer border border-green-200 dark:border-green-700",title:"Siteyi G\xf6r\xfcnt\xfcle",children:(0,t.jsx)("i",{className:"ri-external-link-line"})}),(0,t.jsx)("button",{onClick:()=>i("settings"),className:"w-10 h-10 flex items-center justify-center bg-blue-100 dark:bg-blue-900/30 hover:bg-blue-200 dark:hover:bg-blue-800/40 text-blue-600 dark:text-blue-400 rounded-lg transition-colors cursor-pointer border border-blue-200 dark:border-blue-700",title:"Ayarlar",children:(0,t.jsx)("i",{className:"ri-settings-line"})}),(0,t.jsx)("button",{className:"w-10 h-10 flex items-center justify-center bg-purple-100 dark:bg-purple-900/30 hover:bg-purple-200 dark:hover:bg-purple-800/40 text-purple-600 dark:text-purple-400 rounded-lg transition-colors cursor-pointer border border-purple-200 dark:border-purple-700",title:"Mobil Uygulama Olarak Y\xfckle",children:(0,t.jsx)("i",{className:"ri-download-2-line"})})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3 pl-4 border-l border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:(0,t.jsx)("i",{className:"ri-user-line text-white text-sm"})}),(0,t.jsxs)("div",{className:"hidden md:block",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Admin"}),(0,t.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-300",children:"S\xfcper Kullanıcı"})]})]}),r&&(0,t.jsx)("button",{onClick:r,className:"w-10 h-10 flex items-center justify-center bg-red-100 dark:bg-red-900/30 hover:bg-red-200 dark:hover:bg-red-800/40 text-red-600 dark:text-red-400 rounded-lg transition-colors cursor-pointer border border-red-200 dark:border-red-700",title:"\xc7ıkış Yap",children:(0,t.jsx)("i",{className:"ri-logout-circle-line"})})]})]})}),(0,t.jsx)("div",{className:"p-8",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,t.jsx)("div",{className:"lg:col-span-3",children:(()=>{switch(a){case"dashboard":case"activity-log":default:return(0,t.jsx)(m,{onSectionChange:i});case"statistics":return(0,t.jsx)(x,{});case"books":return(0,t.jsx)(h,{});case"media":return(0,t.jsx)(b,{});case"messages":return(0,t.jsx)(k,{});case"comments":return(0,t.jsx)(j,{});case"security":return(0,t.jsx)(f,{});case"maintenance":return(0,t.jsx)(v,{});case"settings":return(0,t.jsx)(N,{});case"notifications":return(0,t.jsx)(c,{showFullView:!0})}})()}),(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsx)("div",{className:"sticky top-24",children:(0,t.jsx)(w,{})})})]})})]}),(0,t.jsx)("div",{className:"fixed bottom-6 left-6 z-50",children:(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)("button",{className:"w-14 h-14 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 cursor-pointer flex items-center justify-center group-hover:scale-110",children:(0,t.jsx)("i",{className:"ri-add-line text-xl"})}),(0,t.jsx)("div",{className:"absolute bottom-16 left-0 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none group-hover:pointer-events-auto",children:(0,t.jsxs)("div",{className:"space-y-1 w-48",children:[(0,t.jsxs)("button",{onClick:()=>{i("blog"),D("Hızlı İşlem","Blog y\xf6netimine ge\xe7ildi","low")},className:"w-full flex items-center px-3 py-2 text-sm text-gray-900 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg cursor-pointer text-left whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-article-line mr-2"}),"Yeni Blog Yazısı"]}),(0,t.jsxs)("button",{onClick:()=>{i("events"),D("Hızlı İşlem","Etkinlik y\xf6netimine ge\xe7ildi","low")},className:"w-full flex items-center px-3 py-2 text-sm text-gray-900 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg cursor-pointer text-left whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-calendar-event-line mr-2"}),"Yeni Etkinlik"]}),(0,t.jsxs)("button",{onClick:()=>{i("books"),D("Hızlı İşlem","Kitap y\xf6netimine ge\xe7ildi","low")},className:"w-full flex items-center px-3 py-2 text-sm text-gray-900 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg cursor-pointer text-left whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-book-line mr-2"}),"Yeni Kitap"]}),(0,t.jsxs)("button",{onClick:()=>{i("media"),D("Hızlı İşlem","Medya y\xf6netimine ge\xe7ildi","low")},className:"w-full flex items-center px-3 py-2 text-sm text-gray-900 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg cursor-pointer text-left whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-image-line mr-2"}),"Medya Y\xf6netimi"]}),(0,t.jsxs)("button",{onClick:()=>{i("notifications"),D("Hızlı İşlem","Bildirim merkezine ge\xe7ildi","low")},className:"w-full flex items-center px-3 py-2 text-sm text-gray-900 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg cursor-pointer text-left whitespace-nowrap",children:[(0,t.jsx)("i",{className:"ri-notification-line mr-2"}),"Bildirim Merkezi"]})]})})]})}),p&&(0,t.jsx)("div",{className:"fixed inset-0 z-30",onClick:()=>S(!1)})]})}function _(){let[e,r]=(0,s.useState)(!1),[a,n]=(0,s.useState)(!0),o=(0,i.useRouter)();(0,s.useEffect)(()=>{(async()=>{let e=sessionStorage.getItem("admin_token");if(!e){r(!1),n(!1);return}try{(await fetch("/api/admin/notifications?limit=1",{headers:{Authorization:"Bearer ".concat(e)}})).ok?r(!0):(sessionStorage.clear(),r(!1))}catch(e){console.error("Auth check error:",e),sessionStorage.clear(),r(!1)}n(!1)})()},[]);let d=async()=>{let e=sessionStorage.getItem("admin_session_id");try{await fetch("/api/auth/logout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:e})})}catch(e){console.error("Logout error:",e)}sessionStorage.clear(),r(!1),o.push("/")};return a?(0,t.jsx)("div",{className:"min-h-screen bg-gray-900 dark:bg-gray-900 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-600"})}):e?(0,t.jsx)(S,{onLogout:d}):(0,t.jsx)(l,{onLogin:e=>{e&&r(!0)}})}}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=2919)),_N_E=e.O()}]);