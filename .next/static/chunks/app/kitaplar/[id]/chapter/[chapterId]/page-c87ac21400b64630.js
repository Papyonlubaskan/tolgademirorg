(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3088],{5016:(e,a,t)=>{"use strict";function r(e){return e.toLowerCase().replace(/ğ/g,"g").replace(/ü/g,"u").replace(/ş/g,"s").replace(/ı/g,"i").replace(/ö/g,"o").replace(/ç/g,"c").replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim().replace(/^-|-$/g,"")}t.d(a,{e9:()=>r})},5405:(e,a,t)=>{"use strict";t.d(a,{default:()=>c});var r=t(5155),s=t(2115),l=t(2619),n=t.n(l),i=t(5016);function o(e){let{bookId:a,chapterId:t}=e,[l,n]=(0,s.useState)([]),[i,o]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),[x,m]=(0,s.useState)(!1),[g,u]=(0,s.useState)(!1),[h,y]=(0,s.useState)(""),[p,b]=(0,s.useState)(null),[f,j]=(0,s.useState)("");(0,s.useEffect)(()=>{let e=localStorage.getItem("user_id");e||(e="user_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),localStorage.setItem("user_id",e)),y(e),k()},[a,t]);let k=async()=>{if(a||t)try{m(!0);let e=new URLSearchParams;a&&e.set("bookId",a),t&&e.set("chapterId",t);let r=await fetch("/api/comments?".concat(e.toString())),s=await r.json();s.success&&n(s.data||[])}catch(e){console.error("Error loading comments:",e)}finally{m(!1)}},N=async e=>{if(e.preventDefault(),i.trim()&&c.trim())try{u(!0);let e={userName:c.trim(),content:i.trim(),userId:h};a&&(e.bookId=a),t&&(e.chapterId=t);let r=await fetch("/api/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});(await r.json()).success&&(o(""),localStorage.setItem("user_name",c.trim()),k())}catch(e){console.error("Error submitting comment:",e)}finally{u(!1)}},v=async e=>{if(f.trim())try{let a=await fetch("/api/comments/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:h,content:f.trim()})});(await a.json()).success&&(b(null),j(""),k())}catch(e){console.error("Error editing comment:",e)}},w=async e=>{if(confirm("Bu yorumu silmek istediginizden emin misiniz?"))try{let a=await fetch("/api/comments/".concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:h})});(await a.json()).success&&k()}catch(e){console.error("Error deleting comment:",e)}},S=()=>{b(null),j("")};return(0,s.useEffect)(()=>{let e=localStorage.getItem("user_name");e&&d(e)},[]),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["Yorumlar (",l.length,")"]}),(0,r.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"text",placeholder:"Adiniz",value:c,onChange:e=>d(e.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 dark:bg-gray-800 dark:text-white",required:!0})}),(0,r.jsx)("div",{children:(0,r.jsx)("textarea",{placeholder:"Yorumunuzu yazin...",value:i,onChange:e=>o(e.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 dark:bg-gray-800 dark:text-white",rows:4,required:!0,minLength:3})}),(0,r.jsx)("button",{type:"submit",disabled:g,className:"bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg font-medium transition-colors disabled:opacity-50 cursor-pointer",children:g?"Gonderiliyor...":"Yorum Yap"})]}),x?(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-600 mx-auto"})}):0===l.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Henuz yorum yapilmamis. Ilk yorumu siz yapin!"}):(0,r.jsx)("div",{className:"space-y-4",children:l.map(e=>(0,r.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:e.user_name}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString("tr-TR")})]}),p===e.id?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("textarea",{value:f,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",rows:3}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>v(e.id),className:"px-3 py-1 bg-orange-500 text-white rounded hover:bg-orange-600 text-sm",children:"Kaydet"}),(0,r.jsx)("button",{onClick:S,className:"px-3 py-1 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-white rounded hover:bg-gray-400 dark:hover:bg-gray-500 text-sm",children:"Iptal"})]})]}):(0,r.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:e.content})]}),e.user_id===h&&p!==e.id&&(0,r.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,r.jsx)("button",{onClick:()=>{b(e.id),j(e.content)},className:"text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400",children:"Duzenle"}),(0,r.jsx)("button",{onClick:()=>w(e.id),className:"text-sm text-red-600 hover:text-red-700 dark:text-red-400",children:"Sil"})]})]})},e.id))})]})}function c(e){var a;let{bookId:t,chapterId:l}=e,[c,d]=(0,s.useState)(null),[x,m]=(0,s.useState)(null),[g,u]=(0,s.useState)([]),[h,y]=(0,s.useState)(!0),[p,b]=(0,s.useState)(null),[f,j]=(0,s.useState)(16),[k,N]=(0,s.useState)(!1),v=(0,s.useRef)(null);(0,s.useEffect)(()=>{w()},[t,l]);let w=async()=>{try{y(!0),b(null);let e=await fetch("/api/books/".concat(t));if(!e.ok)throw Error("Kitap bulunamadı");let a=await e.json();if(!a.success||!a.data)throw Error("Kitap bulunamadı");d(a.data);let r=await fetch("/api/chapters/".concat(l));if(!r.ok)throw Error("B\xf6l\xfcm bulunamadı");let s=await r.json();if(!s.success||!s.data)throw Error("B\xf6l\xfcm bulunamadı");m(s.data);let n=await fetch("/api/chapters?bookId=".concat(a.data.id));if(n.ok){let e=await n.json();e.success&&e.data&&u(e.data)}y(!1)}catch(e){console.error("Error loading chapter data:",e),b("B\xf6l\xfcm y\xfcklenirken hata oluştu"),y(!1)}};return h?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-orange-50 to-amber-50 dark:from-gray-900 dark:to-gray-800",children:(0,r.jsx)("div",{className:"pt-20 pb-16",children:(0,r.jsx)("div",{className:"max-w-4xl mx-auto px-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-orange-500 border-t-transparent rounded-full mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"B\xf6l\xfcm y\xfckleniyor..."})]})})})}):!p&&c&&x?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-orange-50 to-amber-50 dark:from-gray-900 dark:to-gray-800",children:[(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700 sticky top-0 z-10",children:(0,r.jsx)("div",{className:"max-w-6xl mx-auto px-4 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)(n(),{href:"/kitaplar/".concat((0,i.e9)(c.title)),className:"flex items-center text-gray-600 dark:text-gray-300 hover:text-orange-500 dark:hover:text-orange-400 transition-colors",children:[(0,r.jsx)("i",{className:"ri-arrow-left-line mr-2"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Kitaba D\xf6n"})]}),(0,r.jsx)("div",{className:"h-6 w-px bg-gray-300 dark:bg-gray-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-lg font-semibold text-gray-800 dark:text-white truncate max-w-xs sm:max-w-md",children:c.title}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["B\xf6l\xfcm ",x.order_number||1]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>{j(e=>Math.max(e-2,12))},className:"p-2 text-gray-500 dark:text-gray-400 hover:text-orange-500 dark:hover:text-orange-400 transition-colors",title:"Yazı boyutunu k\xfc\xe7\xfclt",children:(0,r.jsx)("i",{className:"ri-text-decrease"})}),(0,r.jsxs)("button",{onClick:()=>{j(16)},className:"px-3 py-1 text-sm text-gray-500 dark:text-gray-400 hover:text-orange-500 dark:hover:text-orange-400 transition-colors",title:"Yazı boyutunu sıfırla",children:[f,"px"]}),(0,r.jsx)("button",{onClick:()=>{j(e=>Math.min(e+2,24))},className:"p-2 text-gray-500 dark:text-gray-400 hover:text-orange-500 dark:hover:text-orange-400 transition-colors",title:"Yazı boyutunu b\xfcy\xfct",children:(0,r.jsx)("i",{className:"ri-text-increase"})}),(0,r.jsx)("div",{className:"h-6 w-px bg-gray-300 dark:bg-gray-600"}),(0,r.jsx)("button",{onClick:()=>{if(document.fullscreenElement)document.exitFullscreen(),N(!1);else{var e;null==(e=v.current)||e.requestFullscreen(),N(!0)}},className:"p-2 text-gray-500 dark:text-gray-400 hover:text-orange-500 dark:hover:text-orange-400 transition-colors",title:k?"Tam ekrandan \xe7ık":"Tam ekran",children:(0,r.jsx)("i",{className:k?"ri-fullscreen-exit-line":"ri-fullscreen-line"})})]})]})})}),(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{ref:v,className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 prose prose-lg max-w-none dark:prose-invert overflow-y-auto",style:{fontSize:"".concat(f,"px"),maxHeight:k?"100vh":"none"},children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white mb-6 text-center",children:x.title}),(0,r.jsx)("div",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",dangerouslySetInnerHTML:{__html:x.content||"<p>İ\xe7erik mevcut değil.</p>"}})]}),g.length>0&&(0,r.jsxs)("div",{className:"mt-8 flex justify-between",children:[(0,r.jsx)("div",{className:"flex-1",children:(()=>{let e=g.find(e=>e.order_number===x.order_number-1);return e?(0,r.jsxs)(n(),{href:"/kitaplar/".concat((0,i.e9)(c.title),"/chapter/").concat(e.slug||e.id),className:"inline-flex items-center px-6 py-3 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:[(0,r.jsx)("i",{className:"ri-arrow-left-line mr-2"}),"\xd6nceki B\xf6l\xfcm"]}):null})()}),(0,r.jsx)("div",{className:"flex-1 text-center",children:(0,r.jsxs)("span",{className:"text-gray-500 dark:text-gray-400 text-sm",children:["B\xf6l\xfcm ",x.order_number," / ",g.length]})}),(0,r.jsx)("div",{className:"flex-1 text-right",children:(()=>{let e=g.find(e=>e.order_number===x.order_number+1);return e?(0,r.jsxs)(n(),{href:"/kitaplar/".concat((0,i.e9)(c.title),"/chapter/").concat(e.slug||e.id),className:"inline-flex items-center px-6 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",children:["Sonraki B\xf6l\xfcm",(0,r.jsx)("i",{className:"ri-arrow-right-line ml-2"})]}):null})()})]}),(0,r.jsx)("div",{className:"mt-12 bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8",children:(0,r.jsx)(o,{chapterId:null==(a=x.id)?void 0:a.toString()})})]})]}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-orange-50 to-amber-50 dark:from-gray-900 dark:to-gray-800",children:(0,r.jsx)("div",{className:"pt-20 pb-16",children:(0,r.jsx)("div",{className:"max-w-4xl mx-auto px-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-6xl text-orange-500 mb-4",children:"\uD83D\uDCD6"}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white mb-4",children:"B\xf6l\xfcm Bulunamadı"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-8",children:"Aradığınız b\xf6l\xfcm bulunamadı veya kaldırılmış olabilir."}),(0,r.jsxs)(n(),{href:"/kitaplar/".concat((0,i.e9)((null==c?void 0:c.title)||"")),className:"inline-flex items-center px-6 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",children:[(0,r.jsx)("i",{className:"ri-arrow-left-line mr-2"}),"Kitaba D\xf6n"]})]})})})})}},6780:(e,a,t)=>{Promise.resolve().then(t.bind(t,5405))}},e=>{e.O(0,[2619,8441,1255,7358],()=>e(e.s=6780)),_N_E=e.O()}]);