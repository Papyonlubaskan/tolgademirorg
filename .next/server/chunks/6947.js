"use strict";exports.id=6947,exports.ids=[6947],exports.modules={46947:(a,b,c)=>{c.d(b,{IPBanDetector:()=>d});class d{static isLikelyVPN(a){return[/^10\./,/^172\.(1[6-9]|2[0-9]|3[0-1])\./,/^192\.168\./,/^127\./,/^::1$/,/^169\.254\./].some(b=>b.test(a))}static getSubnet(a){return a.includes(":")?a.split(":").slice(0,4).join(":"):a.split(".").slice(0,3).join(".")}static createFingerprint(a){let b=a.get("user-agent")||"",c=a.get("accept-language")||"",d=a.get("accept-encoding")||"",e=a.get("connection")||"",f=`${b}|${c}|${d}|${e}`,g=0;for(let a=0;a<f.length;a++)g=(g<<5)-g+f.charCodeAt(a),g&=g;return g.toString(36)}static async calculateSuspicionScore(a,b,c){let d=0,e=await c("SELECT COUNT(*) as total FROM comments WHERE user_ip = ? AND created_at > DATE_SUB(NOW(), INTERVAL 1 HOUR)",[a]);e[0]?.total>10&&(d+=20),e[0]?.total>20&&(d+=30);let f=this.getSubnet(a),g=await c("SELECT COUNT(DISTINCT user_ip) as total FROM comments WHERE user_ip LIKE ?",[`${f}%`]);g[0]?.total>3&&(d+=15);let h=await c("SELECT COUNT(DISTINCT user_ip) as total FROM comments WHERE user_fingerprint = ?",[b]);h[0]?.total>2&&(d+=25);let i=await c("SELECT COUNT(*) as total FROM comments WHERE user_ip = ? AND created_at > DATE_SUB(NOW(), INTERVAL 5 MINUTE)",[a]);return i[0]?.total>3&&(d+=30),d}static shouldBan(a){return{autoBan:a>=70,recommend:a>=40,score:a}}}}};